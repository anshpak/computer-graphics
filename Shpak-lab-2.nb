(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    273824,       6483]
NotebookOptionsPosition[    255057,       6186]
NotebookOutlinePosition[    255523,       6204]
CellTagsIndexPosition[    255480,       6201]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:041b\:0440. 2. \:0413\:0420\:0410\:0424\:0418\:0427\:0415\:0421\:041a\
\:0418\:0415 \:042d\:041b\:0415\:041c\:0415\:041d\:0422\:042b \:041d\:0410 \
\:041f\:041b\:041e\:0421\:041a\:041e\:0421\:0422\:0418: \:041f\:041e\:041b\
\:0418\:0413\:041e\:041d ", "Title",
 CellChangeTimes->{{3.6997687469623127`*^9, 3.699768771206401*^9}, {
  3.7773422252179737`*^9, 3.7773422373359575`*^9}, {3.9060250115954046`*^9, 
  3.9060250413729954`*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"4f7326cb-e841-4e65-b5f3-7e974e9cff9c"],

Cell["\<\
A. Shpak
Sun, 24-Sep-2023\
\>", "Text",
 CellChangeTimes->{{3.699768720616661*^9, 3.699768729037617*^9}, {
  3.699846287754278*^9, 3.699846291993273*^9}, {3.699948842354419*^9, 
  3.699948845542672*^9}, {3.7773422483521676`*^9, 3.7773422919873*^9}, {
  3.9045532877205954`*^9, 3.9045533180729733`*^9}},
 TextAlignment->Right,ExpressionUUID->"1163ab55-f262-4f6c-bdec-feabab664307"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ". \:0414\:043e\:043f\:043e\:043b\:043d\:0438\:0442\:0435 \:0441\:0438\:0441\
\:0442\:0435\:043c\:0443 ",
 StyleBox["kmGeom",
  FontFamily->"Courier New",
  FontWeight->"Normal"],
 " \:043d\:043e\:0432\:044b\:043c \:0444\:0443\:043d\:043a\:0446\:0438\:043e\
\:043d\:0430\:043b\:043e\:043c, \:043f\:043e\:0437\:0432\:043e\:043b\:044f\
\:044e\:0449\:0438\:043c \:0440\:0430\:0431\:043e\:0442\:0430\:0442\:044c \
\:0441\n\:043e\:0431\:044a\:0435\:043a\:0442\:043e\:043c \[LeftGuillemet]\
\:043f\:043e\:043b\:0438\:0433\:043e\:043d \:043d\:0430 \:043f\:043b\:043e\
\:0441\:043a\:043e\:0441\:0442\:0438\[RightGuillemet]."
}], "Section",
 CellChangeTimes->{{3.699768787191681*^9, 3.699768800895378*^9}, {
   3.699773019778221*^9, 3.699773036607109*^9}, {3.699773073648346*^9, 
   3.6997731001119695`*^9}, {3.777342337806446*^9, 3.777342343714958*^9}, 
   3.9060251067968473`*^9},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"3bbc8b3e-b386-47b7-996c-1b97c23e0034"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["Section"],
 ".",
 
 CounterBox["Subsection"],
 ". \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\
\:0446\:0438\:044e, \:0432\:044b\:0447\:0438\:0441\:043b\:044f\:044e\:0449\
\:0443\:044e \:043f\:0435\:0440\:0438\:043c\:0435\:0442\:0440 \:043f\:0440\
\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\:0433\:043e \:043f\
\:043e\:043b\:0438\:0433\:043e\:043d\:0430."
}], "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, 
   3.90602517482656*^9},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"4ba9379f-60e3-45f6-bdba-0478a263b155"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"NamedQ", ",", "\[GothicK]\[GothicM]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[GothicK]\[GothicM]", "::", "usage"}], "=", 
   "\"\<Knowledge base \[LeftGuillemet]computer \
mathematics\[RightGuillemet]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"\[GothicK]\[GothicM]", ",", 
    RowBox[{"{", 
     RowBox[{"Protected", ",", "ReadProtected"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "::", "usage"}], "=", 
   "\"\<Check: is there a name of tested equations\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"n1_", ",", "n2__"}], "]"}], ":=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"NamedQ", "[", "n1", "]"}], ",", 
     RowBox[{"NamedQ", "[", "n2", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"NamedQ", ",", "Listable"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.690794992403058*^9, 3.6907950310873785`*^9}, {
   3.6908843882251835`*^9, 3.690884505856181*^9}, {3.6908846097825623`*^9, 
   3.6908846204600935`*^9}, {3.6908851707345686`*^9, 3.690885189421761*^9}, {
   3.690885248622609*^9, 3.690885266162938*^9}, {3.690885297959387*^9, 
   3.6908853003290596`*^9}, {3.6908853495988426`*^9, 3.690885357912713*^9}, {
   3.690885425150182*^9, 3.6908855152097607`*^9}, 3.6908856863125563`*^9, {
   3.6910553673987675`*^9, 3.6910554440588427`*^9}, {3.691055759975873*^9, 
   3.6910557646421666`*^9}, {3.6910557953308516`*^9, 
   3.6910558052688613`*^9}, {3.6910571930455256`*^9, 3.691057228129295*^9}, {
   3.6910573506928344`*^9, 3.6910573774560704`*^9}, 3.6910576910021176`*^9, {
   3.6914831461963997`*^9, 3.691483217152506*^9}, {3.6914838378740425`*^9, 
   3.691483842954578*^9}, {3.6914841790840755`*^9, 3.6914842060151005`*^9}, {
   3.691484255964369*^9, 3.691484308725642*^9}, {3.6914845063919625`*^9, 
   3.6914845071945424`*^9}, {3.69434039018277*^9, 3.694340502302164*^9}, {
   3.6943405533833623`*^9, 3.6943406466564827`*^9}, {3.6943409639572678`*^9, 
   3.694340968589549*^9}, {3.694341017695356*^9, 3.6943411035181704`*^9}, {
   3.696527247175319*^9, 3.6965272674873896`*^9}, 3.6965273138255253`*^9, {
   3.6965273615373993`*^9, 3.696527376755241*^9}, {3.69655510758998*^9, 
   3.6965552164478436`*^9}, {3.6965571661798143`*^9, 3.696557253853815*^9}, {
   3.696557292956991*^9, 3.6965573605427628`*^9}, {3.696558180263235*^9, 
   3.6965582440903544`*^9}, {3.6965583228056045`*^9, 
   3.6965583244067326`*^9}, {3.696559034465626*^9, 3.6965590354423246`*^9}, {
   3.696559261869051*^9, 3.696559292198389*^9}, {3.696559424453185*^9, 
   3.6965597066890697`*^9}, {3.69656108443996*^9, 3.6965611840235605`*^9}, {
   3.699846757775649*^9, 3.6998467603900304`*^9}, {3.6998478401435823`*^9, 
   3.699847843066986*^9}, {3.699867641692709*^9, 3.6998677591126623`*^9}, {
   3.6998690125200963`*^9, 3.6998690730458527`*^9}, 3.6998691223852415`*^9, 
   3.6998704309808755`*^9, {3.6998908518565655`*^9, 3.6998908741894794`*^9}, 
   3.6998911478080683`*^9, {3.699892062435873*^9, 3.6998920849038467`*^9}, {
   3.6998986854257493`*^9, 3.699898716756649*^9}, 3.699898932473677*^9, {
   3.6999026922242355`*^9, 3.699902707845271*^9}, {3.699902776288621*^9, 
   3.69990290528961*^9}, 3.699902958669608*^9, 3.699902996994115*^9, {
   3.6999493396563025`*^9, 3.6999495516970167`*^9}, {3.905153834663835*^9, 
   3.905153887263437*^9}, {3.9051539254097486`*^9, 3.9051539401716366`*^9}, {
   3.9051541956496224`*^9, 3.90515420030477*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[1]:=",ExpressionUUID->"538bc582-54c9-4879-8bfa-9ce470a11221"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmPoint", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmPoint", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "::", "usage"}], "=", "\"\<Point on the surface\>\""}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}], 
     "]"}], "[", "\"\<coord\>\"", "]"}], ":=", "coord"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmPoint", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Point\>\"", ",", 
      "id"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"coord", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coord"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"coord", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"L1_kmLine", ",", "L2_kmLine"}], "}"}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"First", "@", 
       RowBox[{"NSolve", "@", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"L1", ",", "L2"}], "}"}], "@", "\"\<equ\>\""}], "]"}]}]}], 
      ")"}]}], "]"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"P_kmPoint", ",", "StandardForm"}], "]"}], ":=", 
   RowBox[{"Row", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "[", "\"\<id\>\"", "]"}], ",", "\"\<(\>\"", ",", 
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"P", "[", "\"\<coord\>\"", "]"}], ",", "\"\<,\>\""}], "]"}], 
      ",", "\"\<)\>\""}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.907599406479768*^9, 3.9075994074788437`*^9}, {
  3.9075998596210737`*^9, 3.9075998623707933`*^9}, {3.907600755005046*^9, 
  3.907600757670816*^9}, {3.9076055006551104`*^9, 3.907605501604168*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[7]:=",ExpressionUUID->"d174d48d-56a1-41ce-80da-bcd2a6a220a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmVector", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmVector", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "::", "usage"}], "=", 
    "\"\<Vector on the surface\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmVector", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "[", "\"\<id\>\"", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Vector\>\"", ",", 
     "id"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}], 
     "]"}], "[", "\"\<coord\>\"", "]"}], ":=", "coord"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmVector", "[", 
      RowBox[{
      "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}],
       "]"}], "[", "\"\<norm\>\"", "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"coord", "*", "coord"}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", 
    RowBox[{"id_String", ",", "coord_List"}], "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", "coord_List", "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", 
    RowBox[{"id_String", ",", "P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"id", ",", 
     RowBox[{
      RowBox[{"P1", "@", "\"\<coord\>\""}], "-", 
      RowBox[{"P0", "@", "\"\<coord\>\""}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{"P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
    RowBox[{"kmVector", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NamedQ", "[", 
         RowBox[{"P0", ",", "P1"}], "]"}], ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"P0", "@", "\"\<id\>\""}], ",", 
          RowBox[{"P1", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
       "]"}], ",", "P0", ",", "P1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"V_kmVector", ",", "StandardForm"}], "]"}], "^:=", 
   RowBox[{"TemplateBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V", "@", "\"\<id\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"RowBox", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"#", ",", "StandardForm"}], "]"}], "&"}], "/@", 
           RowBox[{"V", "[", "\"\<coord\>\"", "]"}]}], ",", "\"\<,\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\"\<Point2D\>\"", ",",
      "\[IndentingNewLine]", 
     RowBox[{"DisplayFunction", "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"OverscriptBox", "[", 
            RowBox[{"#1", ",", "\"\<\[RightVector]\>\""}], "]"}], ",", 
           "\"\<(\>\"", ",", "#2", ",", "\"\<)\>\""}], "}"}]}], "&"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"InterpretationFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<{\>\"", ",", "#2", ",", "\"\<}\>\""}], "}"}]}], "&"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Tooltip", "\[Rule]", "Automatic"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.907628708682774*^9, 3.9076287632097063`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[17]:=",ExpressionUUID->"f5943f25-2dd4-4799-a26a-817dc7b7ce44"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "kmLine", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
     "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ",
     "**)"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"kmLine", ",", "ReadProtected"}], "]"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "::", "usage"}], "=", "\"\<Line on the surface\>\""}], 
    ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
    " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"NamedQ", "[", 
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "]"}], "^:=", 
    RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Line\>\"", ",", 
      "id"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{
      "\[GothicK]\[GothicM]", ",", "_String", ",", "coef_List", ",", "___"}], 
      "]"}], "[", "\"\<coef\>\"", "]"}], ":=", "coef"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"kmLine", "[", 
       RowBox[{
       "\[GothicK]\[GothicM]", ",", "_String", ",", "coef_List", ",", "___"}],
        "]"}], "[", 
      RowBox[{"\"\<equ\>\"", ",", 
       RowBox[{"vars", ":", 
        RowBox[{"{", 
         RowBox[{"_Symbol", ",", "_Symbol"}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"\[FormalX]", ",", "\[FormalY]"}], "}"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coef", ".", 
       RowBox[{"Append", "[", 
        RowBox[{"vars", ",", "1"}], "]"}]}], "\[Equal]", "0"}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{
      RowBox[{"equ", ":", 
       RowBox[{"(", 
        RowBox[{"__", "\[Equal]", "0"}], ")"}]}], ",", 
      RowBox[{"vars", ":", 
       RowBox[{"{", 
        RowBox[{"_Symbol", ",", "_Symbol"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\"\<\>\"", ",", "equ", ",", "vars"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"A_.", " ", "x_"}], "+", 
        RowBox[{"B_.", "y_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_Symbol", ",", "y_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}], "/;", 
     RowBox[{"\[Not]", 
      RowBox[{"PossibleZeroQ", "[", 
       RowBox[{
        RowBox[{"Abs", "@", "A"}], "+", 
        RowBox[{"Abs", "@", "B"}]}], "]"}]}]}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"A_.", " ", "x_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_Symbol", ",", "_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "0", ",", "C"}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"B_.", " ", "y_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"_Symbol", ",", "y_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "B", ",", "C"}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", "P_kmPoint", ",", "Dir_kmVector"}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"-", 
           RowBox[{"#", ".", 
            RowBox[{"P", "[", "\"\<coord\>\"", "]"}]}]}]}], "]"}], "&"}], "[", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"Dir", "[", "\"\<coord\>\"", "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"P_kmPoint", ",", "Dir_kmVector"}], "]"}], ":=", 
    RowBox[{"kmLine", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NamedQ", "[", 
         RowBox[{"P", ",", "Dir"}], "]"}], ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"P", "@", "\"\<id\>\""}], ",", 
          RowBox[{"Dir", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
       "]"}], ",", "P", ",", "Dir"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"kmLine", "[", 
    RowBox[{"id_String", ",", "P1_kmPoint", ",", "P2_kmPoint"}], "]"}], ":=", 
   RowBox[{"kmLine", "[", 
    RowBox[{"id", ",", "P1", ",", 
     RowBox[{"kmVector", "[", 
      RowBox[{"\"\<\>\"", ",", "P1", ",", "P2"}], "]"}]}], "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{"P1_kmPoint", ",", "P2_kmPoint"}], "}"}], "]"}], ":=", 
   RowBox[{"kmLine", "[", 
    RowBox[{"P1", ",", 
     RowBox[{"kmVector", "[", 
      RowBox[{
       RowBox[{"P2", "@", "\"\<id\>\""}], ",", "P1", ",", "P2"}], "]"}]}], 
    "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmLine", "[", 
   RowBox[{"id_String", ",", "segment_kmSegment"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"kmLine", "[", 
     RowBox[{"id", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}], "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}], "y"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", "*", "y2"}], "-", 
          RowBox[{"x2", "*", "y1"}]}], ")"}]}], "==", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmLine", "[", "segment_kmSegment", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"kmLine", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y1", "-", "y2"}], ")"}], "x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x1"}], ")"}], "y"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", "*", "y2"}], "-", 
           RowBox[{"x2", "*", "y1"}]}], ")"}]}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}], " ", 
    "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{"L_kmLine", ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "@", "\"\<id\>\""}], ",", "\"\<: \>\"", ",", 
       RowBox[{"L", "@", "\"\<equ\>\""}]}], "}"}]}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]]}], "Input",
 CellChangeTimes->{{3.907585689627097*^9, 3.907585692343799*^9}, {
   3.9076005643124437`*^9, 3.9076005646295414`*^9}, 3.9076054145176597`*^9, {
   3.907659283005635*^9, 3.907659287691595*^9}, {3.907659346245527*^9, 
   3.9076594479527273`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[29]:=",ExpressionUUID->"f12b0a89-b0a3-44a2-9071-eb658a6d4002"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "getTwoLinePoints", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getTwoLinePoints", "[", "line_kmLine", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"kmPoint", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Less", ",", 
        RowBox[{"Abs", "@", 
         RowBox[{
          RowBox[{"line", "[", "\"\<coef\>\"", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "\[FormalY]"}], "}"}], "/.", 
         RowBox[{"First", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"line", "[", "\"\<coef\>\"", "]"}], ".", 
             RowBox[{"{", 
              RowBox[{"x", ",", "\[FormalY]", ",", "1"}], "}"}]}], "\[Equal]",
             "0"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[FormalX]", ",", "y"}], "}"}], "/.", 
         RowBox[{"First", "@", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"line", "[", "\"\<coef\>\"", "]"}], ".", 
             RowBox[{"{", 
              RowBox[{"\[FormalX]", ",", "y", ",", "1"}], "}"}]}], "\[Equal]",
             "0"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[47]:=",ExpressionUUID->"120b82fd-9bdc-48a2-b105-736e0eb92902"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "kmGraphics2D", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmGraphics2D", "[", 
    RowBox[{"gp_List", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"gp", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P_kmPoint", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{
            RowBox[{"Point", "@", 
             RowBox[{"P", "@", "\"\<coord\>\""}]}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"P", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"L_kmLine", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"InfiniteLine", "@", 
             RowBox[{"Through", "@", 
              RowBox[{
               RowBox[{"getTwoLinePoints", "[", "L", "]"}], "@", 
               "\"\<coord\>\""}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"L", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "opts"}], "]"}]}], ";"}]}], "Input",
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[49]:=",ExpressionUUID->"fad16ad5-8e71-4d16-81d0-97edba438c9b"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"ClearAll", "[", "kmSegment", "]"}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
     "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ",
     "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"kmSegment", ",", "ReadProtected"}], "]"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "::", "usage"}], "=", 
     "\"\<\:041e\:0442\:0440\:0435\:0437\:043e\:043a \:043d\:0430 \
\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
    " ", "**)"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"NamedQ", "[", 
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "]"}], "^:=", 
    RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Segment\>\"", ",", 
      "id"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<coords\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"kmPoint", "[", "#", "]"}], "&"}], "/@", "endCoords"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<end1Coord\>\"", "]"}], ":=", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"endCoords", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<end2Coord\>\"", "]"}], ":=", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"endCoords", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
      RowBox[{"endCoords", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
    "\"\<len\>\"", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Plus", "@@", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"endCoords", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"endCoords", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}], "]"}]}], 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmSegment", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"endsCoords", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "endsCoords"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmSegment", "[", 
    RowBox[{"endsCoords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "endsCoords"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"id_String", ",", "P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
    RowBox[{"kmSegment", "[", 
     RowBox[{"id", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P1", "@", "\"\<coord\>\""}], ",", 
        RowBox[{"P0", "@", "\"\<coord\>\""}]}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
     RowBox[{"kmSegment", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NamedQ", "[", 
          RowBox[{"P0", ",", "P1"}], "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"P0", "@", "\"\<id\>\""}], ",", 
           RowBox[{"P1", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
        "]"}], ",", "P0", ",", "P1"}], "]"}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}], " ", 
    "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"Segment_kmSegment", ",", "StandardForm"}], "]"}], ":=", 
     RowBox[{"Row", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Segment", "@", "\"\<id\>\""}], ",", "\"\<: \>\"", ",", 
        RowBox[{"Segment", "@", "\"\<coords\>\""}]}], "}"}]}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", "\:041e\:0442\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\:0435",
      " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0430", " ", "\:043d\:0430", 
     " ", "\:0440\:0438\:0441\:0443\:043d\:043a\:0435"}], "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "kmGraphics2D", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmGraphics2D", "[", 
    RowBox[{"gp_List", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"gp", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P_kmPoint", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{
            RowBox[{"Point", "@", 
             RowBox[{"P", "@", "\"\<coord\>\""}]}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"P", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"L_kmLine", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"InfiniteLine", "@", 
             RowBox[{"Through", "@", 
              RowBox[{
               RowBox[{"getTwoLinePoints", "[", "L", "]"}], "@", 
               "\"\<coord\>\""}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"L", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Segment_kmSegment", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Segment", "@", "\"\<end1Coord\>\""}], ",", 
              RowBox[{"Segment", "@", "\"\<end2Coord\>\""}]}], "}"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "opts"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9046685125381203`*^9, 3.904668536751914*^9}, {
   3.9046690203567905`*^9, 3.9046690368542547`*^9}, {3.9046693933418837`*^9, 
   3.904669417588151*^9}, {3.90466978882434*^9, 3.904669792239921*^9}, 
   3.9046699658807673`*^9, {3.904670081023004*^9, 3.904670099611061*^9}, {
   3.904670300458583*^9, 3.904670308740033*^9}, {3.9046703658050957`*^9, 
   3.9046704147201924`*^9}, {3.9046704915499024`*^9, 3.904670492066557*^9}, {
   3.904670527895545*^9, 3.9046705281946983`*^9}, {3.904670709404814*^9, 
   3.9046707176680346`*^9}, {3.904671051060985*^9, 3.904671106870425*^9}, {
   3.904671215788891*^9, 3.904671218672679*^9}, {3.904672152718809*^9, 
   3.904672173016215*^9}, 3.9046722258427725`*^9, {3.904672267404024*^9, 
   3.9046723281286473`*^9}, {3.9046726016768165`*^9, 
   3.9046727633401175`*^9}, {3.9046733567087173`*^9, 3.904673396471535*^9}, {
   3.90467343201515*^9, 3.9046734527471523`*^9}, {3.904673523920989*^9, 
   3.90467363662348*^9}, {3.9046737131297865`*^9, 3.9046737413094463`*^9}, {
   3.9046740510152445`*^9, 3.904674065017725*^9}, 3.9046741210439873`*^9, {
   3.9046756920067773`*^9, 3.904675698589094*^9}, {3.9048117579284134`*^9, 
   3.90481176882706*^9}, {3.9048125182158003`*^9, 3.9048126541989794`*^9}, {
   3.9048137538510246`*^9, 3.9048137635669937`*^9}, {3.9048138138438115`*^9, 
   3.9048138213761215`*^9}, {3.905155636458993*^9, 3.9051556385991087`*^9}, 
   3.9051571723419247`*^9, {3.9051753249562893`*^9, 3.905175325206192*^9}, {
   3.9075756017663727`*^9, 3.907575630379318*^9}, {3.9075756624088974`*^9, 
   3.907575709168853*^9}, {3.9075759093770657`*^9, 3.9075759179260125`*^9}, {
   3.907575955603362*^9, 3.907575962620142*^9}, {3.907576123215556*^9, 
   3.9075761247311635`*^9}, {3.907583266490574*^9, 3.907583267573224*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[51]:=",ExpressionUUID->"c704444e-c6fb-4765-8f38-4d908a983189"],

Cell[CellGroupData[{

Cell["\:0424\:0443\:043d\:043a\:0446\:0438\:0438 \:0434\:043b\:044f \:0437\
\:0430\:0434\:0430\:043d\:0438\:0439", "Subsubsection",
 CellChangeTimes->{{3.9075835914317684`*^9, 
  3.9075836014129972`*^9}},ExpressionUUID->"202b42a1-fa0e-4593-a9ed-\
292e133831e5"],

Cell["1.5", "Text",
 CellChangeTimes->{{3.9075990746056647`*^9, 
  3.907599084988265*^9}},ExpressionUUID->"d7e00534-eb57-4d0d-8a7c-\
5c737400e7f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getRightSegmentPoint", "[", 
   RowBox[{"P1_kmPoint", ",", "P2_kmPoint"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ">", 
     RowBox[{
      RowBox[{"P2", "[", "\"\<coord\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "P1", ",", "P2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getRightSegmentPoint", "[", "Segment_kmSegment", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"coord1", "=", 
       RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}]}], ",", 
      RowBox[{"coord2", "=", 
       RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coord1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ">", 
       RowBox[{"coord2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"kmPoint", "[", "coord1", "]"}], ",", 
      RowBox[{"kmPoint", "[", "coord2", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getLeftSegmentPoint", "[", 
   RowBox[{"P1_kmPoint", ",", "P2_kmPoint"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"P1", "[", "\"\<coord\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", 
     RowBox[{
      RowBox[{"P2", "[", "\"\<coord\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "P1", ",", "P2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getLeftSegmentPoint", "[", "Segment_kmSegment", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"coord1", "=", 
       RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}]}], ",", 
      RowBox[{"coord2", "=", 
       RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coord1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "<", 
       RowBox[{"coord2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"kmPoint", "[", "coord1", "]"}], ",", 
      RowBox[{"kmPoint", "[", "coord2", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9048098457770977`*^9, 3.90480992689445*^9}, {
  3.9048100031983023`*^9, 3.9048101184055862`*^9}, {3.9048101622004957`*^9, 
  3.904810227853198*^9}, {3.904810300248644*^9, 3.904810305778588*^9}, {
  3.904810475019848*^9, 3.904810475301*^9}, {3.9048105470888796`*^9, 
  3.9048105482448564`*^9}, {3.9048106123508*^9, 3.9048106476129436`*^9}, {
  3.9048137695815525`*^9, 3.9048137933132715`*^9}, {3.904813827958249*^9, 
  3.9048138289419928`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[67]:=",ExpressionUUID->"4d98faff-4e7b-4724-a437-17c1a35fb6b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getParametersOfIntersection", "[", 
   RowBox[{"Segment1_kmSegment", ",", "Segment2_kmSegment"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line1", "=", 
       RowBox[{"kmLine", "[", "Segment1", "]"}]}], ",", 
      RowBox[{"Line2", "=", 
       RowBox[{"kmLine", "[", "Segment2", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"getLinesIntersectionPoint", "[", 
       RowBox[{"Line1", ",", "Line2"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"getParameter", "[", 
        RowBox[{"#", ",", "res"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"Segment1", ",", "Segment2"}], "}"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9053658642850866`*^9, 3.9053659420413485`*^9}, {
  3.905365993927966*^9, 3.9053660102176704`*^9}, {3.9053661038379793`*^9, 
  3.905366148883253*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[71]:=",ExpressionUUID->"0c48a55d-e63d-4a41-ad12-5a437a171653"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getLinesIntersectionPoint", "[", 
   RowBox[{"Line1_kmLine", ",", "Line2_kmLine"}], "]"}], ":=", 
  RowBox[{"kmPoint", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"First", "@", 
      RowBox[{"NSolve", "@", 
       RowBox[{"Through", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Line1", ",", "Line2"}], "}"}], "@", "\"\<equ\>\""}], 
        "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[72]:=",ExpressionUUID->"a3d45e92-de19-4da4-aa66-472aebad5c85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmPolygon", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmPolygon", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "::", "usage"}], "=", 
    "\"\<Polygon on the surface\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmPolygon", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPolygon", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
     "]"}], "[", "\"\<coordsOfPoints\>\"", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", 
    "coordsOfPoints"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPolygon", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
     "]"}], "[", "\"\<points\>\"", "]"}], ":=", "coordsOfPoints"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPolygon", "[", 
    RowBox[{
    "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
    "]"}], "[", "\"\<lineSegments\>\"", "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"kmSegment", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"coordsOfPoints", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"coordsOfPoints", "[", 
           RowBox[{"[", 
            RowBox[{"#", "+", "1"}], "]"}], "]"}], "[", "\"\<coord\>\"", 
          "]"}]}], "}"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"Length", "[", "coordsOfPoints", "]"}], "-", "1"}], "]"}]}], 
    ",", 
    RowBox[{"kmSegment", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"coordsOfPoints", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "coordsOfPoints", "]"}], "]"}], "]"}], "[", 
        "\"\<coord\>\"", "]"}], ",", 
       RowBox[{
        RowBox[{"coordsOfPoints", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], "}"}],
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPolygon", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "[", "\"\<id\>\"", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Polygon\>\"", ",", 
     "id"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPolygon", "[", 
    RowBox[{
    "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
    "]"}], "[", "\"\<minX\>\"", "]"}], ":=", 
  RowBox[{"Min", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", 
         "coordsOfPoints"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "@", "coordsOfPoints"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPolygon", "[", 
    RowBox[{
    "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
    "]"}], "[", "\"\<maxX\>\"", "]"}], ":=", 
  RowBox[{"Max", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", 
         "coordsOfPoints"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "@", "coordsOfPoints"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPolygon", "[", 
    RowBox[{
    "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
    "]"}], "[", "\"\<minY\>\"", "]"}], ":=", 
  RowBox[{"Min", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", 
         "coordsOfPoints"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "@", "coordsOfPoints"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPolygon", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coordsOfPoints_List"}], 
     "]"}], "[", "\"\<maxY\>\"", "]"}], ":=", 
   RowBox[{"Max", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", 
          "coordsOfPoints"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "coordsOfPoints"}], "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPolygon", "[", 
    RowBox[{"id_String", ",", "coordsOfPoints_List"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"Head", "[", 
        RowBox[{"coordsOfPoints", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "==", 
      "\"\<kmPoint\>\""}], ",", 
     RowBox[{"kmPolygon", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coordsOfPoints"}], 
      "]"}], ",", 
     RowBox[{"kmPolygon", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"kmPoint", "[", "#", "]"}], "&"}], "/@", 
        "coordsOfPoints"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPolygon", "[", "coordsOfPoints_List", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", 
         RowBox[{"coordsOfPoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "==", 
       "\"\<kmPoint\>\""}], ",", 
      RowBox[{"kmPolygon", "[", 
       RowBox[{
       "\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coordsOfPoints"}], 
       "]"}], ",", 
      RowBox[{"kmPolygon", "[", 
       RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"kmPoint", "[", "#", "]"}], "&"}], "/@", 
         "coordsOfPoints"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"Polygon_kmPolygon", ",", "StandardForm"}], "]"}], ":=", 
   RowBox[{"Row", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Polygon", "[", "\"\<id\>\"", "]"}], ",", "\"\<: (\>\"", ",", 
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"Polygon", "[", "\"\<coordsOfPoints\>\"", "]"}], ",", 
        "\"\<,\>\""}], "]"}], ",", "\"\<)\>\""}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.906025532187811*^9, 3.9060255935432606`*^9}, {
   3.9060256629510136`*^9, 3.9060257697859955`*^9}, {3.906025818700902*^9, 
   3.9060258807881093`*^9}, {3.906027033130103*^9, 3.9060270372854166`*^9}, {
   3.906027092565634*^9, 3.9060271277382584`*^9}, {3.9060272169501457`*^9, 
   3.9060272329867277`*^9}, {3.906027271107214*^9, 3.906027277434312*^9}, {
   3.906027417859769*^9, 3.906027422259899*^9}, {3.906027504665552*^9, 
   3.9060275492751193`*^9}, 3.906604936945468*^9, {3.906605071179959*^9, 
   3.906605113341915*^9}, 3.9066053467384157`*^9, {3.9066055046232386`*^9, 
   3.90660552129436*^9}, {3.9066071242607555`*^9, 3.9066071839875064`*^9}, {
   3.9066072291796904`*^9, 3.9066072336165886`*^9}, {3.906607457687505*^9, 
   3.906607460827818*^9}, {3.90660756885647*^9, 3.906607569247465*^9}, {
   3.9066077542321844`*^9, 3.9066077825656147`*^9}, {3.906607821203599*^9, 
   3.9066078740999966`*^9}, {3.9066084026868353`*^9, 3.906608430275385*^9}, {
   3.906608585242029*^9, 3.906608609770919*^9}, {3.9066087088716946`*^9, 
   3.9066087334532957`*^9}, {3.9066087757403793`*^9, 
   3.9066088242786417`*^9}, {3.9066089058510895`*^9, 
   3.9066089469431734`*^9}, {3.90660941492283*^9, 3.9066094327314262`*^9}, {
   3.9066095010428543`*^9, 3.906609545577318*^9}, {3.9066096422341332`*^9, 
   3.906609643281218*^9}, {3.906609734688118*^9, 3.9066097710050845`*^9}, {
   3.90660980655058*^9, 3.906609836721443*^9}, {3.9066100080558453`*^9, 
   3.9066100767627687`*^9}, {3.9072222550917463`*^9, 
   3.9072223109521255`*^9}, {3.907222604081269*^9, 3.9072226045482883`*^9}, {
   3.9072226769885006`*^9, 3.9072226929696484`*^9}, {3.9072227282813196`*^9, 
   3.9072227742756777`*^9}, {3.9072228741620855`*^9, 3.907222897542364*^9}, {
   3.907222945687065*^9, 3.9072229633521395`*^9}, {3.907223058204934*^9, 
   3.907223092001813*^9}, {3.9072231253313904`*^9, 3.907223140378003*^9}, {
   3.907223205686904*^9, 3.9072232451482396`*^9}, 3.9072234330073633`*^9, {
   3.907223487382454*^9, 3.907223588104926*^9}, {3.907223736152651*^9, 
   3.9072237833785825`*^9}, {3.907223898197466*^9, 3.9072239020307274`*^9}, {
   3.907224027648052*^9, 3.907224260534887*^9}, {3.907224326826221*^9, 
   3.907224446227756*^9}, {3.9072244899222946`*^9, 3.907224505203263*^9}, {
   3.9072247764512243`*^9, 3.9072248007322693`*^9}, {3.9072249995058985`*^9, 
   3.9072250206876593`*^9}, {3.9072253205505624`*^9, 3.907225415871683*^9}, 
   3.9072257999568357`*^9, {3.907225832334824*^9, 3.90722586051414*^9}, {
   3.907225935955906*^9, 3.9072259602358637`*^9}, {3.9072261240647593`*^9, 
   3.9072261397960987`*^9}, 3.907226248782233*^9, {3.9072263462021003`*^9, 
   3.9072264048608313`*^9}, {3.907226498183642*^9, 3.9072265005156374`*^9}, {
   3.9072265361282177`*^9, 3.907226569324396*^9}, {3.907226668144586*^9, 
   3.907226759516591*^9}, 3.907569930849296*^9, 3.907569962128151*^9, {
   3.9075701377563877`*^9, 3.9075702108288994`*^9}, 3.9075702546910486`*^9, 
   3.907570307617628*^9, {3.9075712728264484`*^9, 3.9075713036382217`*^9}, {
   3.907571336101119*^9, 3.9075713697967787`*^9}, {3.9075714795658603`*^9, 
   3.907571528674733*^9}, {3.907571980650815*^9, 3.907572027528741*^9}, 
   3.9075721755589895`*^9, {3.90757224801501*^9, 3.9075722811455584`*^9}, {
   3.9075726204366446`*^9, 3.907572701290984*^9}, {3.907572783614472*^9, 
   3.9075729472269125`*^9}, {3.90757301981635*^9, 3.907573093440115*^9}, {
   3.9075731326849318`*^9, 3.907573132952434*^9}, 3.9075733296255074`*^9, {
   3.9075734570270023`*^9, 3.9075734916058965`*^9}, {3.9075735374663815`*^9, 
   3.907573543397952*^9}, {3.9075736387368045`*^9, 3.907573647201325*^9}, {
   3.907573720642965*^9, 3.907573729525177*^9}, {3.907574074995587*^9, 
   3.907574147454505*^9}, {3.9075741972808847`*^9, 3.907574208162469*^9}, 
   3.9075757015043397`*^9, {3.907576735053443*^9, 3.9075768335582848`*^9}, {
   3.907576871335781*^9, 3.9075768783684587`*^9}, {3.907589880037017*^9, 
   3.9075899033514256`*^9}, {3.907626098571411*^9, 3.9076261755941973`*^9}, {
   3.907626264149604*^9, 3.907626326989999*^9}, {3.9076266193700795`*^9, 
   3.9076266233371286`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[73]:=",ExpressionUUID->"dd79996a-d18e-4465-8e53-7407dbf5995e"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"c6197947-ef42-4de9-9808-118de5254dfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Polygon1", "=", 
  RowBox[{"kmPolygon", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Polygon2", "=", 
  RowBox[{"kmPolygon", "[", 
   RowBox[{"\"\<Test polygon of four points\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Polygon3", "=", 
  RowBox[{"kmPolygon", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"kmPoint", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], "]"}], ",", 
     RowBox[{"kmPoint", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "6"}], "}"}], "]"}], ",", 
     RowBox[{"kmPoint", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "4"}], ",", 
        RowBox[{"-", "6"}]}], "}"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Polygon4", "=", 
  RowBox[{"kmPolygon", "[", 
   RowBox[{"\"\<Test polygon of three kmPoints as input\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"5", ",", "2"}], "}"}], "]"}], ",", 
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"7", ",", "1"}], "}"}], "]"}], ",", 
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "4"}], ",", "7"}], "}"}], "]"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.906026473630224*^9, 3.9060265028043904`*^9}, {
   3.906026534113318*^9, 3.9060265409080944`*^9}, {3.906026648015041*^9, 
   3.9060266500926747`*^9}, {3.906026964154809*^9, 3.906026964435992*^9}, {
   3.9060271362891655`*^9, 3.906027202144517*^9}, {3.9060274071814013`*^9, 
   3.906027409243412*^9}, {3.9060279765335064`*^9, 3.906027980964213*^9}, {
   3.906607793893979*^9, 3.9066077961262093`*^9}, {3.9066078554526687`*^9, 
   3.9066078672996955`*^9}, {3.9066080012023826`*^9, 3.9066080035612*^9}, {
   3.906608214220457*^9, 3.906608231606024*^9}, {3.9066086908861847`*^9, 
   3.9066086929324894`*^9}, {3.9066087891991897`*^9, 3.906608792214131*^9}, {
   3.9066097903287597`*^9, 3.9066097925938845`*^9}, {3.9066098568878293`*^9, 
   3.9066098897361836`*^9}, {3.90661005825783*^9, 3.906610062796324*^9}, {
   3.907222981699873*^9, 3.907222981932555*^9}, {3.9072232682125063`*^9, 
   3.907223276194813*^9}, {3.9072233359860573`*^9, 3.907223381880972*^9}, {
   3.9072234979828863`*^9, 3.9072235275959063`*^9}, {3.907223596320691*^9, 
   3.907223599286905*^9}, {3.907223672760267*^9, 3.907223682559596*^9}, {
   3.907223880783685*^9, 3.9072238830672035`*^9}, {3.9072244315299287`*^9, 
   3.9072244339776173`*^9}, 3.9072247867512217`*^9, {3.907226112765957*^9, 
   3.9072261162815976`*^9}, {3.9072262529138966`*^9, 3.90722626632973*^9}, 
   3.907226508649592*^9, {3.907226549143807*^9, 3.9072265493438663`*^9}, {
   3.9075715225443487`*^9, 3.9075715247082615`*^9}, {3.907571565488145*^9, 
   3.907571585002267*^9}, {3.907572033943283*^9, 3.9075721224826994`*^9}, {
   3.907582642936759*^9, 3.907582643421045*^9}, {3.907590006737486*^9, 
   3.9075900463829174`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"03a1a2f4-c4eb-41be-b9df-56c21351a6a4"],

Cell[BoxData[
 TemplateBox[{"\"Polygon\"", "\": (\"", 
   TemplateBox[{",", "\",\"", 
     RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]}, "RowWithSeparators"], "\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.9066085065642166`*^9, 3.906608622200143*^9, {3.906608683389245*^9, 
   3.9066088094083233`*^9}, 3.906608973897492*^9, 3.906609437401909*^9, {
   3.9066095376484213`*^9, 3.9066095479829984`*^9}, {3.9066096463113203`*^9, 
   3.9066096665794425`*^9}, 3.906609697055007*^9, 3.9066097371870065`*^9, {
   3.9066097733639383`*^9, 3.9066098005207567`*^9}, {3.90660984895174*^9, 
   3.906609870865217*^9}, 3.9072223186827564`*^9, 3.907222607880637*^9, 
   3.9072227006181936`*^9, 3.907222731596546*^9, {3.90722288985985*^9, 
   3.9072229006090364`*^9}, 3.907222966100323*^9, 3.907223383596092*^9, 
   3.9072234354738493`*^9, {3.9072234902170258`*^9, 3.90722352819451*^9}, {
   3.9072235926694465`*^9, 3.9072236076508827`*^9}, {3.907223653280034*^9, 
   3.9072236832077637`*^9}, {3.9072244263126173`*^9, 
   3.9072244482588425`*^9}, {3.907224500869437*^9, 3.9072245082194014`*^9}, 
   3.9072246642818317`*^9, {3.907224787682389*^9, 3.9072248384763117`*^9}, 
   3.907224928314596*^9, {3.9072250033892956`*^9, 3.9072250265018997`*^9}, 
   3.907225310534523*^9, {3.907225392740786*^9, 3.9072254188706717`*^9}, 
   3.907225835134023*^9, 3.907225939070548*^9, {3.907226116932028*^9, 
   3.9072261470941415`*^9}, 3.9072262670117855`*^9, {3.9072263559504957`*^9, 
   3.907226373848172*^9}, 3.9072264076437216`*^9, {3.9072265043658133`*^9, 
   3.9072265090982685`*^9}, {3.9072265420105467`*^9, 3.907226571189494*^9}, 
   3.9075702174944167`*^9, 3.9075702590562916`*^9, 3.9075703117656136`*^9, 
   3.907571308736801*^9, 3.9075713438987284`*^9, 3.9075713742116013`*^9, {
   3.9075714858477173`*^9, 3.9075715347910805`*^9}, 3.907571586250662*^9, 
   3.9075720305438232`*^9, {3.9075721118660154`*^9, 3.9075721232313104`*^9}, 
   3.907573654316642*^9, 3.907582655784433*^9, 3.907589471989236*^9, {
   3.907589906682354*^9, 3.9075899319460707`*^9}, 3.907590015334995*^9, 
   3.9075900471642904`*^9, 3.9075976898840365`*^9, 3.9076048508384657`*^9, 
   3.907605181952216*^9, 3.9076152660207443`*^9, 3.9076431566240597`*^9, 
   3.907654344366593*^9, 3.9076600704845095`*^9, 3.907672030799487*^9, 
   3.907771239890012*^9, 3.9078108468975058`*^9, 3.907813016379171*^9, 
   3.9078349184737854`*^9, 3.9078384351634536`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"d73792d2-5c64-4be3-a5ab-564f00ff9eff"],

Cell[BoxData[
 TemplateBox[{"\"Test polygon of four points\"", "\": (\"", 
   TemplateBox[{",", "\",\"", 
     RowBox[{"{", 
       RowBox[{
         RowBox[{"-", "5"}], ",", "5"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}, "RowWithSeparators"], "\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.9066085065642166`*^9, 3.906608622200143*^9, {3.906608683389245*^9, 
   3.9066088094083233`*^9}, 3.906608973897492*^9, 3.906609437401909*^9, {
   3.9066095376484213`*^9, 3.9066095479829984`*^9}, {3.9066096463113203`*^9, 
   3.9066096665794425`*^9}, 3.906609697055007*^9, 3.9066097371870065`*^9, {
   3.9066097733639383`*^9, 3.9066098005207567`*^9}, {3.90660984895174*^9, 
   3.906609870865217*^9}, 3.9072223186827564`*^9, 3.907222607880637*^9, 
   3.9072227006181936`*^9, 3.907222731596546*^9, {3.90722288985985*^9, 
   3.9072229006090364`*^9}, 3.907222966100323*^9, 3.907223383596092*^9, 
   3.9072234354738493`*^9, {3.9072234902170258`*^9, 3.90722352819451*^9}, {
   3.9072235926694465`*^9, 3.9072236076508827`*^9}, {3.907223653280034*^9, 
   3.9072236832077637`*^9}, {3.9072244263126173`*^9, 
   3.9072244482588425`*^9}, {3.907224500869437*^9, 3.9072245082194014`*^9}, 
   3.9072246642818317`*^9, {3.907224787682389*^9, 3.9072248384763117`*^9}, 
   3.907224928314596*^9, {3.9072250033892956`*^9, 3.9072250265018997`*^9}, 
   3.907225310534523*^9, {3.907225392740786*^9, 3.9072254188706717`*^9}, 
   3.907225835134023*^9, 3.907225939070548*^9, {3.907226116932028*^9, 
   3.9072261470941415`*^9}, 3.9072262670117855`*^9, {3.9072263559504957`*^9, 
   3.907226373848172*^9}, 3.9072264076437216`*^9, {3.9072265043658133`*^9, 
   3.9072265090982685`*^9}, {3.9072265420105467`*^9, 3.907226571189494*^9}, 
   3.9075702174944167`*^9, 3.9075702590562916`*^9, 3.9075703117656136`*^9, 
   3.907571308736801*^9, 3.9075713438987284`*^9, 3.9075713742116013`*^9, {
   3.9075714858477173`*^9, 3.9075715347910805`*^9}, 3.907571586250662*^9, 
   3.9075720305438232`*^9, {3.9075721118660154`*^9, 3.9075721232313104`*^9}, 
   3.907573654316642*^9, 3.907582655784433*^9, 3.907589471989236*^9, {
   3.907589906682354*^9, 3.9075899319460707`*^9}, 3.907590015334995*^9, 
   3.9075900471642904`*^9, 3.9075976898840365`*^9, 3.9076048508384657`*^9, 
   3.907605181952216*^9, 3.9076152660207443`*^9, 3.9076431566240597`*^9, 
   3.907654344366593*^9, 3.9076600704845095`*^9, 3.907672030799487*^9, 
   3.907771239890012*^9, 3.9078108468975058`*^9, 3.907813016379171*^9, 
   3.9078349184737854`*^9, 3.907838435179082*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"cd06a20b-d08f-4473-aa1a-d2148b0d54e6"],

Cell[BoxData[
 TemplateBox[{"\"Polygon\"", "\": (\"", 
   TemplateBox[{",", "\",\"", 
     RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"1", ",", "6"}], "}"}], 
     RowBox[{"{", 
       RowBox[{
         RowBox[{"-", "4"}], ",", 
         RowBox[{"-", "6"}]}], "}"}]}, "RowWithSeparators"], "\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.9066085065642166`*^9, 3.906608622200143*^9, {3.906608683389245*^9, 
   3.9066088094083233`*^9}, 3.906608973897492*^9, 3.906609437401909*^9, {
   3.9066095376484213`*^9, 3.9066095479829984`*^9}, {3.9066096463113203`*^9, 
   3.9066096665794425`*^9}, 3.906609697055007*^9, 3.9066097371870065`*^9, {
   3.9066097733639383`*^9, 3.9066098005207567`*^9}, {3.90660984895174*^9, 
   3.906609870865217*^9}, 3.9072223186827564`*^9, 3.907222607880637*^9, 
   3.9072227006181936`*^9, 3.907222731596546*^9, {3.90722288985985*^9, 
   3.9072229006090364`*^9}, 3.907222966100323*^9, 3.907223383596092*^9, 
   3.9072234354738493`*^9, {3.9072234902170258`*^9, 3.90722352819451*^9}, {
   3.9072235926694465`*^9, 3.9072236076508827`*^9}, {3.907223653280034*^9, 
   3.9072236832077637`*^9}, {3.9072244263126173`*^9, 
   3.9072244482588425`*^9}, {3.907224500869437*^9, 3.9072245082194014`*^9}, 
   3.9072246642818317`*^9, {3.907224787682389*^9, 3.9072248384763117`*^9}, 
   3.907224928314596*^9, {3.9072250033892956`*^9, 3.9072250265018997`*^9}, 
   3.907225310534523*^9, {3.907225392740786*^9, 3.9072254188706717`*^9}, 
   3.907225835134023*^9, 3.907225939070548*^9, {3.907226116932028*^9, 
   3.9072261470941415`*^9}, 3.9072262670117855`*^9, {3.9072263559504957`*^9, 
   3.907226373848172*^9}, 3.9072264076437216`*^9, {3.9072265043658133`*^9, 
   3.9072265090982685`*^9}, {3.9072265420105467`*^9, 3.907226571189494*^9}, 
   3.9075702174944167`*^9, 3.9075702590562916`*^9, 3.9075703117656136`*^9, 
   3.907571308736801*^9, 3.9075713438987284`*^9, 3.9075713742116013`*^9, {
   3.9075714858477173`*^9, 3.9075715347910805`*^9}, 3.907571586250662*^9, 
   3.9075720305438232`*^9, {3.9075721118660154`*^9, 3.9075721232313104`*^9}, 
   3.907573654316642*^9, 3.907582655784433*^9, 3.907589471989236*^9, {
   3.907589906682354*^9, 3.9075899319460707`*^9}, 3.907590015334995*^9, 
   3.9075900471642904`*^9, 3.9075976898840365`*^9, 3.9076048508384657`*^9, 
   3.907605181952216*^9, 3.9076152660207443`*^9, 3.9076431566240597`*^9, 
   3.907654344366593*^9, 3.9076600704845095`*^9, 3.907672030799487*^9, 
   3.907771239890012*^9, 3.9078108468975058`*^9, 3.907813016379171*^9, 
   3.9078349184737854`*^9, 3.9078384351946983`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"74ea345d-a170-433e-9027-2a4f8f1c7a7e"],

Cell[BoxData[
 TemplateBox[{"\"Test polygon of three kmPoints as input\"", "\": (\"", 
   TemplateBox[{",", "\",\"", 
     RowBox[{"{", 
       RowBox[{"5", ",", "2"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"7", ",", "1"}], "}"}], 
     RowBox[{"{", 
       RowBox[{
         RowBox[{"-", "4"}], ",", "7"}], "}"}]}, "RowWithSeparators"], 
   "\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.9066085065642166`*^9, 3.906608622200143*^9, {3.906608683389245*^9, 
   3.9066088094083233`*^9}, 3.906608973897492*^9, 3.906609437401909*^9, {
   3.9066095376484213`*^9, 3.9066095479829984`*^9}, {3.9066096463113203`*^9, 
   3.9066096665794425`*^9}, 3.906609697055007*^9, 3.9066097371870065`*^9, {
   3.9066097733639383`*^9, 3.9066098005207567`*^9}, {3.90660984895174*^9, 
   3.906609870865217*^9}, 3.9072223186827564`*^9, 3.907222607880637*^9, 
   3.9072227006181936`*^9, 3.907222731596546*^9, {3.90722288985985*^9, 
   3.9072229006090364`*^9}, 3.907222966100323*^9, 3.907223383596092*^9, 
   3.9072234354738493`*^9, {3.9072234902170258`*^9, 3.90722352819451*^9}, {
   3.9072235926694465`*^9, 3.9072236076508827`*^9}, {3.907223653280034*^9, 
   3.9072236832077637`*^9}, {3.9072244263126173`*^9, 
   3.9072244482588425`*^9}, {3.907224500869437*^9, 3.9072245082194014`*^9}, 
   3.9072246642818317`*^9, {3.907224787682389*^9, 3.9072248384763117`*^9}, 
   3.907224928314596*^9, {3.9072250033892956`*^9, 3.9072250265018997`*^9}, 
   3.907225310534523*^9, {3.907225392740786*^9, 3.9072254188706717`*^9}, 
   3.907225835134023*^9, 3.907225939070548*^9, {3.907226116932028*^9, 
   3.9072261470941415`*^9}, 3.9072262670117855`*^9, {3.9072263559504957`*^9, 
   3.907226373848172*^9}, 3.9072264076437216`*^9, {3.9072265043658133`*^9, 
   3.9072265090982685`*^9}, {3.9072265420105467`*^9, 3.907226571189494*^9}, 
   3.9075702174944167`*^9, 3.9075702590562916`*^9, 3.9075703117656136`*^9, 
   3.907571308736801*^9, 3.9075713438987284`*^9, 3.9075713742116013`*^9, {
   3.9075714858477173`*^9, 3.9075715347910805`*^9}, 3.907571586250662*^9, 
   3.9075720305438232`*^9, {3.9075721118660154`*^9, 3.9075721232313104`*^9}, 
   3.907573654316642*^9, 3.907582655784433*^9, 3.907589471989236*^9, {
   3.907589906682354*^9, 3.9075899319460707`*^9}, 3.907590015334995*^9, 
   3.9075900471642904`*^9, 3.9075976898840365`*^9, 3.9076048508384657`*^9, 
   3.907605181952216*^9, 3.9076152660207443`*^9, 3.9076431566240597`*^9, 
   3.907654344366593*^9, 3.9076600704845095`*^9, 3.907672030799487*^9, 
   3.907771239890012*^9, 3.9078108468975058`*^9, 3.907813016379171*^9, 
   3.9078349184737854`*^9, 3.907838435210354*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"0d6a1c8a-1bc9-4409-b6ff-868d28a3f364"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Polygon1", "[", "\"\<points\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Polygon4", "[", "\"\<points\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.9072229137743044`*^9, 3.9072229343721943`*^9}, {
  3.907572165960064*^9, 3.9075721865726624`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"ab5dae68-db26-4491-97dd-390523f90282"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9072229674498425`*^9, {3.907572166376375*^9, 3.9075721873070917`*^9}, 
   3.907573655517172*^9, 3.9075826570836563`*^9, 3.9075894722552843`*^9, 
   3.9075899322793937`*^9, 3.9075976899725227`*^9, 3.9076048509720664`*^9, 
   3.907605182035515*^9, 3.907615266170619*^9, 3.9076431567242036`*^9, 
   3.907654344491556*^9, 3.9076600706407127`*^9, 3.9076720309869423`*^9, 
   3.907771240171232*^9, 3.907810847053685*^9, 3.9078130164728975`*^9, 
   3.9078349186606846`*^9, 3.9078384352571807`*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"538f834d-835d-4154-bc15-cb27e350795d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "4"}], "7"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9072229674498425`*^9, {3.907572166376375*^9, 3.9075721873070917`*^9}, 
   3.907573655517172*^9, 3.9075826570836563`*^9, 3.9075894722552843`*^9, 
   3.9075899322793937`*^9, 3.9075976899725227`*^9, 3.9076048509720664`*^9, 
   3.907605182035515*^9, 3.907615266170619*^9, 3.9076431567242036`*^9, 
   3.907654344491556*^9, 3.9076600706407127`*^9, 3.9076720309869423`*^9, 
   3.907771240171232*^9, 3.907810847053685*^9, 3.9078130164728975`*^9, 
   3.9078349186606846`*^9, 3.9078384352728024`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"fa77f65b-bb61-4010-b3f7-35c2f1349a81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Polygon2", "[", "\"\<coordsOfPoints\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Polygon3", "[", "\"\<coordsOfPoints\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.9060265434856415`*^9, 3.906026564053973*^9}, {
  3.906026970481436*^9, 3.9060269770268097`*^9}, {3.906605548620925*^9, 
  3.90660555598059*^9}, {3.9066098675378466`*^9, 3.90660986783511*^9}, {
  3.907572192906637*^9, 3.9075721953064985`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b4b49b03-55a6-4058-903d-bcfe40d88cdc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.906026564850153*^9, 3.9060266519047823`*^9, 
  3.906026716349303*^9, 3.906026977323563*^9, 3.90660555633951*^9, 
  3.9066064594798956`*^9, 3.906609868553265*^9, 3.9072223201501207`*^9, 
  3.9072227438950057`*^9, 3.9072229043754096`*^9, 3.9072229708333073`*^9, 
  3.9075721959217405`*^9, 3.9075736563338103`*^9, 3.907582659034071*^9, 
  3.9075894723580723`*^9, 3.9075899324127626`*^9, 3.907597690016924*^9, 
  3.9076048511718884`*^9, 3.9076051820853353`*^9, 3.907615266303827*^9, 
  3.907643156792205*^9, 3.907654344554048*^9, 3.9076600707813053`*^9, 
  3.9076720310806704`*^9, 3.90777124023368*^9, 3.907810847131796*^9, 
  3.9078130165510044`*^9, 3.9078349187544217`*^9, 3.907838435335289*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"fc935dae-52df-4cd6-b94d-0f079ee50a6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "6"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.906026564850153*^9, 3.9060266519047823`*^9, 
  3.906026716349303*^9, 3.906026977323563*^9, 3.90660555633951*^9, 
  3.9066064594798956`*^9, 3.906609868553265*^9, 3.9072223201501207`*^9, 
  3.9072227438950057`*^9, 3.9072229043754096`*^9, 3.9072229708333073`*^9, 
  3.9075721959217405`*^9, 3.9075736563338103`*^9, 3.907582659034071*^9, 
  3.9075894723580723`*^9, 3.9075899324127626`*^9, 3.907597690016924*^9, 
  3.9076048511718884`*^9, 3.9076051820853353`*^9, 3.907615266303827*^9, 
  3.907643156792205*^9, 3.907654344554048*^9, 3.9076600707813053`*^9, 
  3.9076720310806704`*^9, 3.90777124023368*^9, 3.907810847131796*^9, 
  3.9078130165510044`*^9, 3.9078349187544217`*^9, 3.907838435350994*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"3ee51333-b9d8-4bc4-9b4e-265303ee859d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Polygon1", "[", "\"\<id\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Polygon4", "[", "\"\<id\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.9060267227328854`*^9, 3.906026733667339*^9}, {
   3.906026979011166*^9, 3.9060269899768677`*^9}, 3.9075722034051137`*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"f4fbf46f-528d-48b4-a6d7-b248ddee7f9b"],

Cell[BoxData["\<\"Polygon\"\>"], "Output",
 CellChangeTimes->{3.9060267347920713`*^9, 3.9060269907266755`*^9, 
  3.9066064605108967`*^9, 3.9066098733802085`*^9, 3.9072223213997564`*^9, 
  3.907222972083183*^9, 3.9075722037544518`*^9, 3.90757365723304*^9, 
  3.9075826605034695`*^9, 3.907589472439893*^9, 3.9075899325290537`*^9, 
  3.9075976900678167`*^9, 3.907604851255193*^9, 3.9076051821352887`*^9, 
  3.9076152664204845`*^9, 3.9076431568576593`*^9, 3.9076543446009054`*^9, 
  3.9076600709062767`*^9, 3.907672031158778*^9, 3.907771240296178*^9, 
  3.9078108472098985`*^9, 3.9078130166135263`*^9, 3.9078349188325605`*^9, 
  3.9078384354446383`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"844f8773-1771-4abe-9867-2467cb4c2d24"],

Cell[BoxData["\<\"Test polygon of three kmPoints as input\"\>"], "Output",
 CellChangeTimes->{3.9060267347920713`*^9, 3.9060269907266755`*^9, 
  3.9066064605108967`*^9, 3.9066098733802085`*^9, 3.9072223213997564`*^9, 
  3.907222972083183*^9, 3.9075722037544518`*^9, 3.90757365723304*^9, 
  3.9075826605034695`*^9, 3.907589472439893*^9, 3.9075899325290537`*^9, 
  3.9075976900678167`*^9, 3.907604851255193*^9, 3.9076051821352887`*^9, 
  3.9076152664204845`*^9, 3.9076431568576593`*^9, 3.9076543446009054`*^9, 
  3.9076600709062767`*^9, 3.907672031158778*^9, 3.907771240296178*^9, 
  3.9078108472098985`*^9, 3.9078130166135263`*^9, 3.9078349188325605`*^9, 
  3.9078384354446383`*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"28789c64-2e11-4c0f-b2bd-eaabc1b7396c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Polygon1", "[", "\"\<lineSegments\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Polygon2", "[", "\"\<lineSegments\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Polygon3", "[", "\"\<lineSegments\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Polygon4", "[", "\"\<lineSegments\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.9075729817222605`*^9, 3.907573005601472*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"4bdb5988-1763-4a39-b16a-60d5f531d096"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "4", "5"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "4", "5"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.907573006017047*^9, 3.9075730852238593`*^9, 3.907573141383752*^9, 
   3.9075735482469463`*^9, {3.9075736513008475`*^9, 3.907573658599759*^9}, 
   3.907573738056459*^9, {3.9075741115074224`*^9, 3.90757415240236*^9}, 
   3.9075742134287195`*^9, {3.907576785312762*^9, 3.9075768383556147`*^9}, 
   3.907576911262714*^9, 3.907582661850358*^9, 3.907589472540527*^9, 
   3.90758993268196*^9, 3.9075976901173906`*^9, 3.9076048513739166`*^9, 
   3.907605182202146*^9, 3.9076152665559645`*^9, 3.90764315694245*^9, 
   3.907654344663391*^9, 3.9076600710312457`*^9, 3.907672031236883*^9, 
   3.907771240358656*^9, 3.907810847319248*^9, 3.907813016691635*^9, 
   3.9078349189262466`*^9, 3.907838435507133*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"fc0e3136-fd23-4274-ac7b-61381d10dd7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"-", "5"}], "5"}, "RowWithSeparators"], "\")\""}, 
          "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "3", "7"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "3", "7"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "2", "6"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "2", "6"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "3", "4"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "3", "4"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"-", "5"}], "5"}, "RowWithSeparators"], "\")\""}, 
          "RowDefault"]}], "}"}]},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.907573006017047*^9, 3.9075730852238593`*^9, 3.907573141383752*^9, 
   3.9075735482469463`*^9, {3.9075736513008475`*^9, 3.907573658599759*^9}, 
   3.907573738056459*^9, {3.9075741115074224`*^9, 3.90757415240236*^9}, 
   3.9075742134287195`*^9, {3.907576785312762*^9, 3.9075768383556147`*^9}, 
   3.907576911262714*^9, 3.907582661850358*^9, 3.907589472540527*^9, 
   3.90758993268196*^9, 3.9075976901173906`*^9, 3.9076048513739166`*^9, 
   3.907605182202146*^9, 3.9076152665559645`*^9, 3.90764315694245*^9, 
   3.907654344663391*^9, 3.9076600710312457`*^9, 3.907672031236883*^9, 
   3.907771240358656*^9, 3.907810847319248*^9, 3.907813016691635*^9, 
   3.9078349189262466`*^9, 3.907838435522743*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"32187e4a-959f-44b6-a944-5cde79a2014e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "5"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "6"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "6"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"-", "4"}], 
             RowBox[{"-", "6"}]}, "RowWithSeparators"], "\")\""}, 
          "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"-", "4"}], 
             RowBox[{"-", "6"}]}, "RowWithSeparators"], "\")\""}, 
          "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "1", "5"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.907573006017047*^9, 3.9075730852238593`*^9, 3.907573141383752*^9, 
   3.9075735482469463`*^9, {3.9075736513008475`*^9, 3.907573658599759*^9}, 
   3.907573738056459*^9, {3.9075741115074224`*^9, 3.90757415240236*^9}, 
   3.9075742134287195`*^9, {3.907576785312762*^9, 3.9075768383556147`*^9}, 
   3.907576911262714*^9, 3.907582661850358*^9, 3.907589472540527*^9, 
   3.90758993268196*^9, 3.9075976901173906`*^9, 3.9076048513739166`*^9, 
   3.907605182202146*^9, 3.9076152665559645`*^9, 3.90764315694245*^9, 
   3.907654344663391*^9, 3.9076600710312457`*^9, 3.907672031236883*^9, 
   3.907771240358656*^9, 3.907810847319248*^9, 3.907813016691635*^9, 
   3.9078349189262466`*^9, 3.907838435538402*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"db1e4e20-3668-404c-9920-286baeebcfc4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "5", "2"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "7", "1"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "7", "1"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"-", "4"}], "7"}, "RowWithSeparators"], "\")\""}, 
          "RowDefault"]}], "}"}]},
    "RowDefault"], ",", 
   TemplateBox[{"\"Segment\"", "\": \"", 
     RowBox[{"{", 
       RowBox[{
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"-", "4"}], "7"}, "RowWithSeparators"], "\")\""}, 
          "RowDefault"], ",", 
         TemplateBox[{"\"Point\"", "\"(\"", 
           TemplateBox[{",", "\",\"", "5", "2"}, "RowWithSeparators"], 
           "\")\""}, "RowDefault"]}], "}"}]},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.907573006017047*^9, 3.9075730852238593`*^9, 3.907573141383752*^9, 
   3.9075735482469463`*^9, {3.9075736513008475`*^9, 3.907573658599759*^9}, 
   3.907573738056459*^9, {3.9075741115074224`*^9, 3.90757415240236*^9}, 
   3.9075742134287195`*^9, {3.907576785312762*^9, 3.9075768383556147`*^9}, 
   3.907576911262714*^9, 3.907582661850358*^9, 3.907589472540527*^9, 
   3.90758993268196*^9, 3.9075976901173906`*^9, 3.9076048513739166`*^9, 
   3.907605182202146*^9, 3.9076152665559645`*^9, 3.90764315694245*^9, 
   3.907654344663391*^9, 3.9076600710312457`*^9, 3.907672031236883*^9, 
   3.907771240358656*^9, 3.907810847319248*^9, 3.907813016691635*^9, 
   3.9078349189262466`*^9, 3.9078384355539865`*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"b2908b03-f869-427a-b5c3-ef1dc049cd35"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.", "Section",
 CellChangeTimes->{{3.9072224108210764`*^9, 
  3.9072224249049854`*^9}},ExpressionUUID->"5411dc08-fff0-4935-81c4-\
7c11289b7fa8"],

Cell[CellGroupData[{

Cell[TextData[{
 "1.",
 
 CounterBox["Subsection"],
 ". \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\
\:0446\:0438\:044e, \:0432\:044b\:0447\:0438\:0441\:043b\:044f\:044e\:0449\
\:0443\:044e \:043f\:0435\:0440\:0438\:043c\:0435\:0442\:0440 \:043f\:0440\
\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\:0433\:043e \:043f\
\:043e\:043b\:0438\:0433\:043e\:043d\:0430."
}], "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, 
   3.90602517482656*^9, {3.907222466232871*^9, 3.907222466347333*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"f227b8bb-b39f-4acc-b15b-4c736d4e764c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPolygonPerimeter", "[", "Polygon_kmPolygon", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", "\"\<len\>\"", "]"}], "&"}], "/@", 
     RowBox[{"Polygon", "[", "\"\<lineSegments\>\"", "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9072225232410574`*^9, 3.9072225613073673`*^9}, {
  3.9075754980637197`*^9, 3.9075755001131067`*^9}, {3.907575976568356*^9, 
  3.9075760093966284`*^9}, {3.9075760577745094`*^9, 3.907576059857889*^9}, {
  3.9075761422955604`*^9, 3.90757614534665*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[102]:=",ExpressionUUID->"a0ad85b5-851e-4cab-804d-0f75295bc322"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getPolygonPerimeter", "[", "Polygon1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPolygonPerimeter", "[", "Polygon2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPolygonPerimeter", "[", "Polygon3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPolygonPerimeter", "[", "Polygon4", "]"}]}], "Input",
 CellChangeTimes->{{3.907576026028341*^9, 3.9075760457425537`*^9}, 
   3.907590000372239*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"e87dd110-bdb8-433c-ba62-9c7a0a63864b"],

Cell[BoxData[
 RowBox[{"7", "+", 
  SqrtBox["13"]}]], "Output",
 CellChangeTimes->{{3.907576046141691*^9, 3.9075760611894956`*^9}, 
   3.9075761524613733`*^9, 3.9075769562571573`*^9, 3.9075826646498203`*^9, 
   3.907589472722212*^9, 3.907589932913898*^9, 3.907597690235551*^9, 
   3.907604851538371*^9, 3.907605182304006*^9, 3.907615266772577*^9, 
   3.907643157057826*^9, 3.907654344803983*^9, 3.907660071265568*^9, 
   3.907672031393097*^9, 3.907771240515051*^9, 3.907810847569189*^9, 
   3.9078130168322515`*^9, 3.9078349190824604`*^9, 3.9078384356320934`*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"94c19a0d-6e85-4dc9-a430-34ac003ab01d"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "+", 
  SqrtBox["5"], "+", 
  RowBox[{"2", " ", 
   SqrtBox["17"]}], "+", 
  SqrtBox["65"]}]], "Output",
 CellChangeTimes->{{3.907576046141691*^9, 3.9075760611894956`*^9}, 
   3.9075761524613733`*^9, 3.9075769562571573`*^9, 3.9075826646498203`*^9, 
   3.907589472722212*^9, 3.907589932913898*^9, 3.907597690235551*^9, 
   3.907604851538371*^9, 3.907605182304006*^9, 3.907615266772577*^9, 
   3.907643157057826*^9, 3.907654344803983*^9, 3.907660071265568*^9, 
   3.907672031393097*^9, 3.907771240515051*^9, 3.907810847569189*^9, 
   3.9078130168322515`*^9, 3.9078349190824604`*^9, 3.907838435647749*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"3fa54409-dda2-4126-ab02-e0ddec0cb612"],

Cell[BoxData[
 RowBox[{"14", "+", 
  SqrtBox["146"]}]], "Output",
 CellChangeTimes->{{3.907576046141691*^9, 3.9075760611894956`*^9}, 
   3.9075761524613733`*^9, 3.9075769562571573`*^9, 3.9075826646498203`*^9, 
   3.907589472722212*^9, 3.907589932913898*^9, 3.907597690235551*^9, 
   3.907604851538371*^9, 3.907605182304006*^9, 3.907615266772577*^9, 
   3.907643157057826*^9, 3.907654344803983*^9, 3.907660071265568*^9, 
   3.907672031393097*^9, 3.907771240515051*^9, 3.907810847569189*^9, 
   3.9078130168322515`*^9, 3.9078349190824604`*^9, 3.907838435663335*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"335eaf9c-44b8-410c-98b0-b7a3b300f0db"],

Cell[BoxData[
 RowBox[{
  SqrtBox["5"], "+", 
  SqrtBox["106"], "+", 
  SqrtBox["157"]}]], "Output",
 CellChangeTimes->{{3.907576046141691*^9, 3.9075760611894956`*^9}, 
   3.9075761524613733`*^9, 3.9075769562571573`*^9, 3.9075826646498203`*^9, 
   3.907589472722212*^9, 3.907589932913898*^9, 3.907597690235551*^9, 
   3.907604851538371*^9, 3.907605182304006*^9, 3.907615266772577*^9, 
   3.907643157057826*^9, 3.907654344803983*^9, 3.907660071265568*^9, 
   3.907672031393097*^9, 3.907771240515051*^9, 3.907810847569189*^9, 
   3.9078130168322515`*^9, 3.9078349190824604`*^9, 3.907838435663335*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"1d26347e-e13c-41c7-8400-16142c184b52"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1.",
 
 CounterBox["Subsection"],
 ". \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\
\:0446\:0438\:044e,\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:044e\:0449\
\:0443\:044e \:043f\:043b\:043e\:0449\:0430\:0434\:044c \:043f\:0440\:043e\
\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\:0433\:043e \:043f\:0440\
\:043e\:0441\:0442\:043e\:0433\:043e\n\:043f\:043e\:043b\:0438\:0433\:043e\
\:043d\:0430."
}], "Subsection",
 CellMargins->{{81, 10}, {0, 4}},
 CellChangeTimes->{{3.6908843608427973`*^9, 3.6908843794889617`*^9}, {
   3.691482474261738*^9, 3.691482639825675*^9}, {3.6931954464776735`*^9, 
   3.6931954520466075`*^9}, {3.6931955654219403`*^9, 3.69319559517402*^9}, {
   3.6942571597961006`*^9, 3.6942571616874404`*^9}, {3.696036739835747*^9, 
   3.696036740010311*^9}, {3.6997736102861757`*^9, 3.699773616268401*^9}, 
   3.90602517482656*^9, {3.907222466232871*^9, 3.907222466347333*^9}, {
   3.9075790561205006`*^9, 3.907579057803829*^9}},
 FontFamily->
  "Arial Narrow",ExpressionUUID->"0f3b2500-54fa-457c-aae3-fd8e559b4bc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getTriangleAlgebraicSquare", "[", "points_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}]}], 
     "}"}], ",", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "-", "a"}], ",", 
        RowBox[{"c", "-", "a"}]}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907579124077417*^9, 3.9075791840032396`*^9}, {
  3.9075792849246655`*^9, 3.9075792927893963`*^9}, {3.9075793679310713`*^9, 
  3.9075793701121874`*^9}, {3.907579847484683*^9, 3.90757985575058*^9}, {
  3.907579912409835*^9, 3.907579979351604*^9}, {3.9075801213834467`*^9, 
  3.9075801692602053`*^9}, {3.907580223070196*^9, 3.907580228452777*^9}, {
  3.907580308409458*^9, 3.9075803251067133`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[107]:=",ExpressionUUID->"2a6611f7-f463-46f2-b79e-39688b1f4a84"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"1e2ecab9-70b5-4e27-b30f-885a9071285f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getTriangleAlgebraicSquare", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", 
       RowBox[{"-", "3"}]}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "6"}]}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.907579961670278*^9, 3.9075800047811823`*^9}, {
  3.907580080605012*^9, 3.9075801083006105`*^9}, {3.9075802851459503`*^9, 
  3.907580286761532*^9}, {3.907580747903302*^9, 3.9075807505012813`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"ace2476c-3557-493a-8bbe-855b5947b9f4"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{
  3.907580109416916*^9, {3.907580159210351*^9, 3.9075801704916964`*^9}, 
   3.9075802295349474`*^9, {3.9075802878442*^9, 3.907580326221071*^9}, 
   3.907580750917862*^9, 3.9075826673163443`*^9, 3.9075894728593426`*^9, 
   3.90758993311265*^9, 3.9075976903680363`*^9, 3.90760485165722*^9, 
   3.9076051824861145`*^9, 3.907615266939386*^9, 3.9076431571590033`*^9, 
   3.90765434497582*^9, 3.907660071515507*^9, 3.9076720317211485`*^9, 
   3.9077712407649937`*^9, 3.907810847834771*^9, 3.9078130169415765`*^9, 
   3.907834919207433*^9, 3.907838435725827*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"ae8ba57c-4cc2-42a7-8a6a-e461397de755"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPairsOfPoints", "[", "Polygon_kmPolygon", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"points", "=", 
      RowBox[{"Polygon", "[", "\"\<points\>\"", "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"points", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"points", "[", 
         RowBox[{"[", 
          RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"Length", "[", "points", "]"}], "-", "1"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.907580783814083*^9, 3.907580814943311*^9}, {
  3.907580889500913*^9, 3.9075809076984825`*^9}, {3.907581000669982*^9, 
  3.9075810450972166`*^9}, {3.907581086606968*^9, 3.907581179113427*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[109]:=",ExpressionUUID->"e419a25b-3e82-4361-a315-03690684129d"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"97e3f620-1cd5-4662-b024-92ed1557c9ec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getPairsOfPoints", "[", "Polygon1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPairsOfPoints", "[", "Polygon2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPairsOfPoints", "[", "Polygon3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPairsOfPoints", "[", "Polygon4", "]"}]}], "Input",
 CellChangeTimes->{{3.9075811688633213`*^9, 3.907581171097715*^9}, {
  3.907581212825405*^9, 3.9075812194920273`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"a36a7e5e-9d2a-4235-be31-b11e653cf178"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
     "RowDefault"], ",", 
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], "\")\""},
     "RowDefault"], ",", 
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "4", "5"}, "RowWithSeparators"], "\")\""},
     "RowDefault"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.907581171446605*^9, 3.9075811806458216`*^9}, 
   3.9075812200742188`*^9, 3.9075826696326756`*^9, 3.9075894729565077`*^9, 
   3.9075899332509966`*^9, 3.9075976904183965`*^9, 3.9076048517591567`*^9, 
   3.90760518255194*^9, 3.907615267074833*^9, 3.907643157207695*^9, 
   3.9076543450383043`*^9, 3.9076600716560984`*^9, 3.907672031814873*^9, 
   3.907771240827289*^9, 3.9078108479128604`*^9, 3.9078130170196686`*^9, 
   3.90783491930116*^9, 3.9078384357884164`*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"6ef67898-175e-4fc2-baa0-c677e610334e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"Point\"", "\"(\"", 
       TemplateBox[{",", "\",\"", 
         RowBox[{"-", "5"}], "5"}, "RowWithSeparators"], "\")\""},
      "RowDefault"], ",", 
     TemplateBox[{"\"Point\"", "\"(\"", 
       TemplateBox[{",", "\",\"", "3", "7"}, "RowWithSeparators"], "\")\""},
      "RowDefault"], ",", 
     TemplateBox[{"\"Point\"", "\"(\"", 
       TemplateBox[{",", "\",\"", "2", "6"}, "RowWithSeparators"], "\")\""},
      "RowDefault"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"Point\"", "\"(\"", 
       TemplateBox[{",", "\",\"", 
         RowBox[{"-", "5"}], "5"}, "RowWithSeparators"], "\")\""},
      "RowDefault"], ",", 
     TemplateBox[{"\"Point\"", "\"(\"", 
       TemplateBox[{",", "\",\"", "2", "6"}, "RowWithSeparators"], "\")\""},
      "RowDefault"], ",", 
     TemplateBox[{"\"Point\"", "\"(\"", 
       TemplateBox[{",", "\",\"", "3", "4"}, "RowWithSeparators"], "\")\""},
      "RowDefault"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.907581171446605*^9, 3.9075811806458216`*^9}, 
   3.9075812200742188`*^9, 3.9075826696326756`*^9, 3.9075894729565077`*^9, 
   3.9075899332509966`*^9, 3.9075976904183965`*^9, 3.9076048517591567`*^9, 
   3.90760518255194*^9, 3.907615267074833*^9, 3.907643157207695*^9, 
   3.9076543450383043`*^9, 3.9076600716560984`*^9, 3.907672031814873*^9, 
   3.907771240827289*^9, 3.9078108479128604`*^9, 3.9078130170196686`*^9, 
   3.90783491930116*^9, 3.9078384358039627`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"b192e721-eb94-42ea-b1a2-1da5f3bd0bc6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "1", "5"}, "RowWithSeparators"], "\")\""},
     "RowDefault"], ",", 
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "1", "6"}, "RowWithSeparators"], "\")\""},
     "RowDefault"], ",", 
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", 
        RowBox[{"-", "4"}], 
        RowBox[{"-", "6"}]}, "RowWithSeparators"], "\")\""},
     "RowDefault"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.907581171446605*^9, 3.9075811806458216`*^9}, 
   3.9075812200742188`*^9, 3.9075826696326756`*^9, 3.9075894729565077`*^9, 
   3.9075899332509966`*^9, 3.9075976904183965`*^9, 3.9076048517591567`*^9, 
   3.90760518255194*^9, 3.907615267074833*^9, 3.907643157207695*^9, 
   3.9076543450383043`*^9, 3.9076600716560984`*^9, 3.907672031814873*^9, 
   3.907771240827289*^9, 3.9078108479128604`*^9, 3.9078130170196686`*^9, 
   3.90783491930116*^9, 3.9078384358195486`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"06edd4d8-8868-46a7-9754-86e0d71aa8ab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "5", "2"}, "RowWithSeparators"], "\")\""},
     "RowDefault"], ",", 
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", "7", "1"}, "RowWithSeparators"], "\")\""},
     "RowDefault"], ",", 
    TemplateBox[{"\"Point\"", "\"(\"", 
      TemplateBox[{",", "\",\"", 
        RowBox[{"-", "4"}], "7"}, "RowWithSeparators"], "\")\""},
     "RowDefault"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.907581171446605*^9, 3.9075811806458216`*^9}, 
   3.9075812200742188`*^9, 3.9075826696326756`*^9, 3.9075894729565077`*^9, 
   3.9075899332509966`*^9, 3.9075976904183965`*^9, 3.9076048517591567`*^9, 
   3.90760518255194*^9, 3.907615267074833*^9, 3.907643157207695*^9, 
   3.9076543450383043`*^9, 3.9076600716560984`*^9, 3.907672031814873*^9, 
   3.907771240827289*^9, 3.9078108479128604`*^9, 3.9078130170196686`*^9, 
   3.90783491930116*^9, 3.90783843583517*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"7a92c7a3-29db-4920-b076-f411280543a7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPolygonSquare", "[", "Polygon_kmPolygon", "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"getTriangleAlgebraicSquare", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"getPairsOfPoints", "[", "Polygon", "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.907579067835889*^9, 3.9075790904159346`*^9}, {
  3.9075812726181936`*^9, 3.907581301730605*^9}, {3.9075813423258333`*^9, 
  3.9075813467252655`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[114]:=",ExpressionUUID->"84e2ba80-609c-4170-928c-2184dc6faba2"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"1e09dbd2-154c-410d-9eb5-ff190e7c2f34"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getPolygonSquare", "[", "Polygon1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPolygonSquare", "[", "Polygon2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPolygonSquare", "[", "Polygon3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"getPolygonSquare", "[", "Polygon4", "]"}]}], "Input",
 CellChangeTimes->{{3.907581314979531*^9, 3.9075813310772943`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"7c972da2-9ed1-4ad4-b0bc-1ef1d9a993b2"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.907581318644202*^9, 3.907581348907008*^9}, 
   3.9075826715657997`*^9, 3.907589473288618*^9, 3.9075899334482346`*^9, 
   3.9075976905512676`*^9, 3.90760485192407*^9, 3.9076051826373796`*^9, 
   3.907615267286131*^9, 3.907643157309456*^9, 3.907654345147652*^9, 
   3.907660071921671*^9, 3.9076720319710865`*^9, 3.9077712410772495`*^9, 
   3.90781084817842*^9, 3.907813017160236*^9, 3.9078349194417877`*^9, 
   3.9078384358976893`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"2b0b958b-98a1-48b7-ade6-000701983088"],

Cell[BoxData[
 FractionBox["21", "2"]], "Output",
 CellChangeTimes->{{3.907581318644202*^9, 3.907581348907008*^9}, 
   3.9075826715657997`*^9, 3.907589473288618*^9, 3.9075899334482346`*^9, 
   3.9075976905512676`*^9, 3.90760485192407*^9, 3.9076051826373796`*^9, 
   3.907615267286131*^9, 3.907643157309456*^9, 3.907654345147652*^9, 
   3.907660071921671*^9, 3.9076720319710865`*^9, 3.9077712410772495`*^9, 
   3.90781084817842*^9, 3.907813017160236*^9, 3.9078349194417877`*^9, 
   3.9078384359132757`*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"17ba2858-148f-48fe-9784-616b862c9ca3"],

Cell[BoxData[
 FractionBox["5", "2"]], "Output",
 CellChangeTimes->{{3.907581318644202*^9, 3.907581348907008*^9}, 
   3.9075826715657997`*^9, 3.907589473288618*^9, 3.9075899334482346`*^9, 
   3.9075976905512676`*^9, 3.90760485192407*^9, 3.9076051826373796`*^9, 
   3.907615267286131*^9, 3.907643157309456*^9, 3.907654345147652*^9, 
   3.907660071921671*^9, 3.9076720319710865`*^9, 3.9077712410772495`*^9, 
   3.90781084817842*^9, 3.907813017160236*^9, 3.9078349194417877`*^9, 
   3.9078384359132757`*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"8aa76ab9-a088-4411-bd3f-8924cc165489"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.907581318644202*^9, 3.907581348907008*^9}, 
   3.9075826715657997`*^9, 3.907589473288618*^9, 3.9075899334482346`*^9, 
   3.9075976905512676`*^9, 3.90760485192407*^9, 3.9076051826373796`*^9, 
   3.907615267286131*^9, 3.907643157309456*^9, 3.907654345147652*^9, 
   3.907660071921671*^9, 3.9076720319710865`*^9, 3.9077712410772495`*^9, 
   3.90781084817842*^9, 3.907813017160236*^9, 3.9078349194417877`*^9, 
   3.9078384359289*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"aacf55b6-37a1-4ea8-890b-9b652569a4b4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
1.3 . \:0421\:043e\:0437\:0434\:0430\:0439\:0442\:0435 \:0442\:0435\:0441\
\:0442 - \:0444\:0443\:043d\:043a\:0446\:0438\:044e \:0434\:043b\:044f \:043e\
\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f \:043d\:0430\
\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\:044f \:043e\:0431\:0445\
\:043e\:0434\:0430 \:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\:044c\
\:043d\:043e\:0433\:043e
\:043f\:0440\:043e\:0441\:0442\:043e\:0433\:043e \:043f\:043e\:043b\:0438\
\:0433\:043e\:043d\:0430 .\
\>", "Subsection",
 CellChangeTimes->{{3.9075821303209963`*^9, 
  3.907582145885234*^9}},ExpressionUUID->"37c4b324-fee1-4369-8228-\
a053674ecd2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "isBypassAroundPolygonCounterclockwise", "[", "Polygon_kmPolygon", "]"}], ":=", 
  RowBox[{
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"getTriangleAlgebraicSquare", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"getPairsOfPoints", "[", "Polygon", "]"}]}], ")"}]}], ">", 
   "0"}]}]], "Input",
 CellChangeTimes->{{3.907582297630889*^9, 3.907582303414999*^9}, {
  3.9075824001011877`*^9, 3.9075824002011127`*^9}, {3.9075824422471523`*^9, 
  3.9075824678935843`*^9}, {3.907582796267979*^9, 3.907582796551265*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[119]:=",ExpressionUUID->"b99b3c90-d935-4f7a-8b90-6d5b9efac648"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"706ec70b-2c21-4c95-8caa-85917e374dc8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"isBypassAroundPolygonCounterclockwise", "[", "Polygon1", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"isBypassAroundPolygonCounterclockwise", "[", "Polygon2", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"isBypassAroundPolygonCounterclockwise", "[", "Polygon3", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"isBypassAroundPolygonCounterclockwise", "[", "Polygon4", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.907582477009369*^9, 3.9075824897231045`*^9}, {
  3.9075827539560795`*^9, 3.9075828023162766`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"1b4c95c6-1b73-465f-8690-e4acbdd412bd"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.907582490839749*^9, 3.9075826762649927`*^9, {3.9075827912345247`*^9, 
   3.9075828028993254`*^9}, 3.907589473440507*^9, 3.9075899336147995`*^9, 
   3.9075976906190243`*^9, 3.9076048521218653`*^9, 3.90760518271966*^9, 
   3.9076152674383373`*^9, 3.907643157407979*^9, 3.9076543452257595`*^9, 
   3.907660072046633*^9, 3.907672032111683*^9, 3.907771241186615*^9, 
   3.907810848287773*^9, 3.907813017253975*^9, 3.9078349196135855`*^9, 
   3.9078384359913836`*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"5abfd1b8-41d7-4cee-aad1-af4c34ad3bf5"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.907582490839749*^9, 3.9075826762649927`*^9, {3.9075827912345247`*^9, 
   3.9075828028993254`*^9}, 3.907589473440507*^9, 3.9075899336147995`*^9, 
   3.9075976906190243`*^9, 3.9076048521218653`*^9, 3.90760518271966*^9, 
   3.9076152674383373`*^9, 3.907643157407979*^9, 3.9076543452257595`*^9, 
   3.907660072046633*^9, 3.907672032111683*^9, 3.907771241186615*^9, 
   3.907810848287773*^9, 3.907813017253975*^9, 3.9078349196135855`*^9, 
   3.907838436007041*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"9c2c1efa-ee82-4509-85e8-2f3afdfe3bf6"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.907582490839749*^9, 3.9075826762649927`*^9, {3.9075827912345247`*^9, 
   3.9075828028993254`*^9}, 3.907589473440507*^9, 3.9075899336147995`*^9, 
   3.9075976906190243`*^9, 3.9076048521218653`*^9, 3.90760518271966*^9, 
   3.9076152674383373`*^9, 3.907643157407979*^9, 3.9076543452257595`*^9, 
   3.907660072046633*^9, 3.907672032111683*^9, 3.907771241186615*^9, 
   3.907810848287773*^9, 3.907813017253975*^9, 3.9078349196135855`*^9, 
   3.907838436007041*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"67cc30ba-1950-4d4f-9b60-73772265ad5c"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.907582490839749*^9, 3.9075826762649927`*^9, {3.9075827912345247`*^9, 
   3.9075828028993254`*^9}, 3.907589473440507*^9, 3.9075899336147995`*^9, 
   3.9075976906190243`*^9, 3.9076048521218653`*^9, 3.90760518271966*^9, 
   3.9076152674383373`*^9, 3.907643157407979*^9, 3.9076543452257595`*^9, 
   3.907660072046633*^9, 3.907672032111683*^9, 3.907771241186615*^9, 
   3.907810848287773*^9, 3.907813017253975*^9, 3.9078349196135855`*^9, 
   3.907838436038246*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"28dc224f-6b8e-44f2-bdc0-083602d9a22b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
1.4 . \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0442\:0435\:0441\
\:0442 - \:0444\:0443\:043d\:043a\:0446\:0438\:044e \:0432\:044b\:043f\:0443\
\:043a\:043b\:043e\:0441\:0442\:0438 \:043f\:0440\:043e\:0438\:0437\:0432\
\:043e\:043b\:044c\:043d\:043e\:0433\:043e \:043f\:0440\:043e\:0441\:0442\
\:043e\:0433\:043e \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430 .\
\>", "Subsection",
 CellChangeTimes->{{3.9075828282636833`*^9, 
  3.90758285321102*^9}},ExpressionUUID->"8b970add-e736-4703-9e07-\
65e439d9c9df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isPolygonConvex", "[", "Polygon_kmPolygon", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"points", "=", 
      RowBox[{"Polygon", "[", "\"\<points\>\"", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getTriangleAlgebraicSquare", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"points", "[", 
             RowBox[{"[", "#", "]"}], "]"}], ",", 
            RowBox[{"points", "[", 
             RowBox[{"[", 
              RowBox[{"#", "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"points", "[", 
             RowBox[{"[", 
              RowBox[{"#", "+", "2"}], "]"}], "]"}]}], "}"}], "]"}], ">", 
         "0"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Length", "[", "points", "]"}], "-", "2"}], "]"}]}], 
      ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9075853363736715`*^9, 3.907585343020779*^9}, {
  3.907585730221713*^9, 3.907585912199899*^9}, {3.907585981356981*^9, 
  3.9075860029047585`*^9}, {3.9075887368342896`*^9, 3.907588803875929*^9}, {
  3.9075889876528726`*^9, 3.907589018664993*^9}, {3.9075892484354954`*^9, 
  3.907589248769272*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[124]:=",ExpressionUUID->"6f843795-98ce-46cc-a818-85daa8937f38"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"f3d0cf78-6db8-4e3d-acab-c86f7c84d70f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"isPolygonConvex", "[", "Polygon3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"isPolygonConvex", "[", "Polygon4", "]"}]}], "Input",
 CellChangeTimes->{{3.907585993922148*^9, 3.907586022817566*^9}, {
  3.907588976519902*^9, 3.9075889770544147`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"9dac3e56-4976-4f87-bc18-ff4bd60a3f40"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9075892725483294`*^9, 3.907589473591339*^9, 
  3.9075899338143888`*^9, 3.9075976907167006`*^9, 3.9076048522549396`*^9, 
  3.907605182903673*^9, 3.9076152676059704`*^9, 3.907643157490451*^9, 
  3.90765434530388*^9, 3.907660072187224*^9, 3.9076720322522697`*^9, 
  3.9077712412803087`*^9, 3.907810848397123*^9, 3.907813017363348*^9, 
  3.9078349197541795`*^9, 3.9078384361056833`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"329ae625-96b9-4a58-b9c9-14876d53b970"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9075892725483294`*^9, 3.907589473591339*^9, 
  3.9075899338143888`*^9, 3.9075976907167006`*^9, 3.9076048522549396`*^9, 
  3.907605182903673*^9, 3.9076152676059704`*^9, 3.907643157490451*^9, 
  3.90765434530388*^9, 3.907660072187224*^9, 3.9076720322522697`*^9, 
  3.9077712412803087`*^9, 3.907810848397123*^9, 3.907813017363348*^9, 
  3.9078349197541795`*^9, 3.907838436121311*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"4f114f03-2ca5-4038-8672-3cbe6675c3c0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Polygon5", "=", 
   RowBox[{"kmPolygon", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polygon6", "=", 
   RowBox[{"kmPolygon", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.907590053414953*^9, 3.9075900986756105`*^9}, {
  3.9076061297244587`*^9, 3.9076061301587133`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"fb0ac5d1-1668-4586-a8de-1f9f123ddc56"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"isPolygonConvex", "[", "Polygon5", "]"}], "\[IndentingNewLine]", 
 RowBox[{"isPolygonConvex", "[", "Polygon6", "]"}]}], "Input",
 CellChangeTimes->{{3.9075899610434012`*^9, 3.907589964693514*^9}, {
  3.90759009324305*^9, 3.9075900948268757`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"7fe74c53-9dfa-4ba6-978f-7f2213cb2323"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9075899649417405`*^9, 3.9075900953080373`*^9, 
  3.9075976907830353`*^9, 3.907604852375848*^9, 3.90760518296737*^9, 
  3.9076061347893267`*^9, 3.9076071297279463`*^9, 3.907615267739119*^9, 
  3.907643157558513*^9, 3.9076543453819733`*^9, 3.9076600723278155`*^9, 
  3.9076720323928623`*^9, 3.907771241342831*^9, 3.9078108484908514`*^9, 
  3.9078130174414268`*^9, 3.9078349198479133`*^9, 3.9078384361838474`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"032ef3e3-788b-4c96-bd40-1940a07649a1"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.9075899649417405`*^9, 3.9075900953080373`*^9, 
  3.9075976907830353`*^9, 3.907604852375848*^9, 3.90760518296737*^9, 
  3.9076061347893267`*^9, 3.9076071297279463`*^9, 3.907615267739119*^9, 
  3.907643157558513*^9, 3.9076543453819733`*^9, 3.9076600723278155`*^9, 
  3.9076720323928623`*^9, 3.907771241342831*^9, 3.9078108484908514`*^9, 
  3.9078130174414268`*^9, 3.9078349198479133`*^9, 3.9078384361994343`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"615cda77-2eb1-46e6-8423-a99d48f9fdb9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.5 . \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0442\:0435\
\:0441\:0442 - \:0444\:0443\:043d\:043a\:0446\:0438\:044e \:0441\:0430\:043c\
\:043e\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\:044f \
\:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430 .", "Subsection",
 CellChangeTimes->{{3.907590124639877*^9, 
  3.907590128788108*^9}},ExpressionUUID->"4275ed3d-c8c8-4ba5-910e-\
9549e35df5f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isPolygonHasSelfIntersections", "[", "polygon_kmPolygon", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"segments", "=", 
       RowBox[{"polygon", "[", "\"\<lineSegments\>\"", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{
         RowBox[{"Length", "[", "segments", "]"}], "-", "2"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", 
          RowBox[{"i", "+", "2"}]}], ",", 
         RowBox[{"j", "<=", 
          RowBox[{"Length", "@", "segments"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"res", ",", 
            RowBox[{"getParametersOfIntersection", "[", 
             RowBox[{
              RowBox[{"segments", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"segments", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "3"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "@", "segments"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"res", ",", 
          RowBox[{"getParametersOfIntersection", "[", 
           RowBox[{
            RowBox[{"segments", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"segments", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ContainsAny", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"0", "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", "1"}], "&&", 
           RowBox[{"0", "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<=", "1"}]}], "&"}], "/@", 
         "res"}], ")"}], ",", 
       RowBox[{"{", "True", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.90760700273077*^9, 3.907607105549929*^9}, {
   3.9076071874041395`*^9, 3.9076072306288695`*^9}, {3.9076074556000977`*^9, 
   3.907607461832054*^9}, {3.907607945581172*^9, 3.9076079775586023`*^9}, {
   3.90760801525319*^9, 3.9076080224850903`*^9}, {3.907608062047367*^9, 
   3.9076080638312173`*^9}, {3.9076083411413584`*^9, 3.9076083825521727`*^9}, 
   3.9076084130988765`*^9, {3.9076084548087378`*^9, 3.907608455125906*^9}, {
   3.9076086962245865`*^9, 3.9076086968581057`*^9}, 3.907608726988902*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[131]:=",ExpressionUUID->"257660c2-8abd-41b5-a270-ff47d1c47c30"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"5e348f00-8bff-4385-a326-389442531813"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"isPolygonHasSelfIntersections", "[", "Polygon5", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"isPolygonHasSelfIntersections", "[", "Polygon6", "]"}]}], "Input",
 CellChangeTimes->{{3.907607112798965*^9, 3.9076071180812373`*^9}, {
  3.907607467731595*^9, 3.907607473762512*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"c930c453-ca6a-4186-ad6f-f763a69c23b8"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.9076071185633163`*^9, 3.907607190103222*^9, {3.907607223698412*^9, 
   3.9076072329136467`*^9}, 3.9076074230538454`*^9, {3.9076074590314198`*^9, 
   3.907607474113263*^9}, 3.907607948046337*^9, 3.907608025651543*^9, 
   3.9076080650292115`*^9, 3.907608417480481*^9, 3.907608457091544*^9, 
   3.9076085756256895`*^9, 3.9076087289374285`*^9, 3.9076087603329597`*^9, 
   3.907615267872529*^9, 3.907643157623885*^9, 3.907654345460082*^9, {
   3.9076600741555276`*^9, 3.9076600946751842`*^9}, {3.9076720337206755`*^9, 
   3.9076720581456847`*^9}, 3.9077712424362864`*^9, 3.907771372285987*^9, 
   3.9078108501310973`*^9, 3.9078130178007464`*^9, 3.907814969993038*^9, 
   3.9078349200509825`*^9, 3.907838436371256*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"c479ed51-b1d7-4799-90a2-533482b81a39"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.9076071185633163`*^9, 3.907607190103222*^9, {3.907607223698412*^9, 
   3.9076072329136467`*^9}, 3.9076074230538454`*^9, {3.9076074590314198`*^9, 
   3.907607474113263*^9}, 3.907607948046337*^9, 3.907608025651543*^9, 
   3.9076080650292115`*^9, 3.907608417480481*^9, 3.907608457091544*^9, 
   3.9076085756256895`*^9, 3.9076087289374285`*^9, 3.9076087603329597`*^9, 
   3.907615267872529*^9, 3.907643157623885*^9, 3.907654345460082*^9, {
   3.9076600741555276`*^9, 3.9076600946751842`*^9}, {3.9076720337206755`*^9, 
   3.9076720581456847`*^9}, 3.9077712424362864`*^9, 3.907771372285987*^9, 
   3.9078108501310973`*^9, 3.9078130178007464`*^9, 3.907814969993038*^9, 
   3.9078349200509825`*^9, 3.907838436418151*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"1557663a-c716-4091-8bb7-ddfe4d40d549"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Polygon7", "=", 
   RowBox[{"kmPolygon", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"isPolygonHasSelfIntersections", "[", "Polygon7", "]"}]}], "Input",
 CellChangeTimes->{{3.9076075170240874`*^9, 3.907607517374315*^9}, {
   3.9076075625181117`*^9, 3.90760757683243*^9}, {3.9076076136943183`*^9, 
   3.907607697865663*^9}, 3.9076079287159452`*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"6626089e-b03e-4449-8e7f-02f8f14f175c"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.907607577181876*^9, 3.9076077004143934`*^9, {3.9076079295651064`*^9, 
   3.907607951545208*^9}, 3.9076080662791176`*^9, 3.907608462125065*^9, 
   3.9076085764252687`*^9, {3.907608731703952*^9, 3.9076087612833176`*^9}, 
   3.9076152679870224`*^9, 3.9076431576912594`*^9, 3.907654345538196*^9, {
   3.9076600747022605`*^9, 3.907660098166341*^9}, {3.907672034345529*^9, 
   3.907672060974698*^9}, 3.907771242920552*^9, 3.907771373520034*^9, 
   3.907810850271681*^9, 3.9078130182068653`*^9, 3.9078149710396676`*^9, 
   3.907834920176008*^9, 3.907838436527466*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"768fd6b3-366a-4484-bf58-5a81508cca13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "7"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "5"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.907608085760302*^9, 3.9076080890935197`*^9}, 
   3.907608482138617*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"0e250d1b-13ac-4e8b-998d-c4628906be92"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[
      TagBox[
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[2], 
        PointBox[{{3., 9.}, {4., 6.}, {8., 7.}, {6., 9.}, {2., 5.}}]},
       Annotation[#, "Charting`Private`Tag#1"]& ],
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{
          Annotation[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            Point[{{3., 9.}, {4., 6.}, {8., 7.}, {6., 9.}, {2., 5.}}]}, 
           "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{1.8750000000000047`, 8.}, {4.777777777777788, 9.}},
            "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {1.8750000000000047`, 4.777777777777788}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              PointSize[0.012833333333333334`], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{1.8750000000000047`, 8.}, {4.777777777777788, 9.}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {1.8750000000000047`, 4.777777777777788}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}]},
    Annotation[{{
       Annotation[{
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Point[{{3., 9.}, {4., 6.}, {8., 7.}, {6., 9.}, {2., 5.}}]}, 
        "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PlotRange" -> {{1.8750000000000047`, 8.}, {4.777777777777788, 9.}}, 
        "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {1.8750000000000047`, 4.777777777777788}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{1.8750000000000047`, 4.777777777777788},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentPoint", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{1.8750000000000047`, 8.}, {4.777777777777788, 9.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.907608089575803*^9, 3.9076084831211343`*^9, 
  3.907615270220216*^9, 3.907643158107031*^9, 3.907654349037463*^9, 
  3.907660078725892*^9, 3.907672038778997*^9, 3.907771246372888*^9, 
  3.9078108584890556`*^9, 3.907813018363077*^9, 3.9078349227378883`*^9, 
  3.907838439229988*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"88fb7e3e-bdbb-4c39-894d-8651e545f1a8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.6 . \:041d\:0430\:043f\:0438\
\:0448\:0438\:0442\:0435 \:0431\:0443\:043b\:0435\:0432\:0443 \:0444\:0443\
\:043d\:043a\:0446\:0438\:044e, \:043e\:043f\:0440\:0435\:0434\:0435\:043b\
\:044f\:044e\:0449\:0443\:044e \:043f\:0435\:0440\:0435\:0441\:0435\:0447\
\:0435\:043d\:0438\:0435
\:043f\:0440\:044f\:043c\:043e\:0439 \:0438 \:043f\:043e\:043b\:0438\:0433\
\:043e\:043d\:0430.\
\>", "Subsection",
 CellChangeTimes->{{3.9076087791475525`*^9, 3.907608789196641*^9}, 
   3.907608822658777*^9},ExpressionUUID->"04b0059e-f8fa-44f7-8ed7-\
d5cb30ebe480"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isLineIntersectsPolygon", "[", 
   RowBox[{"Polygon_kmPolygon", ",", "Line_kmLine"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"points", "=", 
      RowBox[{"Polygon", "[", "\"\<coordsOfPoints\>\"", "]"}]}], "}"}], ",", 
    RowBox[{"ContainsAny", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Line", "[", "\"\<equ\>\"", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[FormalX]", "->", 
              RowBox[{"points", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{"\[FormalY]", "->", 
              RowBox[{"points", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], ")"}], 
         ">", "0"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "points"}], "]"}]}], ",", 
      RowBox[{"{", "True", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907611060357467*^9, 3.9076111602273684`*^9}, {
  3.90761120212074*^9, 3.907611253680402*^9}, {3.9076113739819794`*^9, 
  3.907611377347596*^9}, {3.907611445405568*^9, 3.9076114576378536`*^9}, {
  3.907611593452876*^9, 3.907611629831289*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[137]:=",ExpressionUUID->"574a3723-9b4b-4b62-9fed-9e30898385ec"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"b573322e-0e4d-49c6-a23c-0d5d3ee4ce6b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"9", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "7"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9076115142974477`*^9, 3.907611519329483*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"77d5783f-9243-4593-9c8e-13e80d912dec"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[
      TagBox[
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[2], 
        PointBox[{{1., 5.}, {2., 3.}, {4., 1.}, {8., 4.}, {9., 6.}, {3., 
         7.}}]},
       Annotation[#, "Charting`Private`Tag#1"]& ],
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{
          Annotation[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            
            Point[{{1., 5.}, {2., 3.}, {4., 1.}, {8., 4.}, {9., 6.}, {3., 
             7.}}]}, "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0, 9.}, {0, 7.}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
           "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
           GoldenRatio^(-1), "DefaultStyle" -> {
             Directive[
              PointSize[0.012833333333333334`], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{0, 9.}, {0, 7.}}, 
          "Frame" -> {{False, False}, {False, False}}, "AxesOrigin" -> {0, 0},
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}]},
    Annotation[{{
       Annotation[{
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Point[{{1., 5.}, {2., 3.}, {4., 1.}, {8., 4.}, {9., 6.}, {3., 7.}}]},
         "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PlotRange" -> {{0, 9.}, {0, 7.}}, 
        "Frame" -> {{False, False}, {False, False}}, "AxesOrigin" -> {0, 0}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentPoint", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 9.}, {0, 7.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.9076115198956904`*^9, 3.9076152706030483`*^9, 
  3.907643158257335*^9, 3.9076543496702642`*^9, 3.9076600793038263`*^9, 
  3.9076720397627087`*^9, 3.9077712466384277`*^9, 3.907810858785307*^9, 
  3.907813018519291*^9, 3.907834923097175*^9, 3.9078384396049*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"fe484313-21c0-4a82-aa5e-6e20c0b7bbf8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"isLineIntersectsPolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], "]"}], ",", 
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"8", ",", "4"}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907611263729868*^9, 3.907611336985855*^9}, {
  3.9076115352100353`*^9, 3.9076115391766777`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"0c2a662a-1eaa-41ac-8ec2-c73dc86750c5"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9076113396849265`*^9, 3.9076113789637885`*^9, 
  3.907611460619993*^9, 3.9076115396752205`*^9, 3.9076116330801086`*^9, 
  3.907615270686923*^9, 3.9076431583238273`*^9, 3.907654349717127*^9, 
  3.9076600793975306`*^9, 3.9076720398251915`*^9, 3.9077712467321606`*^9, 
  3.907810858847974*^9, 3.9078130185817757`*^9, 3.9078349231908693`*^9, 
  3.9078384396673985`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"1bd7ab17-3609-43f1-9f10-9053f41fc993"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.7 . \:041d\:0430\:043f\:0438\
\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\:0446\:0438\:044e, \:0432\
\:044b\:0447\:0438\:0441\:043b\:044f\:044e\:0449\:0443\:044e \:0432\:0437\
\:0430\:0438\:043c\:043d\:043e\:0435 \:043f\:043e\:043b\:043e\:0436\:0435\
\:043d\:0438\:0435 \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430 \:0438 \
\:043f\:0440\:044f\:043c\:043e\:0439
\:043b\:0438\:043d\:0438\:0438.\
\>", "Subsection",
 CellChangeTimes->{{3.907608855072614*^9, 3.9076088711696987`*^9}, 
   3.907610994247611*^9},ExpressionUUID->"694e84d9-2c5a-47dc-8849-\
69592d9311cc"],

Cell["\<\
\:0412\:0430\:0440\:0438\:0430\:043d\:0442\:044b \:043e\:0442\:0432\:0435\
\:0442\:043e\:0432 : \[LeftGuillemet]\:043f\:0440\:044f\:043c\:0430\:044f \
\:043d\:0435 \:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\:0435\:0442 \
\:043f\:043e\:043b\:0438\:0433\:043e\:043d\[RightGuillemet]; \[LeftGuillemet]\
\:043f\:0440\:044f\:043c\:0430\:044f \:043f\:0435\:0440\:0435\:0441\:0435\
\:043a\:0430\:0435\:0442 \:0440\:0435\:0431\:0440\:0430 \:043f\:043e\:043b\
\:0438\:0433\:043e\:043d\:0430 \:0432 < \:043a\:043e\:043b - \:0432\:043e > \
\:0442\:043e\:0447\:043a\:0430\:0445, < \:0441\:043f\:0438\:0441\:043e\:043a \
\:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442
\:0442\:043e\:0447\:0435\:043a \:043f\:0435\:0440\:0435\:0441\:0435\:0447\
\:0435\:043d\:0438\:044f > \[RightGuillemet]; \[LeftGuillemet]\:043f\:0440\
\:044f\:043c\:0430\:044f \:043f\:0435\:0440\:0435\:0441\:0435\:043a\:0430\
\:0435\:0442 \:043f\:043e\:043b\:0438\:0433\:043e\:043d \:043f\:043e < \:043a\
\:043e\:043b - \:0432\:043e > \:0440\:0435\:0431\:0440\:0430\:043c, < \:0441\
\:043f\:0438\:0441\:043e\:043a \:0440\:0435\:0431\:0435\:0440, \:0442 . \
\:0435 . \:0441\:043f\:0438\:0441\:043e\:043a \:0441\:043f\:0438\:0441\:043a\
\:043e\:0432 \:043a\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442 \:0432\
\:0435\:0440\:0448\:0438\:043d \:0440\:0435\:0431\:0440\:0430 > \
\[RightGuillemet] .\
\>", "Text",
 CellChangeTimes->{{3.907608879266951*^9, 
  3.9076088997649403`*^9}},ExpressionUUID->"9e116249-3b31-48ac-8275-\
0e9844b3905b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getLinePositionRelativePolygon", "[", 
   RowBox[{"Polygon_kmPolygon", ",", "Line_kmLine"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"points", "=", 
       RowBox[{"Polygon", "[", "\"\<coordsOfPoints\>\"", "]"}]}], ",", 
      RowBox[{"dynamicTempValuesForCalculation", "=", 
       RowBox[{"{", "}"}]}], ",", "dynamicPosForZeros", ",", 
      "dynamicPosForOnes", ",", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"res1", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dynamicTempValuesForCalculation", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", "\"\<equ\>\"", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[FormalX]", "->", 
             RowBox[{"points", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"\[FormalY]", "->", 
             RowBox[{"points", "[", 
              RowBox[{"[", 
               RowBox[{"#", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], ")"}], 
        "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "points"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dynamicPosForZeros", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"dynamicTempValuesForCalculation", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dynamicPosForZeros", "!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dynamicPosForOnes", "=", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Differences", "[", "dynamicPosForZeros", "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dynamicPosForOnes", "!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"res", "=", 
           RowBox[{"First", "@", 
            RowBox[{"First", "@", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"res", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<Amount of coincided edges: \>\"", " ", "<>", " ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Length", "@", "dynamicPosForOnes"}], "]"}], " ", "<>",
                  " ", "\"\< with points \>\"", " ", "<>", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"points", "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"dynamicPosForZeros", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
                    RowBox[{"points", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"dynamicPosForZeros", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], "+", "1"}], "]"}], 
                    "]"}]}], "}"}], "&"}], "/@", "dynamicPosForOnes"}], 
                  "]"}]}], "}"}]}], "]"}]}]}]}], ",", 
          RowBox[{"res", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"res", ",", "\"\<There no edje coincidence\>\""}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dynamicPosForOnes", "==", 
           RowBox[{"{", "}"}]}], ",", "None", ",", 
          RowBox[{"dynamicPosForZeros", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"dynamicPosForZeros", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"First", "@", "#"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "@", "#"}], "+", "1"}], "}"}]}], "}"}], 
                  "&"}], "/@", "dynamicPosForOnes"}], "}"}], ",", "2"}], 
              "]"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{"dynamicPosForZeros", "==", 
             RowBox[{"{", 
              RowBox[{"{", "}"}], "}"}]}], ",", 
            RowBox[{"dynamicPosForZeros", "==", 
             RowBox[{"{", "}"}]}]}], "]"}], ",", "res", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"res1", "=", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"res1", ",", 
             RowBox[{
             "\"\<amount of intersected vertices: \>\"", " ", "<>", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "@", 
                RowBox[{"First", "@", "dynamicPosForZeros"}]}], "]"}], " ", "<>",
               " ", "\"\< with points \>\"", " ", "<>", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"ToString", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"points", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", "dynamicPosForZeros", ")"}]}], ")"}], "]"}]}]}],
             "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", "False"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "@", "res"}], "==", "\"\<{}\>\""}], ",", "res1", 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", "res1"}], "==", "\"\<{}\>\""}], ",", "res",
          ",", 
         RowBox[{"res", "<>", "\"\<, \>\"", "<>", "res1"}]}], "]"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907614067660948*^9, 3.907614244870056*^9}, {
   3.9076142778994894`*^9, 3.9076142870494256`*^9}, {3.9076143338432717`*^9, 
   3.907614337908905*^9}, {3.9076143871522865`*^9, 3.90761452978275*^9}, {
   3.907614573011221*^9, 3.9076145860265083`*^9}, {3.9076146182059717`*^9, 
   3.9076146689484673`*^9}, 3.9076147243579807`*^9, {3.9076147543883934`*^9, 
   3.907614849559498*^9}, {3.9076149708765244`*^9, 3.907615040900217*^9}, {
   3.90761507877952*^9, 3.9076150841279216`*^9}, {3.9076151269736347`*^9, 
   3.907615136804971*^9}, {3.907615195781212*^9, 3.907615223726392*^9}, {
   3.9076152858190465`*^9, 3.907615373157873*^9}, {3.9076154205347676`*^9, 
   3.907615516538412*^9}, {3.9076155482520766`*^9, 3.9076156271065693`*^9}, {
   3.907615664203455*^9, 3.907615765955737*^9}, 3.9076160425539045`*^9, {
   3.907616410572895*^9, 3.9076165766836405`*^9}, {3.9076166095964355`*^9, 
   3.9076166311605997`*^9}, {3.907616678355833*^9, 3.9076166810378532`*^9}, {
   3.907616719849922*^9, 3.907616721983072*^9}, {3.907616758693756*^9, 
   3.9076167596439977`*^9}, {3.9076167957233667`*^9, 
   3.9076168204196095`*^9}, {3.907616856265191*^9, 3.9076169678182144`*^9}, {
   3.9076172314167433`*^9, 3.9076175633240414`*^9}, {3.907617614250659*^9, 
   3.907617640963771*^9}, {3.907617878432542*^9, 3.907617902080114*^9}, {
   3.9076179412080464`*^9, 3.9076179765704913`*^9}, {3.907618010316703*^9, 
   3.907618035928732*^9}, {3.907618090272374*^9, 3.907618103819414*^9}, {
   3.9076181512641*^9, 3.9076182179380007`*^9}, {3.907618786526022*^9, 
   3.907618880866657*^9}, {3.90761897120275*^9, 3.9076189798137712`*^9}, {
   3.9076190668559494`*^9, 3.907619108027006*^9}, {3.9076191871772747`*^9, 
   3.9076191928925657`*^9}, {3.9076192394183383`*^9, 
   3.9076192564849424`*^9}, {3.907619615349408*^9, 3.907619618262596*^9}, {
   3.9076196866200747`*^9, 3.9076197086566925`*^9}, {3.907619766212174*^9, 
   3.907619767980583*^9}, {3.9076198856404915`*^9, 3.9076199617180643`*^9}, {
   3.907620017184331*^9, 3.9076200433276925`*^9}, {3.90762007730446*^9, 
   3.907620132018123*^9}, {3.907620273365297*^9, 3.907620278761177*^9}, {
   3.9076203299657097`*^9, 3.907620340037098*^9}, {3.9076203732469068`*^9, 
   3.907620409104121*^9}, 3.907620475310856*^9, 3.9076205633971186`*^9, {
   3.907620626879797*^9, 3.907620679494263*^9}, {3.907620721117161*^9, 
   3.907620843884241*^9}, {3.9076209000342803`*^9, 3.907620909448208*^9}, {
   3.907620997800319*^9, 3.9076210049954786`*^9}, {3.9076210676381416`*^9, 
   3.907621081944004*^9}, {3.907621123357502*^9, 3.9076211265034246`*^9}, {
   3.907621181271325*^9, 3.9076211856013565`*^9}, {3.907621250324555*^9, 
   3.9076214071652155`*^9}, {3.9076215730707207`*^9, 3.907621723202304*^9}, {
   3.907621840154484*^9, 3.9076218833643064`*^9}, {3.9076219460392733`*^9, 
   3.907622049044275*^9}, {3.907622138099636*^9, 3.90762215509678*^9}, {
   3.907622194791644*^9, 3.9076221972911787`*^9}, {3.907643052855453*^9, 
   3.9076431016824727`*^9}, {3.9076431429760637`*^9, 3.907643144709609*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[140]:=",ExpressionUUID->"de270163-874c-4de3-bc2b-f9c6dda88f6b"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"c67b887b-f727-4a46-8c7b-7736708b5359"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Polygon8", "=", 
  RowBox[{"kmPolygon", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907618248295566*^9, 3.907618263164791*^9}, {
   3.9076183536405973`*^9, 3.907618441658766*^9}, 3.90761983189787*^9, 
   3.9076201702881355`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"020dff4e-3549-4316-99e4-baa29a7d8df0"],

Cell[BoxData[
 TemplateBox[{"\"Polygon\"", "\": (\"", 
   TemplateBox[{",", "\",\"", 
     RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"5", ",", "1"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"1", ",", "8"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], 
     RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}, "RowWithSeparators"], "\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.907618435329113*^9, 3.9076184420889707`*^9}, 
   3.9076201710069904`*^9, 3.907643158392208*^9, 3.9076543497952356`*^9, 
   3.9076600794912577`*^9, 3.907672039934507*^9, 3.907771246825878*^9, 
   3.9078108589102764`*^9, 3.9078130186755085`*^9, 3.9078349232689834`*^9, 
   3.907838439761092*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"9f1d32c9-d279-4697-a53d-f8fb44a02356"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.9076185038026533`*^9, {3.9076197908952923`*^9, 3.907619815866007*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"4dc901ab-a35c-4814-a905-47b8f0668046"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[
      TagBox[
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[2], 
        PointBox[{{1., 2.}, {1., 1.}, {5., 1.}, {5., 10.}, {1., 8.}, {3., 
         6.}, {1., 5.}, {1., 4.}, {3., 3.}}]},
       Annotation[#, "Charting`Private`Tag#1"]& ],
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
     DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
       Slot["HighlightElements"], 
       Slot["LayoutOptions"], 
       Slot["Meta"], 
       Charting`HighlightActionFunction["DynamicHighlight", {{
          Annotation[{
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]], 
            
            Point[{{1., 2.}, {1., 1.}, {5., 1.}, {5., 10.}, {1., 8.}, {3., 
             6.}, {1., 5.}, {1., 4.}, {3., 3.}}]}, 
           "Charting`Private`Tag#1"]}}, <|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
         "LayoutOptions" -> <|
          "PlotRange" -> {{0.916666666666669, 5.}, {0, 10.}}, 
           "Frame" -> {{False, False}, {False, False}}, 
           "AxesOrigin" -> {0.916666666666669, 0}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              PointSize[0.012833333333333334`], 
              RGBColor[0.368417, 0.506779, 0.709798], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               Identity[
                Part[#, 1]], 
               Identity[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PlotRange" -> {{0.916666666666669, 5.}, {0, 10.}}, 
          "Frame" -> {{False, False}, {False, False}}, 
          "AxesOrigin" -> {0.916666666666669, 0}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             PointSize[0.012833333333333334`], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[2]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              Identity[
               Part[#, 1]], 
              Identity[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>],
      ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
       4.503599627370496*^15, -4.503599627370496*^15}}]},
    Annotation[{{
       Annotation[{
         Directive[
          PointSize[0.012833333333333334`], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[2]], 
         Point[{{1., 2.}, {1., 1.}, {5., 1.}, {5., 10.}, {1., 8.}, {3., 6.}, {
          1., 5.}, {1., 4.}, {3., 3.}}]}, "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
      "LayoutOptions" -> <|
       "PlotRange" -> {{0.916666666666669, 5.}, {0, 10.}}, 
        "Frame" -> {{False, False}, {False, False}}, 
        "AxesOrigin" -> {0.916666666666669, 0}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListPlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.916666666666669, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05], 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentPoint", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.916666666666669, 5.}, {0, 10.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.907618504817049*^9, 3.9076198165283403`*^9, 
  3.907620172093893*^9, 3.9076431585070753`*^9, 3.907654349920207*^9, 
  3.9076600796318507`*^9, 3.9076720400595107`*^9, 3.9077712469508533`*^9, 
  3.907810859004001*^9, 3.907813018784855*^9, 3.9078349233944774`*^9, 
  3.907838439870466*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"aa59af80-3d9a-43a4-a93b-fc4b45a8fa6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getLinePositionRelativePolygon", "[", 
  RowBox[{"Polygon8", ",", 
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "8"}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907614250437455*^9, 3.90761426850186*^9}, {
  3.907614834227885*^9, 3.9076148358948517`*^9}, {3.907617025510434*^9, 
  3.9076170274264483`*^9}, {3.9076181175343833`*^9, 3.907618119035166*^9}, {
  3.907618524816188*^9, 3.9076185408765826`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"1437f241-7f2b-44bf-88a4-c84b44d6c000"],

Cell[BoxData["\<\"Amount of coincided edges: 2 with points {{{1, 2}, {1, 1}}, \
{{1, 5}, {1, 4}}}, amount of intersected vertices: 1 with points {{{1, 8}}}\"\
\>"], "Output",
 CellChangeTimes->{{3.9076182067780848`*^9, 3.907618219254282*^9}, 
   3.9076185414770417`*^9, 3.907618813538965*^9, 3.907618849594207*^9, 
   3.907618884445725*^9, 3.907618984510811*^9, 3.907619080396209*^9, 
   3.907619112828278*^9, 3.9076191965908184`*^9, 3.907619259993208*^9, 
   3.907619624196639*^9, {3.907619697356411*^9, 3.9076197181116896`*^9}, 
   3.9076197734257293`*^9, {3.907620176502243*^9, 3.907620186348855*^9}, 
   3.907620304155341*^9, 3.907620343574975*^9, {3.9076203865309963`*^9, 
   3.9076204124386287`*^9}, 3.9076205693068323`*^9, 3.9076206852629924`*^9, 
   3.9076207367376404`*^9, 3.9076207830828323`*^9, {3.9076208136647563`*^9, 
   3.907620847219202*^9}, 3.907620913207936*^9, 3.9076210102279515`*^9, {
   3.9076210715788827`*^9, 3.907621086111169*^9}, 3.9076211922808046`*^9, 
   3.9076212645791407`*^9, {3.907621301420641*^9, 3.9076213844892306`*^9}, {
   3.9076215845199413`*^9, 3.9076216187985067`*^9}, 3.907621648977954*^9, {
   3.9076216802074327`*^9, 3.9076217283681355`*^9}, 3.9076218895466366`*^9, 
   3.9076221585286636`*^9, 3.9076221997738495`*^9, {3.907643158557201*^9, 
   3.907643188286503*^9}, 3.9076543500451765`*^9, 3.9076600796787148`*^9, 
   3.9076720401219625`*^9, 3.9077712470289946`*^9, 3.907810859082388*^9, 
   3.9078130188629637`*^9, 3.907834923472091*^9, 3.907838439932949*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"ff89ca71-980c-4364-94d0-9902d152e5e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getLinePositionRelativePolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], "]"}], ",", 
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"8", ",", "4"}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907621767813656*^9, 3.9076217878768816`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"37458897-bea5-4ebf-935e-c4d41d8ca8c7"],

Cell[BoxData["\<\"There no edje coincidence, amount of intersected vertices: \
1 with points {{{1, 5}}, {{8, 4}}}\"\>"], "Output",
 CellChangeTimes->{3.907621788260066*^9, 3.9076218552681494`*^9, 
  3.9076218871804943`*^9, 3.9076221622613745`*^9, 3.9076222025399*^9, 
  3.9076431586074057`*^9, 3.907643189820619*^9, 3.907654350107663*^9, 
  3.9076600797411995`*^9, 3.9076720401844482`*^9, 3.9077712471071005`*^9, 
  3.9078108591289716`*^9, 3.907813018909824*^9, 3.9078349235345383`*^9, 
  3.9078384399798126`*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"2be99ffc-ff2c-4874-ac6d-9a73c492a076"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getLinePositionRelativePolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], "]"}], ",", 
      RowBox[{"kmPoint", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907621905845949*^9, 3.9076219071787243`*^9}, 
   3.9076220877226553`*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"55265bc3-cc15-4f22-9565-b8dc62228ea3"],

Cell[BoxData["\<\"Amount of coincided edges: 1 with points {{{1, 5}, {2, 3}}}\
\"\>"], "Output",
 CellChangeTimes->{
  3.907621907627719*^9, 3.907621969220089*^9, 3.907622000715539*^9, {
   3.9076221637441025`*^9, 3.907622173277131*^9}, 3.9076222046229944`*^9, 
   3.9076431586587114`*^9, 3.9076431908531446`*^9, 3.907654350170148*^9, 
   3.907660079803684*^9, 3.907672040246934*^9, 3.90777124716955*^9, 
   3.907810859175845*^9, 3.907813018956726*^9, 3.9078349235970592`*^9, 
   3.907838440042267*^9},
 CellLabel->
  "Out[145]=",ExpressionUUID->"23620696-5b48-4bef-ae02-69a9ba5ca9ae"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2.", "Section",
 CellChangeTimes->{{3.9072224108210764`*^9, 3.9072224249049854`*^9}, {
  3.907625427757161*^9, 
  3.9076254278908443`*^9}},ExpressionUUID->"bbf9d3cd-8079-42ff-9348-\
fae53a2f53e8"],

Cell[CellGroupData[{

Cell["\<\
2.1 . \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\
\:043a\:0446\:0438\:044e, \:043e\:043f\:0440\:0435\:0434\:0435\:043b\:044f\
\:044e\:0449\:0443\:044e \:0433\:0430\:0440\:0430\:043d\:0442\:0438\:0440\
\:043e\:0432\:0430\:043d\:043d\:0443\:044e \:043d\:0435\:043f\:0440\:0438\
\:043d\:0430\:0434\:043b\:0435\:0436\:043d\:043e\:0441\:0442\:044c
\:0437\:0430\:0434\:0430\:043d\:043d\:043e\:0439 \:0442\:043e\:0447\:043a\
\:0438 \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0443 .\
\>", "Subsection",
 CellChangeTimes->{{3.907625489616603*^9, 
  3.90762551482953*^9}},ExpressionUUID->"aec22270-6989-4321-87de-\
1d7f66206973"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isPointDefenitlyNotInPolygon", "[", 
   RowBox[{"Polygon_kmPolygon", ",", "Point_kmPoint"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"Point", "[", "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"Point", "[", "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Or", "[", 
       RowBox[{
        RowBox[{"x", "<", 
         RowBox[{"Polygon", "[", "\"\<minX\>\"", "]"}]}], ",", 
        RowBox[{"x", ">", 
         RowBox[{"Polygon", "[", "\"\<maxX\>\"", "]"}]}], ",", 
        RowBox[{"y", "<", 
         RowBox[{"Polygon", "[", "\"\<minY\>\"", "]"}]}], ",", 
        RowBox[{"y", ">", 
         RowBox[{"Polygon", "[", "\"\<maxY\>\"", "]"}]}]}], "]"}], ",", 
      "True", ",", "False"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907625968137927*^9, 3.9076260482615967`*^9}, {
  3.9076263454397483`*^9, 3.907626562710258*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[146]:=",ExpressionUUID->"d8140749-aa6e-4f01-9749-727adb62759d"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"bd024e44-36c3-4ead-8fbc-33e9b99a91db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"isPointDefenitlyNotInPolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "5"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.907626580325462*^9, 3.9076265958237658`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"2e2df8af-3150-41c1-befb-b137180f1b23"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.9076265963722754`*^9, 3.907626651015164*^9, 
  3.907626695343436*^9, 3.907643158724574*^9, 3.9076543502326345`*^9, 
  3.907660079881791*^9, 3.9076720403250403`*^9, 3.907771247247655*^9, 
  3.9078108592383204`*^9, 3.907813019019179*^9, 3.9078349236751685`*^9, 
  3.9078384401047835`*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"913d53fe-7fe0-4359-8429-dd6ee28430e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"isPointDefenitlyNotInPolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"15", ",", "15"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9076266663314786`*^9, 3.9076266729965863`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"ad1c3eb7-1bb9-4c1e-b002-754893c64237"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9076266684966016`*^9, 3.9076266963593006`*^9}, 
   3.907643158756915*^9, 3.907654350295116*^9, 3.907660079944276*^9, 
   3.9076720403875256`*^9, 3.9077712473258305`*^9, 3.907810859285185*^9, 
   3.9078130190816593`*^9, 3.9078349237376823`*^9, 3.9078384401672792`*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"41e6ee27-0990-4d53-b4f2-97c61dcfe19c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2.2. \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \
\:0442\:0435\:0441\:0442 - \:0444\:0443\:043d\:043a\:0446\:0438\:044e \:043e\
\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f \:043f\:043e\
\:043b\:043e\:0436\:0435\:043d\:0438\:044f \:0442\:043e\:0447\:043a\:0438 \
\:043e\:0442\:043d\:043e\:0441\:0438\:0442\:0435\:043b\:044c\:043d\:043e
\:0432\:044b\:043f\:0443\:043a\:043b\:043e\:0433\:043e \:043f\:043e\:043b\
\:0438\:0433\:043e\:043d\:0430.\
\>", "Subsection",
 CellChangeTimes->{{3.907626723606612*^9, 3.9076267303886786`*^9}, {
  3.9076304999376335`*^9, 
  3.9076305232160807`*^9}},ExpressionUUID->"4edc95a2-fbc0-4967-8c36-\
613c832136c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"locatePointRelativePolygon", "[", 
   RowBox[{"Polygon_kmPolygon", ",", "Point_kmPoint"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"points", "=", 
       RowBox[{"Polygon", "[", "\"\<points\>\"", "]"}]}], ",", "res"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getTriangleAlgebraicSquare", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", "Point", ",", 
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Length", "[", "points", "]"}], "-", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"res", ",", 
        RowBox[{"getTriangleAlgebraicSquare", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", 
             RowBox[{"Length", "[", "points", "]"}], "]"}], "]"}], ",", 
           "Point", ",", 
           RowBox[{"points", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "[", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}], "/@", "res"}], ")"}]}], ",", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "<", "0"}], "&"}], "/@", "res"}], ")"}]}]}], "]"}], 
       ",", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ContainsAny", "[", 
          RowBox[{"res", ",", 
           RowBox[{"{", "0", "}"}]}], "]"}], ",", "0", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9076268585904493`*^9, 3.907626893585187*^9}, {
   3.9076269396129384`*^9, 3.9076269456123333`*^9}, 3.907627029734956*^9, {
   3.9076271242224283`*^9, 3.90762718383174*^9}, {3.907627238590561*^9, 
   3.907627259104521*^9}, {3.9076273098982964`*^9, 3.907627342377186*^9}, 
   3.9076273819047747`*^9, {3.9076274225162473`*^9, 3.907627437281434*^9}, {
   3.9076274687273307`*^9, 3.907627525986887*^9}, {3.9076276109097805`*^9, 
   3.9076276678184795`*^9}, {3.9076277002809296`*^9, 3.907627741475726*^9}, 
   3.9076290185430136`*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[149]:=",ExpressionUUID->"49f669e3-22bc-4e5e-aa1b-024aa7f3da86"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"8259d7d4-f1db-452d-9e81-c075b2a52e90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"locatePointRelativePolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"5", ",", "5"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9076271903134627`*^9, 3.907627219891487*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"a4fa19f8-1056-4742-954b-161304332074"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.9076272210416794`*^9, 3.9076272707189245`*^9}, {
   3.9076273341272397`*^9, 3.9076273607570205`*^9}, {3.907627448596448*^9, 
   3.907627481542157*^9}, 3.9076276694845057`*^9, 3.9076277450063305`*^9, 
   3.9076431588237033`*^9, 3.9076543504044676`*^9, 3.907660080178596*^9, 
   3.90767204059064*^9, 3.907771247435117*^9, 3.907810859410689*^9, 
   3.907813019144148*^9, 3.907834923800101*^9, 3.907838440229725*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"f38974b5-96c1-4b7f-a1c1-7e87e2a6fc31"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"locatePointRelativePolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9076276859160657`*^9, 3.9076276873835163`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"516dbd1c-286e-482c-898c-b2a2f76820ff"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{3.9076276877311316`*^9, 3.907627746124954*^9, 
  3.907643158875368*^9, 3.9076543504825735`*^9, 3.9076600802567053`*^9, 
  3.907672040653087*^9, 3.9077712475288396`*^9, 3.907810859457017*^9, 
  3.9078130191910086`*^9, 3.9078349238782444`*^9, 3.90783844027662*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"5f0c1064-649b-4a4c-94e4-63c7a0fcd493"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"locatePointRelativePolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"8", ",", "4"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.907627762773348*^9, 3.9076277643729153`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"355b1552-be56-4abd-929d-3bbb16e9cf38"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.907627764655304*^9, 3.9076431589067974`*^9, 
  3.907654350529436*^9, 3.9076600803191886`*^9, 3.9076720407311945`*^9, 
  3.9077712475913267`*^9, 3.907810859519506*^9, 3.9078130192378807`*^9, 
  3.9078349239406934`*^9, 3.9078384403546906`*^9},
 CellLabel->
  "Out[152]=",ExpressionUUID->"f3aa8dce-2378-416e-b7c9-b75c4d7e2cd3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2.3. \
\:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\
\:0446\:0438\:044e, \:0440\:0435\:0430\:043b\:0438\:0437\:0443\:044e\:0449\
\:0443\:044e \:0443\:0433\:043b\:043e\:0432\:043e\:0439 \:0442\:0435\:0441\
\:0442, \:043e\:043f\:0440\:0435\:0434\:0435\:043b\:044f\:044e\:0449\:0438\
\:0439 \:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435
\:0442\:043e\:0447\:043a\:0438 \:043e\:0442\:043d\:043e\:0441\:0438\:0442\
\:0435\:043b\:044c\:043d\:043e \:043f\:0440\:043e\:0438\:0437\:0432\:043e\
\:043b\:044c\:043d\:043e\:0433\:043e \:043f\:0440\:043e\:0441\:0442\:043e\
\:0433\:043e \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430.\
\>", "Subsection",
 CellChangeTimes->{{3.9076279225533843`*^9, 3.9076279304838676`*^9}, {
  3.907630493886248*^9, 
  3.907630519867319*^9}},ExpressionUUID->"77db6646-b089-4131-8210-\
b2682aee8855"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getAngleTest", "[", 
   RowBox[{"Polygon_kmPolygon", ",", "Point_kmPoint"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"points", "=", 
       RowBox[{"Polygon", "[", "\"\<points\>\"", "]"}]}], ",", "res1", ",", 
      "res2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"kmVector", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"points", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], "-", 
          RowBox[{"Point", "[", "\"\<coord\>\"", "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "points", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ContainsAny", "[", 
        RowBox[{"res1", ",", 
         RowBox[{"{", 
          RowBox[{"kmVector", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "]"}], "}"}]}], "]"}], ",", "0", 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"ArcCos", "[", 
             FractionBox[
              RowBox[{"Plus", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"res1", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<coord\>\"", 
                  "]"}], "*", 
                 RowBox[{
                  RowBox[{"res1", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", "+", "1"}], "]"}], "]"}], "[", 
                  "\"\<coord\>\"", "]"}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"res1", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "[", "\"\<norm\>\"", "]"}], 
               "*", 
               RowBox[{
                RowBox[{"res1", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "+", "1"}], "]"}], "]"}], "[", "\"\<norm\>\"", 
                "]"}]}]], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Length", "@", "points"}], "-", "1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res2", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"res2", ",", 
           RowBox[{"N", "[", 
            RowBox[{"ArcCos", "[", 
             FractionBox[
              RowBox[{"Plus", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"res1", "[", 
                   RowBox[{"[", 
                    RowBox[{"Length", "@", "points"}], "]"}], "]"}], "[", 
                  "\"\<coord\>\"", "]"}], "*", 
                 RowBox[{
                  RowBox[{"res1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<coord\>\"", 
                  "]"}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                RowBox[{"res1", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "@", "points"}], "]"}], "]"}], "[", 
                "\"\<norm\>\"", "]"}], "*", 
               RowBox[{
                RowBox[{"res1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<norm\>\"", 
                "]"}]}]], "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Plus", "@@", "res2"}], "-", 
             RowBox[{"2", "*", "Pi"}]}], "]"}], "<", "1"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9076281558548927`*^9, 3.907628309151887*^9}, {
  3.907628475396615*^9, 3.9076285749847*^9}, {3.907628775708324*^9, 
  3.9076287920062904`*^9}, {3.9076289080426054`*^9, 3.907629000278626*^9}, {
  3.9076290318240857`*^9, 3.907629044157477*^9}, {3.9076291066512146`*^9, 
  3.9076291223143325`*^9}, {3.907629168006925*^9, 3.9076293772316484`*^9}, {
  3.9076294115438576`*^9, 3.9076296531292996`*^9}, {3.9077750474170065`*^9, 
  3.9077750543946877`*^9}, {3.907775112323986*^9, 3.9077751363901987`*^9}, {
  3.907775280089898*^9, 3.9077752809490695`*^9}, {3.907775350278372*^9, 
  3.907775355957844*^9}, {3.907775422572241*^9, 3.907775430570361*^9}, {
  3.907775800990715*^9, 3.9077758011781387`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[153]:=",ExpressionUUID->"346ea6c1-f524-44d8-a171-13f50aa8b021"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"7c390dde-54b2-465b-9eb5-a032ecfcb538"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getAngleTest", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"5", ",", "5"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.9076282313457003`*^9, {3.9076282968376083`*^9, 3.9076282979707036`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"e267320d-6e8c-4d2a-ac76-6359b791dc1f"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.9076291847709837`*^9, 3.907629198153818*^9}, {
   3.90762930027356*^9, 3.9076293457183256`*^9}, {3.9076294185916758`*^9, 
   3.9076294289576683`*^9}, 3.907629493215336*^9, {3.907629573054768*^9, 
   3.907629593869589*^9}, {3.907629647429316*^9, 3.907629654827676*^9}, 
   3.9076431589740067`*^9, 3.90765435109227*^9, 3.907660080475411*^9, 
   3.9076720409030447`*^9, 3.907771247810023*^9, 3.9078108597538238`*^9, 
   3.907813019315983*^9, 3.9078349240031805`*^9, 3.907838440417178*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"0712726c-f18a-4d31-b2c0-79679304e080"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getAngleTest", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9076294376573668`*^9, 3.9076294390238223`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"ece482a7-fd20-4dd2-8880-3513b96b6a11"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{
  3.9076294394053698`*^9, 3.907629494082054*^9, {3.9076295743553295`*^9, 
   3.907629594468292*^9}, {3.9076296487956448`*^9, 3.907629655594056*^9}, 
   3.9076431590240593`*^9, 3.9076543511699457`*^9, 3.9076600805535083`*^9, 
   3.9076720409655175`*^9, 3.9077712478881407`*^9, 3.9078108598006945`*^9, 
   3.9078130193628445`*^9, 3.9078349240656643`*^9, 3.9078384404640737`*^9},
 CellLabel->
  "Out[155]=",ExpressionUUID->"17b67c8b-b391-4ce5-ab1b-78754bcba8b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getAngleTest", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"8", ",", "4"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9076295023819017`*^9, 3.907629504114529*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"e35446ef-1c1f-44f0-adde-b0da95f4b977"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.9076295046641455`*^9, {3.9076295751886034`*^9, 3.907629595169869*^9}, {
   3.907629627564831*^9, 3.9076296561936045`*^9}, 3.90764315907404*^9, 
   3.9076543512167788`*^9, 3.9076600806159935`*^9, 3.9076720410436563`*^9, 
   3.9077712479506154`*^9, 3.9078108598788185`*^9, 3.9078130194097424`*^9, 
   3.9078349241281486`*^9, 3.907838440510907*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"846cf5bf-1160-4dde-b068-ac960310d97c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2.4. \
\:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\
\:0446\:0438\:044e, \:0440\:0435\:0430\:043b\:0438\:0437\:0443\:044e\:0449\
\:0443\:044e \:043b\:0443\:0447\:0435\:0432\:043e\:0439 \:0442\:0435\:0441\
\:0442, \:043e\:043f\:0440\:0435\:0434\:0435\:043b\:044f\:044e\:0449\:0438\
\:0439 \:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435
\:0442\:043e\:0447\:043a\:0438 \:043e\:0442\:043d\:043e\:0441\:0438\:0442\
\:0435\:043b\:044c\:043d\:043e \:043f\:0440\:043e\:0438\:0437\:0432\:043e\
\:043b\:044c\:043d\:043e\:0433\:043e \:043f\:0440\:043e\:0441\:0442\:043e\
\:0433\:043e \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430.\
\>", "Subsection",
 CellChangeTimes->{{3.907629673741917*^9, 3.9076297079381733`*^9}, {
  3.907630484071887*^9, 
  3.907630516667534*^9}},ExpressionUUID->"a0678d51-5200-43fb-9215-\
45cd586eaa0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getRayTest", "[", 
    RowBox[{"Polygon_kmPolygon", ",", "Point_kmPoint"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"segments", "=", 
        RowBox[{"Polygon", "[", "\"\<lineSegments\>\"", "]"}]}], ",", "res", 
       ",", 
       RowBox[{"vector", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RandomReal", "[", "]"}], "*", "100"}], "-", "5"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"RandomReal", "[", "]"}], "*", "100"}], "-", "5"}]}], 
         "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"getSegmentsLocationRelativeToEachOtherForRayTest", "[", 
          RowBox[{"#", ",", 
           RowBox[{"kmSegment", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Point", "[", "\"\<coord\>\"", "]"}], ",", 
              RowBox[{
               RowBox[{"Point", "[", "\"\<coord\>\"", "]"}], "+", 
               "vector"}]}], "}"}], "]"}]}], "]"}], "&"}], "/@", 
        "segments"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"res", ",", "3"}], "]"}], ",", "2"}], "]"}], "!=", 
       "0"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9078153759295616`*^9, 3.9078153986041546`*^9}, {
   3.9078154838583126`*^9, 3.907815497840742*^9}, {3.9078155312011867`*^9, 
   3.907815537200343*^9}, {3.907816136404964*^9, 3.9078161452466707`*^9}, {
   3.9078161929849463`*^9, 3.9078162613219767`*^9}, {3.9078165041613197`*^9, 
   3.9078165064264603`*^9}, 3.9078166812104216`*^9, {3.9078261336403613`*^9, 
   3.9078261342186227`*^9}, {3.907827686055459*^9, 3.907827817834325*^9}, {
   3.9078278695686674`*^9, 3.9078278880174575`*^9}, {3.9078281169635305`*^9, 
   3.9078281195876865`*^9}, {3.9078308934659805`*^9, 3.907830896434153*^9}, {
   3.9078310276226254`*^9, 3.907831027934516*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[157]:=",ExpressionUUID->"a225d382-adcd-487a-84e2-ac79c23b1787"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getRayTest", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.907827924924879*^9, 3.9078279261125126`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"7c69011b-3089-4b31-adc5-3420cdb09563"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.9078162759115105`*^9, 3.9078165088316827`*^9, 3.907816683803096*^9, {
   3.9078277579124403`*^9, 3.907827828050215*^9}, {3.907827873004892*^9, 
   3.90782793192319*^9}, 3.907831029606033*^9, 3.907834924206291*^9, 
   3.9078384405890102`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"fa76eb04-8798-4b39-830d-9ec34b4ae722"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getSegmentsLocationRelativeToEachOtherForRayTest", "[", 
   RowBox[{"Segment1_kmSegment", ",", "Segment2_kmSegment"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"areSegmentsCoincide", "[", 
     RowBox[{"Segment1", ",", "Segment2"}], "]"}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"areSegmentsParallel", "[", 
       RowBox[{"Segment1", ",", "Segment2"}], "]"}], ",", "0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"isPointOnSegment", "[", 
          RowBox[{"Segment1", ",", 
           RowBox[{"getLinesIntersectionPoint", "[", 
            RowBox[{
             RowBox[{"kmLine", "[", "Segment1", "]"}], ",", 
             RowBox[{"kmLine", "[", "Segment2", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{"isPointOnSegment", "[", 
          RowBox[{"Segment2", ",", 
           RowBox[{"getLinesIntersectionPoint", "[", 
            RowBox[{
             RowBox[{"kmLine", "[", "Segment1", "]"}], ",", 
             RowBox[{"kmLine", "[", "Segment2", "]"}]}], "]"}]}], "]"}]}], 
        ",", "3", ",", "2"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9078308833281994`*^9, 3.90783088721763*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[159]:=",ExpressionUUID->"16605c01-e372-45be-8627-2e7d7f27a423"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 3.", "Section",
 CellChangeTimes->{{3.9072224108210764`*^9, 3.9072224249049854`*^9}, {
  3.907625427757161*^9, 3.9076254278908443`*^9}, {3.9076304421433764`*^9, 
  3.9076304422101035`*^9}},ExpressionUUID->"8a7afad1-4af4-4751-af5d-\
da3a5c1d6999"],

Cell[CellGroupData[{

Cell["\<\
\:0417\:0430\:0434\:0430\:043d\:0438\:0435 3.2. \
\:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \:0444\:0443\:043d\:043a\
\:0446\:0438\:044e, \:043a\:043e\:0442\:043e\:0440\:0430\:044f \:0440\:0435\
\:0430\:043b\:0438\:0437\:0443\:0435\:0442 \:0438\:043b\:0438 \:0432\:043d\
\:0443\:0442\:0440\:0435\:043d\:043d\:0435\:0435, \:0438\:043b\:0438 \:0432\
\:043d\:0435\:0448\:043d\:0435\:0435
\:043e\:0442\:0441\:0435\:0447\:0435\:043d\:0438\:0435 \:043e\:0442\:0440\
\:0435\:0437\:043a\:0430 \:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\
\:044c\:043d\:044b\:043c \:043f\:0440\:043e\:0441\:0442\:044b\:043c \:043f\
\:043e\:043b\:0438\:0433\:043e\:043d\:043e\:043c, \:0432 \:0437\:0430\:0432\
\:0438\:0441\:0438\:043c\:043e\:0441\:0442\:0438 \:043e\:0442
\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:044f \:0432\:0445\:043e\:0434\
\:043d\:043e\:0433\:043e \:0430\:0440\:0433\:0443\:043c\:0435\:043d\:0442\
\:0430. \:0418\:0441\:043f\:043e\:043b\:044c\:0437\:0443\:0439\:0442\:0435 \
\:043c\:0435\:0442\:043e\:0434 \:043f\:043e\:0441\:0442\:0440\:043e\:0435\
\:043d\:0438\:044f \:0432\:0438\:0434\:0438\:043c\:044b\:0445 \:0444\:0440\
\:0430\:0433\:043c\:0435\:043d\:0442\:043e\:0432 \:043e\:0442\:0440\:0435\
\:0437\:043a\:0430 \:043d\:0430 \:043e\:0441\:043d\:043e\:0432\:0435 \:0442\
\:0435\:0441\:0442\:0430
\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:044f \:0442\:043e\:0447\
\:043a\:0438 \:043e\:0442\:043d\:043e\:0441\:0438\:0442\:0435\:043b\:044c\
\:043d\:043e \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430.\
\>", "Subsection",
 CellChangeTimes->{{3.9076304237968407`*^9, 3.9076304826205044`*^9}, 
   3.9076305141854367`*^9},ExpressionUUID->"88ef5f01-ddef-45c4-8d85-\
6deaf318624a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getIntersectionOfLineSegmentByPolygon", "[", 
   RowBox[{"Polygon_kmPolygon", ",", "Segment_kmSegment"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"segments", "=", 
       RowBox[{"Polygon", "[", "\"\<lineSegments\>\"", "]"}]}], ",", "res", 
      ",", 
      RowBox[{"newSegments", "=", 
       RowBox[{"{", "}"}]}], ",", "mids", ",", "boolRes"}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getSegmentsLocationRelativeToEachOther", "[", 
         RowBox[{
          RowBox[{"segments", "[", 
           RowBox[{"[", "#", "]"}], "]"}], ",", "Segment"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "segments"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"res", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "->", "Nothing"}], ",", 
          RowBox[{"0", "->", "Nothing"}], ",", 
          RowBox[{"1", "->", "Nothing"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Sort", "[", "res", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "res"}], "==", "0"}], ",", 
       RowBox[{"Return", "@", "Nothing"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newSegments", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "res", "]"}], "!=", "1"}], ",", 
       RowBox[{"newSegments", "=", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"newSegments", ",", 
          RowBox[{"First", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"res", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{"res", "[", 
                RowBox[{"[", 
                 RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Length", "@", "res"}], "-", "1"}], "]"}]}], "]"}]}], 
         "]"}]}], ",", "None"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newSegments", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"newSegments", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"res", "[", 
           RowBox[{"[", 
            RowBox[{"Length", "@", "res"}], "]"}], "]"}], ",", "1"}], "}"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newSegments", "=", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"newSegments", ",", 
        RowBox[{
         RowBox[{"{", "}"}], "->", "Nothing"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mids", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"]}], "}"}], "&"}], "/@",
        "newSegments"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mids", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getPointFromParameter", "[", 
         RowBox[{"Segment", ",", 
          RowBox[{"First", "@", "#"}]}], "]"}], "&"}], "/@", "mids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"boolRes", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"getRayTest", "[", 
         RowBox[{"Polygon5", ",", "#"}], "]"}], "&"}], "/@", "mids"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newSegments", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"newSegments", ",", 
        RowBox[{"Position", "[", 
         RowBox[{"boolRes", ",", "True"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"getPointFromParameter", "[", 
          RowBox[{"Segment", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"getPointFromParameter", "[", 
          RowBox[{"Segment", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
      "newSegments"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9076558674024763`*^9, 3.907655903441992*^9}, {
   3.9076560379874725`*^9, 3.9076560404552045`*^9}, {3.907656855751304*^9, 
   3.9076568816240435`*^9}, {3.9076569190723124`*^9, 3.907657007324525*^9}, {
   3.907657116164909*^9, 3.907657137212739*^9}, {3.9076571813389535`*^9, 
   3.9076572899852858`*^9}, {3.9076573950212307`*^9, 
   3.9076573995045557`*^9}, {3.9076601287221117`*^9, 
   3.9076601288315544`*^9}, {3.9076603537637925`*^9, 3.907660412534522*^9}, 
   3.9076605044966173`*^9, {3.907660593003667*^9, 3.907660624947459*^9}, {
   3.907660669439498*^9, 3.907660687205435*^9}, {3.9076607276377525`*^9, 
   3.9076607494825616`*^9}, {3.9076607892929573`*^9, 
   3.9076608066326256`*^9}, {3.9076608654548635`*^9, 3.907660889453173*^9}, {
   3.907660971099352*^9, 3.907661143394967*^9}, {3.907661202169264*^9, 
   3.907661251324032*^9}, {3.9076613060132637`*^9, 3.9076613932974668`*^9}, {
   3.9076631731340055`*^9, 3.907663174462246*^9}, {3.907672129638838*^9, 
   3.907672291364794*^9}, {3.9076724011690564`*^9, 3.9076724090486593`*^9}, {
   3.907672628897252*^9, 3.9076727035577106`*^9}, 3.907672998248267*^9, {
   3.907673032134738*^9, 3.907673042560119*^9}, {3.907673144387662*^9, 
   3.9076732090288725`*^9}, {3.9076732683127623`*^9, 
   3.9076732739676867`*^9}, {3.90767350541024*^9, 3.90767351933173*^9}, {
   3.907673706032604*^9, 3.9076737152273164`*^9}, {3.907673843434321*^9, 
   3.9076738786406717`*^9}, {3.9076740720658703`*^9, 3.90767411382172*^9}, {
   3.907674146092852*^9, 3.907674172998252*^9}, 3.9077743515300083`*^9, {
   3.9077745505099087`*^9, 3.9077745868124437`*^9}, {3.907774620379498*^9, 
   3.90777462906491*^9}, {3.907774723742488*^9, 3.907774810027215*^9}, 
   3.907774863006093*^9, {3.907774953580617*^9, 3.907774963281001*^9}, {
   3.907775809707384*^9, 3.907775847886366*^9}, {3.907776641299013*^9, 
   3.907776653540333*^9}, {3.907776718240711*^9, 3.9077767578513193`*^9}, {
   3.907776802950528*^9, 3.907776895082965*^9}, {3.907776930864875*^9, 
   3.9077769412256985`*^9}, {3.907776975044937*^9, 3.907777048765156*^9}, {
   3.9077770850845623`*^9, 3.9077771315042877`*^9}, {3.907811009803929*^9, 
   3.907811017908309*^9}, {3.907811051233142*^9, 3.907811107937869*^9}, {
   3.907811639161769*^9, 3.907811668159862*^9}, {3.9078117890878363`*^9, 
   3.9078117950551834`*^9}, {3.9078118583401384`*^9, 3.907812005505142*^9}, {
   3.9078137503654*^9, 3.9078137505371876`*^9}, {3.9078284906732845`*^9, 
   3.907828496295537*^9}, {3.9078285366113243`*^9, 3.907828538126604*^9}, {
   3.907830942273587*^9, 3.9078309556285353`*^9}, 3.907831019952051*^9, {
   3.9078315001945753`*^9, 3.9078316484943776`*^9}, {3.9078316798271255`*^9, 
   3.90783171823885*^9}, {3.9078317816306176`*^9, 3.907831815825652*^9}, {
   3.9078320392448444`*^9, 3.9078320490545845`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[160]:=",ExpressionUUID->"96bf3ef2-ffb8-4deb-bebe-d2fdfc7b9997"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getIntersectionOfLineSegmentByPolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "10"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.907828377231398*^9, 3.9078283910786552`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"22f7f21c-3f9d-4670-91d0-4083573afab7"],

Cell[BoxData[
 TemplateBox[{
  "$RecursionLimit", "reclim", 
   "\"Recursion depth of \\!\\(\\*RowBox[{\\\"4096\\\"}]\\) exceeded.\"", 2, 
   161, 1, 27503007361731718883, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.907838440963922*^9},
 CellLabel->
  "During evaluation of \
In[161]:=",ExpressionUUID->"f5e9e3b0-b019-494a-bff2-85c076ca1f18"],

Cell[BoxData[
 TerminatedEvaluation["RecursionLimit"]], "Output",
 CellChangeTimes->{3.90782839170308*^9, 3.9078285003453746`*^9, 
  3.9078285413914156`*^9, 3.907828782482003*^9, 3.9078309018866453`*^9, 
  3.9078310365230565`*^9, 3.9078315073508453`*^9, 3.9078317239874363`*^9, 
  3.9078349254091315`*^9, 3.9078352214212875`*^9, 3.9078384410264063`*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"76780b8d-0d3a-4922-93dd-a4677f5a5c89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getIntersectionOfLineSegmentByPolygon", "[", 
  RowBox[{"Polygon5", ",", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "5"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.907831489313801*^9, 3.907831491795558*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"7efddba1-df19-4e0e-8eb2-f9f6a34b9991"],

Cell[BoxData[
 TemplateBox[{
  "$RecursionLimit", "reclim", 
   "\"Recursion depth of \\!\\(\\*RowBox[{\\\"4096\\\"}]\\) exceeded.\"", 2, 
   162, 2, 27503007361731718883, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9078384412294855`*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"bc79955e-7d3d-4554-bfed-731d72ca8228"],

Cell[BoxData[
 TerminatedEvaluation["RecursionLimit"]], "Output",
 CellChangeTimes->{{3.90783149260787*^9, 3.9078315333506203`*^9}, {
   3.9078315903152285`*^9, 3.90783172112836*^9}, 3.9078349260808134`*^9, 
   3.9078352226397457`*^9, 3.9078384412919703`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"0a62978a-b6cc-4b52-b7ed-179a8e23cb25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"P1", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}]}], ",", 
     RowBox[{"P2", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], ",", 
     RowBox[{"P3", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}]}], ",", 
     RowBox[{"P4", "=", 
      RowBox[{"{", 
       RowBox[{"8", ",", "4"}], "}"}]}], ",", 
     RowBox[{"P5", "=", 
      RowBox[{"{", 
       RowBox[{"9", ",", "6"}], "}"}]}], ",", 
     RowBox[{"P6", "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}]}], ",", 
     RowBox[{"P7", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"P8", "=", 
      RowBox[{"{", 
       RowBox[{"10", ",", "10"}], "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "@", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Orange", ",", 
        RowBox[{"Line", "@", 
         RowBox[{"{", 
          RowBox[{
          "P1", ",", "P2", ",", "P3", ",", "P4", ",", "P5", ",", "P6", ",", 
           "P1"}], "}"}]}], ",", "Blue", ",", "\[IndentingNewLine]", 
        RowBox[{"PointSize", "@", "0.03"}], ",", 
        RowBox[{"Point", "[", "P1", "]"}], ",", 
        RowBox[{"Point", "[", "P2", "]"}], ",", 
        RowBox[{"Point", "[", "P3", "]"}], ",", 
        RowBox[{"Point", "[", "P4", "]"}], ",", 
        RowBox[{"Point", "[", "P5", "]"}], ",", 
        RowBox[{"Point", "[", "P6", "]"}], ",", "\[IndentingNewLine]", 
        "Orange", ",", 
        RowBox[{"Line", "@", 
         RowBox[{"{", 
          RowBox[{"P7", ",", "P8"}], "}"}]}], ",", "Blue", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PointSize", "@", "0.03"}], ",", 
        RowBox[{"Point", "[", "P7", "]"}], ",", 
        RowBox[{"Point", "[", "P8", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"segmentsOfIntersection", "=", 
          RowBox[{"getIntersectionOfLineSegmentByPolygon", "[", 
           RowBox[{
            RowBox[{"kmPolygon", "[", 
             RowBox[{"{", 
              RowBox[{
              "P1", ",", "P2", ",", "P3", ",", "P4", ",", "P5", ",", "P6"}], 
              "}"}], "]"}], ",", 
            RowBox[{"kmSegment", "[", 
             RowBox[{"{", 
              RowBox[{"P7", ",", "P8"}], "}"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
              ",", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}],
              "}"}], "]"}], "&"}], "/@", "segmentsOfIntersection"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P1", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P2", "]"}], ",", "None"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P3", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P4", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P5", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P6", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P7", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P8", "]"}], ",", "None"}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"GridLinesStyle", "\[Rule]", "LightGray"}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "9"}], ",", "9"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "Gray"}], "}"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "0", ",", "5"}], "}"}]}]}], "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9051757884842772`*^9, 3.905175838826053*^9}, {
   3.905176058147118*^9, 3.905176072928995*^9}, {3.9051761592206135`*^9, 
   3.905176232301854*^9}, {3.9051762818677826`*^9, 3.905176307016613*^9}, {
   3.905176343753724*^9, 3.905176416518076*^9}, {3.9051765820126753`*^9, 
   3.905176687779277*^9}, 3.905176722612262*^9, {3.90517680141591*^9, 
   3.90517690581408*^9}, {3.905176951729743*^9, 3.905176953511024*^9}, {
   3.90517698550694*^9, 3.9051770070720377`*^9}, {3.905177117124667*^9, 
   3.9051772490766664`*^9}, {3.905177283358158*^9, 3.905177358270666*^9}, {
   3.9051776865308533`*^9, 3.905177739170927*^9}, {3.9051782178643155`*^9, 
   3.9051782185516095`*^9}, {3.905178582494997*^9, 3.9051785829172335`*^9}, {
   3.905178672126581*^9, 3.9051787163048887`*^9}, {3.9051787744047947`*^9, 
   3.9051788592328916`*^9}, {3.9051789025549736`*^9, 
   3.9051789089283223`*^9}, {3.9051789399133377`*^9, 
   3.9051789917811413`*^9}, {3.905179086654401*^9, 3.905179129601815*^9}, {
   3.9051795613247004`*^9, 3.905179567356226*^9}, {3.905179618685765*^9, 
   3.9051796357009478`*^9}, {3.9051798115495644`*^9, 3.905179887906347*^9}, {
   3.905179935972728*^9, 3.905179938612691*^9}, {3.9051799742240276`*^9, 
   3.90518000575956*^9}, {3.9051800507574673`*^9, 3.9051801567435546`*^9}, {
   3.9051801896243305`*^9, 3.9051803234457583`*^9}, {3.905180356798132*^9, 
   3.9051805093841705`*^9}, {3.905180603009704*^9, 3.9051807002562943`*^9}, {
   3.905180737520022*^9, 3.905180752579425*^9}, {3.905180944803133*^9, 
   3.905181008337628*^9}, {3.905181042298333*^9, 3.9051810463789277`*^9}, {
   3.9051810841538277`*^9, 3.9051812749804*^9}, {3.90518131565872*^9, 
   3.905181319768863*^9}, {3.9051814348413134`*^9, 3.9051814354344687`*^9}, {
   3.905182142061779*^9, 3.905182161607398*^9}, {3.9051824911019273`*^9, 
   3.9051825173798337`*^9}, {3.905182559326013*^9, 3.9051825737913847`*^9}, {
   3.905182658865223*^9, 3.905182699111662*^9}, {3.905182730217201*^9, 
   3.9051827572889185`*^9}, 3.9051828020085807`*^9, {3.9078121557857833`*^9, 
   3.9078122380937595`*^9}, {3.907812487873704*^9, 3.9078125361113615`*^9}, {
   3.9078130126456766`*^9, 3.9078131135003586`*^9}, {3.9078132858509145`*^9, 
   3.9078134440502195`*^9}, {3.9078134927922325`*^9, 
   3.9078135668626256`*^9}, {3.9078137122670636`*^9, 
   3.9078138217686167`*^9}, {3.907814501991643*^9, 3.907814513318366*^9}, {
   3.9078146799432755`*^9, 3.907814682505077*^9}, {3.9078147127705812`*^9, 
   3.907814721394021*^9}, {3.907815000951404*^9, 3.9078150378495417`*^9}, {
   3.907828309290822*^9, 3.907828314586456*^9}, {3.9078283645937786`*^9, 
   3.9078283648593073`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"83188af1-4d40-44fa-bc1a-ef170a2fac04"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`P1$$ = {1, 5}, $CellContext`P2$$ = {2, 
  3}, $CellContext`P3$$ = {4, 1}, $CellContext`P4$$ = {8, 
  4}, $CellContext`P5$$ = {9, 6}, $CellContext`P6$$ = {3, 
  7}, $CellContext`P7$$ = {0, 0}, $CellContext`P8$$ = {10, 10}}, 
  DynamicBox[ToBoxes[
    Graphics[{Orange, 
      Line[{$CellContext`P1$$, $CellContext`P2$$, $CellContext`P3$$, \
$CellContext`P4$$, $CellContext`P5$$, $CellContext`P6$$, $CellContext`P1$$}], 
      Blue, 
      PointSize[0.03], 
      Point[$CellContext`P1$$], 
      Point[$CellContext`P2$$], 
      Point[$CellContext`P3$$], 
      Point[$CellContext`P4$$], 
      Point[$CellContext`P5$$], 
      Point[$CellContext`P6$$], Orange, 
      Line[{$CellContext`P7$$, $CellContext`P8$$}], Blue, 
      PointSize[0.03], 
      Point[$CellContext`P7$$], 
      Point[$CellContext`P8$$], $CellContext`segmentsOfIntersection = \
$CellContext`getIntersectionOfLineSegmentByPolygon[
         $CellContext`kmPolygon[{$CellContext`P1$$, $CellContext`P2$$, \
$CellContext`P3$$, $CellContext`P4$$, $CellContext`P5$$, $CellContext`P6$$}], 
         $CellContext`kmSegment[{$CellContext`P7$$, $CellContext`P8$$}]]; 
      Map[Line[{
          Part[#, 1]["coord"], 
          Part[#, 2]["coord"]}]& , $CellContext`segmentsOfIntersection], 
      Locator[
       Dynamic[$CellContext`P1$$], None], 
      Locator[
       Dynamic[$CellContext`P2$$], None], 
      Locator[
       Dynamic[$CellContext`P3$$], None], 
      Locator[
       Dynamic[$CellContext`P4$$], None], 
      Locator[
       Dynamic[$CellContext`P5$$], None], 
      Locator[
       Dynamic[$CellContext`P6$$], None], 
      Locator[
       Dynamic[$CellContext`P7$$], None], 
      Locator[
       Dynamic[$CellContext`P8$$], None]}, Frame -> True, GridLinesStyle -> 
     LightGray, GridLines -> ({#, #}& )[
       Join[
        Range[-9, 9], 
        Map[{#, Gray}& , {-5, 0, 5}]]], PlotRange -> {{0, 10}, {0, 10}}], 
    StandardForm],
   ImageSizeCache->{396.00000000000006`, {195., 201.0805652618409}}],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.907813068679227*^9, 3.9078130780706377`*^9}, {
   3.9078132944109735`*^9, 3.907813309481494*^9}, {3.9078134206089277`*^9, 
   3.907813444565302*^9}, 3.9078135673623805`*^9, {3.907813744382387*^9, 
   3.907813763418233*^9}, 3.9078138232057753`*^9, {3.907814488416795*^9, 
   3.9078145053815064`*^9}, 3.907814683270052*^9, 3.9078147221746173`*^9, {
   3.9078150144795036`*^9, 3.9078150385675907`*^9}, 3.907815159040796*^9, {
   3.9078165555403943`*^9, 3.907816584043878*^9}, 3.907827916645564*^9, 
   3.9078282623342295`*^9, 3.907828315195258*^9, 3.907828552122134*^9, 
   3.907828783669186*^9, 3.907830904371128*^9, 3.9078310389599457`*^9, 
   3.907831726080661*^9, 3.9078320532649517`*^9, 3.9078349261745424`*^9, 
   3.907838441463838*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"3d724ba8-7729-40b2-9d75-408bbf55002b"]
}, Open  ]],

Cell["3.2", "Text",
 CellChangeTimes->{{3.9076561328729744`*^9, 
  3.907656140136896*^9}},ExpressionUUID->"f0cbeb8f-4319-4e3c-8802-\
de772feafb89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPointFromParameter", "[", 
   RowBox[{"Segment_kmSegment", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"first", "=", 
       RowBox[{
        RowBox[{"getLeftSegmentPoint", "[", "Segment", "]"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"last", "=", 
       RowBox[{
        RowBox[{"getRightSegmentPoint", "[", "Segment", "]"}], "[", 
        "\"\<coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"last", "-", "first"}], ")"}], "*", "t"}], "+", "first"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907772783640952*^9, 3.9077727915144625`*^9}, {
  3.907772900299099*^9, 3.9077729309940896`*^9}, {3.9077729797084017`*^9, 
  3.9077730632633667`*^9}, {3.9077735527282815`*^9, 3.907773635432767*^9}, {
  3.9077744253581915`*^9, 3.9077745188457346`*^9}, {3.907776837458232*^9, 
  3.907776842637374*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[164]:=",ExpressionUUID->"93d8abce-e5d3-4059-969b-88760d526bfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getParameter", "[", 
   RowBox[{"Segment_kmSegment", ",", "P_kmPoint"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x0", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"getLeftSegmentPoint", "[", "Segment", "]"}], "[", 
          "\"\<coord\>\"", "]"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"getRightSegmentPoint", "[", "Segment", "]"}], "[", 
          "\"\<coord\>\"", "]"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"First", "@", 
       RowBox[{"First", "@", 
        RowBox[{"NSolve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x1", "-", "x0"}], ")"}], "*", "t"}], "+", "x0"}], "==", 
           RowBox[{
            RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", "t"}], "]"}]}]}], ")"}], 
     "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]], "Input",
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[165]:=",ExpressionUUID->"7a1b46d9-9620-411e-9a53-6b6273d4d6ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getRightSegmentPoint", "[", "Segment_kmSegment", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"coord1", "=", 
       RowBox[{
        RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"coord2", "=", 
       RowBox[{
        RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}], "[", 
        "\"\<coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coord1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ">", 
       RowBox[{"coord2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"kmPoint", "[", "coord1", "]"}], ",", 
      RowBox[{"kmPoint", "[", "coord2", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getLeftSegmentPoint", "[", "Segment_kmSegment", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"coord1", "=", 
       RowBox[{
        RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"coord2", "=", 
       RowBox[{
        RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}], "[", 
        "\"\<coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coord1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "<", 
       RowBox[{"coord2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"kmPoint", "[", "coord1", "]"}], ",", 
      RowBox[{"kmPoint", "[", "coord2", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9048098457770977`*^9, 3.90480992689445*^9}, {
  3.9048100031983023`*^9, 3.9048101184055862`*^9}, {3.9048101622004957`*^9, 
  3.904810227853198*^9}, {3.904810300248644*^9, 3.904810305778588*^9}, {
  3.904810475019848*^9, 3.904810475301*^9}, {3.9048105470888796`*^9, 
  3.9048105482448564`*^9}, {3.9048106123508*^9, 3.9048106476129436`*^9}, {
  3.9048137695815525`*^9, 3.9048137933132715`*^9}, {3.904813827958249*^9, 
  3.9048138289419928`*^9}, {3.907658634515074*^9, 3.907658639076085*^9}, {
  3.907658696393933*^9, 3.907658721843614*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[166]:=",ExpressionUUID->"12ceec5a-46d1-497c-b2d3-cb3d1421ff73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"areSegmentsCoincide", "[", 
   RowBox[{"Segment1_kmSegment", ",", "Segment2_kmSegment"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Segment1", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Segment1", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Segment2", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Segment2", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<CollinearQ\>\"", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"c", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.905359334845603*^9, 3.9053593811715636`*^9}, {
  3.905359413734867*^9, 3.9053595002402215`*^9}, {3.905359534735381*^9, 
  3.905359554782057*^9}, {3.9053596860326185`*^9, 3.905359737058818*^9}, {
  3.9053597713721*^9, 3.905359776255136*^9}, {3.905359821948392*^9, 
  3.9053599193698854`*^9}, {3.9053599660800643`*^9, 3.905359972862631*^9}, {
  3.907657820803055*^9, 3.9076578403723555`*^9}, {3.907657932743148*^9, 
  3.907657934227171*^9}, {3.9076582868617687`*^9, 3.90765831186871*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[168]:=",ExpressionUUID->"4f45bf42-93bd-470b-acf4-eb3020c8306b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isPointOnSegment", "[", 
   RowBox[{"Segment_kmSegment", ",", "Point_kmPoint"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", "=", 
      RowBox[{"getParameter", "[", 
       RowBox[{"Segment", ",", "Point"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "<=", "1"}], "&&", 
       RowBox[{"p", ">=", "0"}]}], ",", "True", ",", "False"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9053606007648335`*^9, 3.905360721333078*^9}, {
  3.905362058777917*^9, 3.905362063259987*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[169]:=",ExpressionUUID->"4f2101fc-47c1-4190-9f81-43706d134efe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"areSegmentsParallel", "[", 
   RowBox[{"Segment1_kmSegment", ",", "Segment2_kmSegment"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"getLeftSegmentPoint", "[", "Segment1", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"getRightSegmentPoint", "[", "Segment1", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"getLeftSegmentPoint", "[", "Segment2", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"getRightSegmentPoint", "[", "Segment2", "]"}], ")"}], "[", 
        "\"\<coord\>\"", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "-", "a"}], ",", 
        RowBox[{"d", "-", "c"}]}], "}"}], "]"}], "==", "0"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.907656675719801*^9, 3.9076567146399784`*^9}, {
  3.907658251332941*^9, 3.9076582580818167`*^9}, {3.907658437257085*^9, 
  3.907658438600504*^9}, {3.9076588648515387`*^9, 3.907658893696868*^9}, {
  3.907658933016884*^9, 3.9076589365675564`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[170]:=",ExpressionUUID->"7dbf779d-f444-4068-b145-7c5064aa83fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getLinesIntersectionPoint", "[", 
   RowBox[{"Line1_kmLine", ",", "Line2_kmLine"}], "]"}], ":=", 
  RowBox[{"kmPoint", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"First", "@", 
      RowBox[{"NSolve", "@", 
       RowBox[{"Through", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Line1", ",", "Line2"}], "}"}], "@", "\"\<equ\>\""}], 
        "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9053603365155935`*^9, 3.905360370445391*^9}, {
  3.9053618544546757`*^9, 3.9053618777020397`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[171]:=",ExpressionUUID->"97cf592a-fa12-4724-bfe4-c632c5b5be88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getSegmentsLocationRelativeToEachOther", "[", 
   RowBox[{"Segment1_kmSegment", ",", "Segment2_kmSegment"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"areSegmentsCoincide", "[", 
     RowBox[{"Segment1", ",", "Segment2"}], "]"}], ",", "1", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"areSegmentsParallel", "[", 
       RowBox[{"Segment1", ",", "Segment2"}], "]"}], ",", "0", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"isPointOnSegment", "[", 
          RowBox[{"Segment1", ",", 
           RowBox[{"getLinesIntersectionPoint", "[", 
            RowBox[{
             RowBox[{"kmLine", "[", "Segment1", "]"}], ",", 
             RowBox[{"kmLine", "[", "Segment2", "]"}]}], "]"}]}], "]"}], "&&", 
         RowBox[{"isPointOnSegment", "[", 
          RowBox[{"Segment2", ",", 
           RowBox[{"getLinesIntersectionPoint", "[", 
            RowBox[{
             RowBox[{"kmLine", "[", "Segment1", "]"}], ",", 
             RowBox[{"kmLine", "[", "Segment2", "]"}]}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"getParameter", "[", 
         RowBox[{"Segment2", ",", 
          RowBox[{"getLinesIntersectionPoint", "[", 
           RowBox[{
            RowBox[{"kmLine", "[", "Segment1", "]"}], ",", 
            RowBox[{"kmLine", "[", "Segment2", "]"}]}], "]"}]}], "]"}], ",", 
        "2"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.907656231290865*^9, 3.907656234282214*^9}, {
   3.907657442053887*^9, 3.90765745482158*^9}, {3.9076575873346286`*^9, 
   3.907657651021451*^9}, {3.907658110493492*^9, 3.9076581330264316`*^9}, 
   3.9076595632020273`*^9, {3.9076604559255667`*^9, 3.9076604936792126`*^9}, {
   3.9076605448429813`*^9, 3.9076605528718505`*^9}, {3.9076632668403053`*^9, 
   3.9076632703621497`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[172]:=",ExpressionUUID->"bfb5f254-635c-4f18-b2c3-906dbca2ecb2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 4.", "Section",
 CellChangeTimes->{{3.9072224108210764`*^9, 3.9072224249049854`*^9}, {
   3.907625427757161*^9, 3.9076254278908443`*^9}, {3.9076304421433764`*^9, 
   3.9076304422101035`*^9}, 
   3.907832335365074*^9},ExpressionUUID->"db814e94-8426-4b02-b8de-\
0e9f5a4c53ec"],

Cell[CellGroupData[{

Cell["\<\
4.6. \:041d\:0430\:043f\:0438\:0448\:0438\:0442\:0435 \
\:0444\:0443\:043d\:043a\:0446\:0438\:044e, \:0440\:0435\:0430\:043b\:0438\
\:0437\:0443\:044e\:0449\:0443\:044e \:043b\:043e\:0433\:0438\:0447\:0435\
\:0441\:043a\:0443\:044e \:043e\:043f\:0435\:0440\:0430\:0446\:0438\:044e \
\:0438\:0441\:043a\:043b\:044e\:0447\:0435\:043d\:0438\:044f \:0432\:044b\
\:043f\:0443\:043a\:043b\:043e\:0433\:043e \:043f\:043e\:043b\:0438\:0433\
\:043e\:043d\:0430 B \:0438\:0437 \:0432\:044b\:043f\:0443\:043a\:043b\:043e\
\:0433\:043e \:043f\:043e\:043b\:0438\:0433\:043e\:043d\:0430 A .\
\>", "Subsection",
 CellChangeTimes->{{3.907832344908327*^9, 
  3.907832382597548*^9}},ExpressionUUID->"35d9f218-d902-4c3e-b185-\
5051d2bc43d2"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"P1", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}]}], ",", 
     RowBox[{"P2", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], ",", 
     RowBox[{"P3", "=", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}]}], ",", 
     RowBox[{"P4", "=", 
      RowBox[{"{", 
       RowBox[{"8", ",", "4"}], "}"}]}], ",", 
     RowBox[{"P5", "=", 
      RowBox[{"{", 
       RowBox[{"9", ",", "6"}], "}"}]}], ",", 
     RowBox[{"P6", "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}]}], ",", 
     RowBox[{"P7", "=", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}], ",", 
     RowBox[{"P8", "=", 
      RowBox[{"{", 
       RowBox[{"8", ",", "3"}], "}"}]}], ",", 
     RowBox[{"P9", "=", 
      RowBox[{"{", 
       RowBox[{"9", ",", "9"}], "}"}]}], ",", 
     RowBox[{"P10", "=", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "@", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Orange", ",", 
        RowBox[{"Line", "@", 
         RowBox[{"{", 
          RowBox[{
          "P1", ",", "P2", ",", "P3", ",", "P4", ",", "P5", ",", "P6", ",", 
           "P1"}], "}"}]}], ",", "Blue", ",", "\[IndentingNewLine]", 
        RowBox[{"PointSize", "@", "0.03"}], ",", 
        RowBox[{"Point", "[", "P1", "]"}], ",", 
        RowBox[{"Point", "[", "P2", "]"}], ",", 
        RowBox[{"Point", "[", "P3", "]"}], ",", 
        RowBox[{"Point", "[", "P4", "]"}], ",", 
        RowBox[{"Point", "[", "P5", "]"}], ",", 
        RowBox[{"Point", "[", "P6", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "@", 
         RowBox[{"{", 
          RowBox[{"P7", ",", "P8", ",", "P9", ",", "P10", ",", "P7"}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PointSize", "@", "0.03"}], ",", 
        RowBox[{"Point", "[", "P7", "]"}], ",", 
        RowBox[{"Point", "[", "P8", "]"}], ",", 
        RowBox[{"Point", "[", "P9", "]"}], ",", 
        RowBox[{"Point", "[", "P10", "]"}], ",", "Orange", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"segmentsOfIntersection", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"getIntersectionOfLineSegmentByPolygon", "[", 
             RowBox[{"Polygon5", ",", 
              RowBox[{"kmSegment", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"P7", ",", "P8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"P8", ",", "P9"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"P9", ",", "P10"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"P10", ",", "P7"}], "}"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"segmentsOfIntersection", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"segmentsOfIntersection", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"segmentsOfIntersection", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}], "[", "\"\<coord\>\"", 
               "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"segmentsOfIntersection", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ")"}], "[", "\"\<coord\>\"", 
               "]"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "@", "segmentsOfIntersection"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P1", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P2", "]"}], ",", "None"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P3", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P4", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P5", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P6", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P7", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P8", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P9", "]"}], ",", "None"}], "]"}], ",", 
        RowBox[{"Locator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "P10", "]"}], ",", "None"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"GridLinesStyle", "\[Rule]", "LightGray"}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "#"}], "}"}], "&"}], "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "9"}], ",", "9"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "Gray"}], "}"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "0", ",", "5"}], "}"}]}]}], "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9051757884842772`*^9, 3.905175838826053*^9}, {
   3.905176058147118*^9, 3.905176072928995*^9}, {3.9051761592206135`*^9, 
   3.905176232301854*^9}, {3.9051762818677826`*^9, 3.905176307016613*^9}, {
   3.905176343753724*^9, 3.905176416518076*^9}, {3.9051765820126753`*^9, 
   3.905176687779277*^9}, 3.905176722612262*^9, {3.90517680141591*^9, 
   3.90517690581408*^9}, {3.905176951729743*^9, 3.905176953511024*^9}, {
   3.90517698550694*^9, 3.9051770070720377`*^9}, {3.905177117124667*^9, 
   3.9051772490766664`*^9}, {3.905177283358158*^9, 3.905177358270666*^9}, {
   3.9051776865308533`*^9, 3.905177739170927*^9}, {3.9051782178643155`*^9, 
   3.9051782185516095`*^9}, {3.905178582494997*^9, 3.9051785829172335`*^9}, {
   3.905178672126581*^9, 3.9051787163048887`*^9}, {3.9051787744047947`*^9, 
   3.9051788592328916`*^9}, {3.9051789025549736`*^9, 
   3.9051789089283223`*^9}, {3.9051789399133377`*^9, 
   3.9051789917811413`*^9}, {3.905179086654401*^9, 3.905179129601815*^9}, {
   3.9051795613247004`*^9, 3.905179567356226*^9}, {3.905179618685765*^9, 
   3.9051796357009478`*^9}, {3.9051798115495644`*^9, 3.905179887906347*^9}, {
   3.905179935972728*^9, 3.905179938612691*^9}, {3.9051799742240276`*^9, 
   3.90518000575956*^9}, {3.9051800507574673`*^9, 3.9051801567435546`*^9}, {
   3.9051801896243305`*^9, 3.9051803234457583`*^9}, {3.905180356798132*^9, 
   3.9051805093841705`*^9}, {3.905180603009704*^9, 3.9051807002562943`*^9}, {
   3.905180737520022*^9, 3.905180752579425*^9}, {3.905180944803133*^9, 
   3.905181008337628*^9}, {3.905181042298333*^9, 3.9051810463789277`*^9}, {
   3.9051810841538277`*^9, 3.9051812749804*^9}, {3.90518131565872*^9, 
   3.905181319768863*^9}, {3.9051814348413134`*^9, 3.9051814354344687`*^9}, {
   3.905182142061779*^9, 3.905182161607398*^9}, {3.9051824911019273`*^9, 
   3.9051825173798337`*^9}, {3.905182559326013*^9, 3.9051825737913847`*^9}, {
   3.905182658865223*^9, 3.905182699111662*^9}, {3.905182730217201*^9, 
   3.9051827572889185`*^9}, 3.9051828020085807`*^9, {3.9078121557857833`*^9, 
   3.9078122380937595`*^9}, {3.907812487873704*^9, 3.9078125361113615`*^9}, {
   3.9078130126456766`*^9, 3.9078131135003586`*^9}, {3.9078132858509145`*^9, 
   3.9078134440502195`*^9}, {3.9078134927922325`*^9, 
   3.9078135668626256`*^9}, {3.9078137122670636`*^9, 
   3.9078138217686167`*^9}, {3.907814501991643*^9, 3.907814513318366*^9}, {
   3.9078146799432755`*^9, 3.907814682505077*^9}, {3.9078147127705812`*^9, 
   3.907814721394021*^9}, {3.907815000951404*^9, 3.9078150378495417`*^9}, {
   3.907828309290822*^9, 3.907828314586456*^9}, {3.9078283645937786`*^9, 
   3.9078283648593073`*^9}, {3.90783243906472*^9, 3.907832440954951*^9}, {
   3.9078324735015326`*^9, 3.907832561399776*^9}, {3.9078326599083347`*^9, 
   3.9078326625795746`*^9}, {3.907832723749957*^9, 3.907832747009653*^9}, {
   3.907832999218025*^9, 3.907833075790429*^9}, {3.907833890611351*^9, 
   3.9078338930166073`*^9}, {3.9078339273482704`*^9, 
   3.9078339626524687`*^9}, {3.9078339930738516`*^9, 
   3.9078340023195157`*^9}, {3.90783405259336*^9, 3.907834053514586*^9}, {
   3.9078342449836316`*^9, 3.9078342780908413`*^9}, {3.9078343234715643`*^9, 
   3.907834332297166*^9}, {3.9078350255103498`*^9, 3.9078350579666643`*^9}, {
   3.9078350904009123`*^9, 3.9078351002668552`*^9}, {3.9078351391046724`*^9, 
   3.907835139855003*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"57bde090-4f18-49a8-88d4-f0b25e35c824"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getClosedContour", "[", "segments_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"L", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"segmentsCopy", "=", "segments"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "segments"}], "==", "0"}], ",", 
       RowBox[{"Return", "@", "Nothing"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"L", ",", 
        RowBox[{"segmentsCopy", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"contourStart", "=", 
      RowBox[{
       RowBox[{"segmentsCopy", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<end1Coord\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"contourEnd", "=", 
      RowBox[{
       RowBox[{"segmentsCopy", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<end2Coord\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"segmentsCopy", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"segmentsCopy", ",", 
          RowBox[{"L", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "segmentsCopy"}], "!=", "0"}], ","}]}], 
        "*)"}], "\[IndentingNewLine]", "flag"}], "=", "False"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "@", "segmentsCopy"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"segmentsCopy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"\"\<end1Coord\>\"", "==", "contourEnd"}], "]"}], ",", 
          RowBox[{"L", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"L", ",", 
             RowBox[{"segmentsCopy", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Length", "@", "L"}]}], "]"}]}], ",", "Nothing"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"segmentsCopy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"\"\<end2Coord\>\"", "==", "contourStart"}], "]"}], ",", 
          RowBox[{"L", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"L", ",", 
             RowBox[{"segmentsCopy", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}]}], ",", 
          "Nothing"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"flag", ",", 
          RowBox[{"segmentsCopy", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"segmentsCopy", ",", 
             RowBox[{"segmentsCopy", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "]", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "L"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9078384634260116`*^9, 3.9078389847939687`*^9}, {
  3.9078390264601307`*^9, 3.907839132286271*^9}, {3.90783920892714*^9, 
  3.907839218276162*^9}, {3.907839250643442*^9, 3.907839261642764*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"bbe90687-550e-403a-a17c-acf2e6461604"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getClosedContour", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "}"}], "]"}], ",", 
    RowBox[{"kmSegment", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "8"}], "}"}]}], "}"}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9078391368316426`*^9, 3.907839171589063*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"bd1eb0aa-33ac-4055-9e37-7a38d142518d"],

Cell[BoxData[
 RowBox[{"{", 
  TemplateBox[{"\"Segment\"", "\": \"", 
    RowBox[{"{", 
      RowBox[{
        TemplateBox[{"\"Point\"", "\"(\"", 
          TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], 
          "\")\""}, "RowDefault"], ",", 
        TemplateBox[{"\"Point\"", "\"(\"", 
          TemplateBox[{",", "\",\"", "2", "2"}, "RowWithSeparators"], 
          "\")\""}, "RowDefault"]}], "}"}]},
   "RowDefault"], "}"}]], "Output",
 CellChangeTimes->{3.9078391802684455`*^9, 3.9078392652625394`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"a02005e5-32d0-4c83-ac7e-cafc2a4de736"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152, 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"10ca292b-46c7-411c-9f46-cd0ce5f020a9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 529, 8, 160, "Title",ExpressionUUID->"4f7326cb-e841-4e65-b5f3-7e974e9cff9c"],
Cell[1112, 32, 390, 8, 63, "Text",ExpressionUUID->"1163ab55-f262-4f6c-bdec-feabab664307"],
Cell[CellGroupData[{
Cell[1527, 44, 1003, 20, 146, "Section",ExpressionUUID->"3bbc8b3e-b386-47b7-996c-1b97c23e0034"],
Cell[CellGroupData[{
Cell[2555, 68, 964, 20, 29, "Subsection",ExpressionUUID->"4ba9379f-60e3-45f6-bdba-0478a263b155"],
Cell[3522, 90, 4003, 75, 175, "Input",ExpressionUUID->"538bc582-54c9-4879-8bfa-9ce470a11221"],
Cell[7528, 167, 3731, 108, 321, "Input",ExpressionUUID->"d174d48d-56a1-41ce-80da-bcd2a6a220a7"],
Cell[11262, 277, 5265, 146, 489, "Input",ExpressionUUID->"f5943f25-2dd4-4799-a26a-817dc7b7ce44"],
Cell[16530, 425, 11580, 339, 710, "Input",ExpressionUUID->"f12b0a89-b0a3-44a2-9071-eb658a6d4002"],
Cell[28113, 766, 2050, 57, 147, "Input",ExpressionUUID->"120b82fd-9bdc-48a2-b105-736e0eb92902"],
Cell[30166, 825, 1621, 39, 217, "Input",ExpressionUUID->"fad16ad5-8e71-4d16-81d0-97edba438c9b"],
Cell[31790, 866, 11154, 288, 659, "Input",ExpressionUUID->"c704444e-c6fb-4765-8f38-4d908a983189"],
Cell[CellGroupData[{
Cell[42969, 1158, 261, 4, 49, "Subsubsection",ExpressionUUID->"202b42a1-fa0e-4593-a9ed-292e133831e5"],
Cell[43233, 1164, 147, 3, 38, "Text",ExpressionUUID->"d7e00534-eb57-4d0d-8a7c-5c737400e7f9"],
Cell[43383, 1169, 2884, 74, 196, "Input",ExpressionUUID->"4d98faff-4e7b-4724-a437-17c1a35fb6b9"],
Cell[46270, 1245, 1048, 26, 91, "Input",ExpressionUUID->"0c48a55d-e63d-4a41-ad12-5a437a171653"],
Cell[47321, 1273, 645, 18, 48, "Input",ExpressionUUID->"a3d45e92-de19-4da4-aa66-472aebad5c85"],
Cell[47969, 1293, 12246, 300, 614, "Input",ExpressionUUID->"dd79996a-d18e-4465-8e53-7407dbf5995e"],
Cell[60218, 1595, 279, 4, 56, "Text",ExpressionUUID->"c6197947-ef42-4de9-9808-118de5254dfd"],
Cell[CellGroupData[{
Cell[60522, 1603, 3563, 81, 94, "Input",ExpressionUUID->"03a1a2f4-c4eb-41be-b9df-56c21351a6a4"],
Cell[64088, 1686, 2619, 41, 35, "Output",ExpressionUUID->"d73792d2-5c64-4be3-a5ab-564f00ff9eff"],
Cell[66710, 1729, 2721, 44, 35, "Output",ExpressionUUID->"cd06a20b-d08f-4473-aa1a-d2148b0d54e6"],
Cell[69434, 1775, 2669, 43, 35, "Output",ExpressionUUID->"74ea345d-a170-433e-9027-2a4f8f1c7a7e"],
Cell[72106, 1820, 2678, 43, 35, "Output",ExpressionUUID->"0d6a1c8a-1bc9-4409-b6ff-868d28a3f364"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74821, 1868, 351, 5, 52, "Input",ExpressionUUID->"ab5dae68-db26-4491-97dd-390523f90282"],
Cell[75175, 1875, 1064, 20, 35, "Output",ExpressionUUID->"538f834d-835d-4154-bc15-cb27e350795d"],
Cell[76242, 1897, 1087, 21, 35, "Output",ExpressionUUID->"fa77f65b-bb61-4010-b3f7-35c2f1349a81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77366, 1923, 514, 8, 52, "Input",ExpressionUUID->"b4b49b03-55a6-4058-903d-bcfe40d88cdc"],
Cell[77883, 1933, 1104, 22, 35, "Output",ExpressionUUID->"fc935dae-52df-4cd6-b94d-0f079ee50a6d"],
Cell[78990, 1957, 1066, 21, 35, "Output",ExpressionUUID->"3ee51333-b9d8-4bc4-9b4e-265303ee859d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80093, 1983, 366, 5, 52, "Input",ExpressionUUID->"f4fbf46f-528d-48b4-a6d7-b248ddee7f9b"],
Cell[80462, 1990, 728, 10, 35, "Output",ExpressionUUID->"844f8773-1771-4abe-9867-2467cb4c2d24"],
Cell[81193, 2002, 760, 10, 35, "Output",ExpressionUUID->"28789c64-2e11-4c0f-b2bd-eaabc1b7396c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81990, 2017, 481, 9, 94, "Input",ExpressionUUID->"4bdb5988-1763-4a39-b16a-60d5f531d096"],
Cell[82474, 2028, 2126, 44, 35, "Output",ExpressionUUID->"fc0e3136-fd23-4274-ac7b-61381d10dd7d"],
Cell[84603, 2074, 2606, 56, 57, "Output",ExpressionUUID->"32187e4a-959f-44b6-a944-5cde79a2014e"],
Cell[87212, 2132, 2244, 49, 35, "Output",ExpressionUUID->"db1e4e20-3668-404c-9920-286baeebcfc4"],
Cell[89459, 2183, 2188, 47, 35, "Output",ExpressionUUID->"b2908b03-f869-427a-b5c3-ef1dc049cd35"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[91720, 2238, 194, 3, 74, "Section",ExpressionUUID->"5411dc08-fff0-4935-81c4-7c11289b7fa8"],
Cell[CellGroupData[{
Cell[91939, 2245, 985, 18, 29, "Subsection",ExpressionUUID->"f227b8bb-b39f-4acc-b15b-4c736d4e764c"],
Cell[92927, 2265, 706, 16, 48, "Input",ExpressionUUID->"a0ad85b5-851e-4cab-804d-0f75295bc322"],
Cell[CellGroupData[{
Cell[93658, 2285, 498, 8, 94, "Input",ExpressionUUID->"e87dd110-bdb8-433c-ba62-9c7a0a63864b"],
Cell[94159, 2295, 646, 11, 37, "Output",ExpressionUUID->"94c19a0d-6e85-4dc9-a430-34ac003ab01d"],
Cell[94808, 2308, 725, 15, 37, "Output",ExpressionUUID->"3fa54409-dda2-4126-ab02-e0ddec0cb612"],
Cell[95536, 2325, 646, 11, 37, "Output",ExpressionUUID->"335eaf9c-44b8-410c-98b0-b7a3b300f0db"],
Cell[96185, 2338, 681, 13, 37, "Output",ExpressionUUID->"1d26347e-e13c-41c7-8400-16142c184b52"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96915, 2357, 1082, 20, 55, "Subsection",ExpressionUUID->"0f3b2500-54fa-457c-aae3-fd8e559b4bc1"],
Cell[98000, 2379, 1389, 35, 88, "Input",ExpressionUUID->"2a6611f7-f463-46f2-b79e-39688b1f4a84"],
Cell[99392, 2416, 279, 4, 56, "Text",ExpressionUUID->"1e2ecab9-70b5-4e27-b30f-885a9071285f"],
Cell[CellGroupData[{
Cell[99696, 2424, 773, 20, 31, "Input",ExpressionUUID->"ace2476c-3557-493a-8bbe-855b5947b9f4"],
Cell[100472, 2446, 688, 11, 35, "Output",ExpressionUUID->"ae8ba57c-4cc2-42a7-8a6a-e461397de755"]
}, Open  ]],
Cell[101175, 2460, 1096, 29, 70, "Input",ExpressionUUID->"e419a25b-3e82-4361-a315-03690684129d"],
Cell[102274, 2491, 279, 4, 56, "Text",ExpressionUUID->"97e3f620-1cd5-4662-b024-92ed1557c9ec"],
Cell[CellGroupData[{
Cell[102578, 2499, 511, 8, 94, "Input",ExpressionUUID->"a36a7e5e-9d2a-4235-be31-b11e653cf178"],
Cell[103092, 2509, 1072, 21, 35, "Output",ExpressionUUID->"6ef67898-175e-4fc2-baa0-c677e610334e"],
Cell[104167, 2532, 1620, 35, 35, "Output",ExpressionUUID->"b192e721-eb94-42ea-b1a2-1da5f3bd0bc6"],
Cell[105790, 2569, 1120, 23, 35, "Output",ExpressionUUID->"06edd4d8-8868-46a7-9754-86e0d71aa8ab"],
Cell[106913, 2594, 1093, 22, 35, "Output",ExpressionUUID->"7a92c7a3-29db-4920-b076-f411280543a7"]
}, Open  ]],
Cell[108021, 2619, 649, 16, 48, "Input",ExpressionUUID->"84e2ba80-609c-4170-928c-2184dc6faba2"],
Cell[108673, 2637, 279, 4, 56, "Text",ExpressionUUID->"1e09dbd2-154c-410d-9eb5-ff190e7c2f34"],
Cell[CellGroupData[{
Cell[108977, 2645, 460, 7, 94, "Input",ExpressionUUID->"7c972da2-9ed1-4ad4-b0bc-1ef1d9a993b2"],
Cell[109440, 2654, 567, 9, 35, "Output",ExpressionUUID->"2b0b958b-98a1-48b7-ade6-000701983088"],
Cell[110010, 2665, 588, 10, 51, "Output",ExpressionUUID->"17ba2858-148f-48fe-9784-616b862c9ca3"],
Cell[110601, 2677, 587, 10, 51, "Output",ExpressionUUID->"8aa76ab9-a088-4411-bd3f-8924cc165489"],
Cell[111191, 2689, 583, 10, 51, "Output",ExpressionUUID->"aacf55b6-37a1-4ea8-890b-9b652569a4b4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111823, 2705, 663, 12, 89, "Subsection",ExpressionUUID->"37c4b324-fee1-4369-8228-a053674ecd2e"],
Cell[112489, 2719, 712, 17, 70, "Input",ExpressionUUID->"b99b3c90-d935-4f7a-8b90-6d5b9efac648"],
Cell[113204, 2738, 279, 4, 56, "Text",ExpressionUUID->"706ec70b-2c21-4c95-8caa-85917e374dc8"],
Cell[CellGroupData[{
Cell[113508, 2746, 609, 12, 94, "Input",ExpressionUUID->"1b4c95c6-1b73-465f-8690-e4acbdd412bd"],
Cell[114120, 2760, 601, 10, 35, "Output",ExpressionUUID->"5abfd1b8-41d7-4cee-aad1-af4c34ad3bf5"],
Cell[114724, 2772, 599, 10, 35, "Output",ExpressionUUID->"9c2c1efa-ee82-4509-85e8-2f3afdfe3bf6"],
Cell[115326, 2784, 598, 10, 35, "Output",ExpressionUUID->"67cc30ba-1950-4d4f-9b60-73772265ad5c"],
Cell[115927, 2796, 598, 10, 35, "Output",ExpressionUUID->"28dc224f-6b8e-44f2-bdc0-083602d9a22b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[116574, 2812, 529, 9, 59, "Subsection",ExpressionUUID->"8b970add-e736-4703-9e07-65e439d9c9df"],
Cell[117106, 2823, 1435, 37, 70, "Input",ExpressionUUID->"6f843795-98ce-46cc-a818-85daa8937f38"],
Cell[118544, 2862, 279, 4, 56, "Text",ExpressionUUID->"f3d0cf78-6db8-4e3d-acab-c86f7c84d70f"],
Cell[CellGroupData[{
Cell[118848, 2870, 353, 6, 52, "Input",ExpressionUUID->"9dac3e56-4976-4f87-bc18-ff4bd60a3f40"],
Cell[119204, 2878, 518, 8, 35, "Output",ExpressionUUID->"329ae625-96b9-4a58-b9c9-14876d53b970"],
Cell[119725, 2888, 516, 8, 35, "Output",ExpressionUUID->"4f114f03-2ca5-4038-8672-3cbe6675c3c0"]
}, Open  ]],
Cell[120256, 2899, 1274, 39, 52, "Input",ExpressionUUID->"fb0ac5d1-1668-4586-a8de-1f9f123ddc56"],
Cell[CellGroupData[{
Cell[121555, 2942, 354, 6, 52, "Input",ExpressionUUID->"7fe74c53-9dfa-4ba6-978f-7f2213cb2323"],
Cell[121912, 2950, 546, 8, 35, "Output",ExpressionUUID->"032ef3e3-788b-4c96-bd40-1940a07649a1"],
Cell[122461, 2960, 547, 8, 35, "Output",ExpressionUUID->"615cda77-2eb1-46e6-8423-a99d48f9fdb9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123057, 2974, 420, 6, 59, "Subsection",ExpressionUUID->"4275ed3d-c8c8-4ba5-910e-9549e35df5f0"],
Cell[123480, 2982, 3079, 76, 175, "Input",ExpressionUUID->"257660c2-8abd-41b5-a270-ff47d1c47c30"],
Cell[126562, 3060, 279, 4, 56, "Text",ExpressionUUID->"5e348f00-8bff-4385-a326-389442531813"],
Cell[CellGroupData[{
Cell[126866, 3068, 384, 7, 52, "Input",ExpressionUUID->"c930c453-ca6a-4186-ad6f-f763a69c23b8"],
Cell[127253, 3077, 852, 13, 35, "Output",ExpressionUUID->"c479ed51-b1d7-4799-90a2-533482b81a39"],
Cell[128108, 3092, 852, 13, 35, "Output",ExpressionUUID->"1557663a-c716-4091-8bb7-ddfe4d40d549"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128997, 3110, 840, 22, 52, "Input",ExpressionUUID->"6626089e-b03e-4449-8e7f-02f8f14f175c"],
Cell[129840, 3134, 700, 11, 35, "Output",ExpressionUUID->"768fd6b3-366a-4484-bf58-5a81508cca13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130577, 3150, 570, 17, 31, "Input",ExpressionUUID->"0e250d1b-13ac-4e8b-998d-c4628906be92"],
Cell[131150, 3169, 8362, 195, 266, "Output",ExpressionUUID->"88fb7e3e-bdbb-4c39-894d-8651e545f1a8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139561, 3370, 603, 11, 89, "Subsection",ExpressionUUID->"04b0059e-f8fa-44f7-8ed7-d5cb30ebe480"],
Cell[140167, 3383, 1541, 39, 99, "Input",ExpressionUUID->"574a3723-9b4b-4b62-9fed-9e30898385ec"],
Cell[141711, 3424, 279, 4, 56, "Text",ExpressionUUID->"b573322e-0e4d-49c6-a23c-0d5d3ee4ce6b"],
Cell[CellGroupData[{
Cell[142015, 3432, 605, 18, 31, "Input",ExpressionUUID->"77d5783f-9243-4593-9c8e-13e80d912dec"],
Cell[142623, 3452, 8092, 193, 273, "Output",ExpressionUUID->"fe484313-21c0-4a82-aa5e-6e20c0b7bbf8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150752, 3650, 586, 16, 31, "Input",ExpressionUUID->"0c2a662a-1eaa-41ac-8ec2-c73dc86750c5"],
Cell[151341, 3668, 501, 8, 35, "Output",ExpressionUUID->"1bd7ab17-3609-43f1-9f10-9053f41fc993"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151891, 3682, 628, 11, 89, "Subsection",ExpressionUUID->"694e84d9-2c5a-47dc-8849-69592d9311cc"],
Cell[152522, 3695, 1517, 23, 89, "Text",ExpressionUUID->"9e116249-3b31-48ac-8275-0e9844b3905b"],
Cell[154042, 3720, 9458, 198, 458, "Input",ExpressionUUID->"de270163-874c-4de3-bc2b-f9c6dda88f6b"],
Cell[163503, 3920, 279, 4, 56, "Text",ExpressionUUID->"c67b887b-f727-4a46-8c7b-7736708b5359"],
Cell[CellGroupData[{
Cell[163807, 3928, 939, 27, 31, "Input",ExpressionUUID->"020dff4e-3549-4316-99e4-baa29a7d8df0"],
Cell[164749, 3957, 1076, 28, 35, "Output",ExpressionUUID->"9f1d32c9-d279-4697-a53d-f8fb44a02356"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165862, 3990, 816, 25, 31, "Input",ExpressionUUID->"4dc901ab-a35c-4814-a905-47b8f0668046"],
Cell[166681, 4017, 8390, 198, 269, "Output",ExpressionUUID->"aa59af80-3d9a-43a4-a93b-fc4b45a8fa6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175108, 4220, 740, 18, 31, "Input",ExpressionUUID->"1437f241-7f2b-44bf-88a4-c84b44d6c000"],
Cell[175851, 4240, 1589, 22, 57, "Output",ExpressionUUID->"ff89ca71-980c-4364-94d0-9902d152e5e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177477, 4267, 542, 15, 31, "Input",ExpressionUUID->"37458897-bea5-4ebf-935e-c4d41d8ca8c7"],
Cell[178022, 4284, 596, 9, 35, "Output",ExpressionUUID->"2be99ffc-ff2c-4874-ac6d-9a73c492a076"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178655, 4298, 570, 16, 31, "Input",ExpressionUUID->"55265bc3-cc15-4f22-9565-b8dc62228ea3"],
Cell[179228, 4316, 585, 10, 35, "Output",ExpressionUUID->"23620696-5b48-4bef-ae02-69a9ba5ca9ae"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179874, 4333, 245, 4, 74, "Section",ExpressionUUID->"bbf9d3cd-8079-42ff-9348-fae53a2f53e8"],
Cell[CellGroupData[{
Cell[180144, 4341, 655, 11, 89, "Subsection",ExpressionUUID->"aec22270-6989-4321-87de-1d7f66206973"],
Cell[180802, 4354, 1269, 33, 91, "Input",ExpressionUUID->"d8140749-aa6e-4f01-9749-727adb62759d"],
Cell[182074, 4389, 279, 4, 56, "Text",ExpressionUUID->"bd024e44-36c3-4ead-8fbc-33e9b99a91db"],
Cell[CellGroupData[{
Cell[182378, 4397, 348, 8, 31, "Input",ExpressionUUID->"2e2df8af-3150-41c1-befb-b137180f1b23"],
Cell[182729, 4407, 423, 7, 35, "Output",ExpressionUUID->"913d53fe-7fe0-4359-8429-dd6ee28430e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183189, 4419, 352, 8, 31, "Input",ExpressionUUID->"ad1c3eb7-1bb9-4c1e-b002-754893c64237"],
Cell[183544, 4429, 404, 6, 35, "Output",ExpressionUUID->"41e6ee27-0990-4d53-b4f2-97c61dcfe19c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183997, 4441, 675, 12, 89, "Subsection",ExpressionUUID->"4edc95a2-fbc0-4967-8c36-613c832136c6"],
Cell[184675, 4455, 2785, 71, 133, "Input",ExpressionUUID->"49f669e3-22bc-4e5e-aa1b-024aa7f3da86"],
Cell[187463, 4528, 279, 4, 56, "Text",ExpressionUUID->"8259d7d4-f1db-452d-9e81-c075b2a52e90"],
Cell[CellGroupData[{
Cell[187767, 4536, 346, 8, 31, "Input",ExpressionUUID->"a4fa19f8-1056-4742-954b-161304332074"],
Cell[188116, 4546, 546, 8, 35, "Output",ExpressionUUID->"f38974b5-96c1-4b7f-a1c1-7e87e2a6fc31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188699, 4559, 348, 8, 31, "Input",ExpressionUUID->"516dbd1c-286e-482c-898c-b2a2f76820ff"],
Cell[189050, 4569, 410, 7, 35, "Output",ExpressionUUID->"5f0c1064-649b-4a4c-94e4-63c7a0fcd493"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189497, 4581, 346, 8, 31, "Input",ExpressionUUID->"355b1552-be56-4abd-929d-3bbb16e9cf38"],
Cell[189846, 4591, 374, 6, 35, "Output",ExpressionUUID->"f3aa8dce-2378-416e-b7c9-b75c4d7e2cd3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190269, 4603, 911, 15, 89, "Subsection",ExpressionUUID->"77db6646-b089-4131-8210-b2682aee8855"],
Cell[191183, 4620, 4625, 114, 230, "Input",ExpressionUUID->"346ea6c1-f524-44d8-a171-13f50aa8b021"],
Cell[195811, 4736, 279, 4, 56, "Text",ExpressionUUID->"7c390dde-54b2-465b-9eb5-a032ecfcb538"],
Cell[CellGroupData[{
Cell[196115, 4744, 361, 9, 31, "Input",ExpressionUUID->"e267320d-6e8c-4d2a-ac76-6359b791dc1f"],
Cell[196479, 4755, 619, 9, 35, "Output",ExpressionUUID->"0712726c-f18a-4d31-b2c0-79679304e080"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197135, 4769, 334, 8, 31, "Input",ExpressionUUID->"ece482a7-fd20-4dd2-8880-3513b96b6a11"],
Cell[197472, 4779, 525, 9, 35, "Output",ExpressionUUID->"17b67c8b-b391-4ce5-ab1b-78754bcba8b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198034, 4793, 332, 8, 31, "Input",ExpressionUUID->"e35446ef-1c1f-44f0-adde-b0da95f4b977"],
Cell[198369, 4803, 481, 8, 35, "Output",ExpressionUUID->"846cf5bf-1160-4dde-b068-ac960310d97c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198899, 4817, 909, 15, 89, "Subsection",ExpressionUUID->"a0678d51-5200-43fb-9215-45cd586eaa0c"],
Cell[199811, 4834, 2220, 53, 112, "Input",ExpressionUUID->"a225d382-adcd-487a-84e2-ac79c23b1787"],
Cell[CellGroupData[{
Cell[202056, 4891, 330, 8, 31, "Input",ExpressionUUID->"7c69011b-3089-4b31-adc5-3420cdb09563"],
Cell[202389, 4901, 381, 7, 35, "Output",ExpressionUUID->"fa76eb04-8798-4b39-830d-9ec34b4ae722"]
}, Open  ]],
Cell[202785, 4911, 1387, 32, 133, "Input",ExpressionUUID->"16605c01-e372-45be-8627-2e7d7f27a423"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[204221, 4949, 295, 4, 74, "Section",ExpressionUUID->"8a7afad1-4af4-4751-af5d-da3a5c1d6999"],
Cell[CellGroupData[{
Cell[204541, 4957, 1709, 26, 180, "Subsection",ExpressionUUID->"88ef5f01-ddef-45c4-8d85-6deaf318624a"],
Cell[206253, 4985, 7633, 172, 401, "Input",ExpressionUUID->"96bf3ef2-ffb8-4deb-bebe-d2fdfc7b9997"],
Cell[CellGroupData[{
Cell[213911, 5161, 471, 12, 31, "Input",ExpressionUUID->"22f7f21c-3f9d-4670-91d0-4083573afab7"],
Cell[214385, 5175, 370, 9, 30, "Message",ExpressionUUID->"f5e9e3b0-b019-494a-bff2-85c076ca1f18"],
Cell[214758, 5186, 436, 7, 38, "Output",ExpressionUUID->"76780b8d-0d3a-4922-93dd-a4677f5a5c89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215231, 5198, 467, 12, 31, "Input",ExpressionUUID->"7efddba1-df19-4e0e-8eb2-f9f6a34b9991"],
Cell[215701, 5212, 372, 9, 30, "Message",ExpressionUUID->"bc79955e-7d3d-4554-bfed-731d72ca8228"],
Cell[216076, 5223, 342, 6, 38, "Output",ExpressionUUID->"0a62978a-b6cc-4b52-b7ed-179a8e23cb25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216455, 5234, 7748, 175, 262, "Input",ExpressionUUID->"83188af1-4d40-44fa-bc1a-ef170a2fac04"],
Cell[224206, 5411, 2920, 63, 414, "Output",ExpressionUUID->"3d724ba8-7729-40b2-9d75-408bbf55002b"]
}, Open  ]],
Cell[227141, 5477, 147, 3, 38, "Text",ExpressionUUID->"f0cbeb8f-4319-4e3c-8802-de772feafb89"],
Cell[227291, 5482, 1138, 29, 91, "Input",ExpressionUUID->"93d8abce-e5d3-4059-969b-88760d526bfc"],
Cell[228432, 5513, 1349, 40, 91, "Input",ExpressionUUID->"7a1b46d9-9620-411e-9a53-6b6273d4d6ff"],
Cell[229784, 5555, 2324, 58, 154, "Input",ExpressionUUID->"12ceec5a-46d1-497c-b2d3-cb3d1421ff73"],
Cell[232111, 5615, 1952, 48, 91, "Input",ExpressionUUID->"4f45bf42-93bd-470b-acf4-eb3020c8306b"],
Cell[234066, 5665, 735, 20, 48, "Input",ExpressionUUID->"4f2101fc-47c1-4190-9f81-43706d134efe"],
Cell[234804, 5687, 1527, 41, 91, "Input",ExpressionUUID->"7dbf779d-f444-4068-b145-7c5064aa83fe"],
Cell[236334, 5730, 770, 21, 48, "Input",ExpressionUUID->"97cf592a-fa12-4724-bfe4-c632c5b5be88"],
Cell[237107, 5753, 1994, 44, 154, "Input",ExpressionUUID->"bfb5f254-635c-4f18-b2c3-906dbca2ecb2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[239150, 5803, 323, 5, 74, "Section",ExpressionUUID->"db814e94-8426-4b02-b8de-0e9f5a4c53ec"],
Cell[CellGroupData[{
Cell[239498, 5812, 732, 12, 89, "Subsection",ExpressionUUID->"35d9f218-d902-4c3e-b185-5051d2bc43d2"],
Cell[240233, 5826, 9748, 215, 366, "Input",ExpressionUUID->"57bde090-4f18-49a8-88d4-f0b25e35c824"],
Cell[249984, 6043, 3708, 96, 325, "Input",ExpressionUUID->"bbe90687-550e-403a-a17c-acf2e6461604"],
Cell[CellGroupData[{
Cell[253717, 6143, 680, 21, 31, "Input",ExpressionUUID->"bd1eb0aa-33ac-4055-9e37-7a38d142518d"],
Cell[254400, 6166, 605, 14, 35, "Output",ExpressionUUID->"a02005e5-32d0-4c83-ac7e-cafc2a4de736"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

