(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     99585,       2470]
NotebookOptionsPosition[     94485,       2384]
NotebookOutlinePosition[     94951,       2402]
CellTagsIndexPosition[     94908,       2399]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.", "Section",
 CellChangeTimes->{{3.908193991490741*^9, 
  3.908194002839224*^9}},ExpressionUUID->"8ee7ed7f-4584-47c6-b154-\
b36cb2931704"],

Cell["\<\
\:0421\:043f\:0440\:043e\:0435\:043a\:0442\:0438\:0440\:0443\:0439\:0442\:0435\
 \:0438 \:0441\:043e\:0437\:0434\:0430\:0439\:0442\:0435 \:0444\:0443\:043d\
\:043a\:0446\:0438\:0438 \:0434\:043b\:044f \:043f\:043e\:0441\:0442\:0440\
\:043e\:0435\:043d\:0438\:044f \:0432\:044b\:043f\:0443\:043a\:043b\:043e\
\:0439 \:043e\:0431\:043e\:043b\:043e\:0447\:043a\:0438 \:0437\:0430\:0434\
\:0430\:043d\:043d\:043e\:0433\:043e \:043c\:043d\:043e\:0436\:0435\:0441\
\:0442\:0432\:0430 \:0442\:043e\:0447\:0435\:043a \:043f\:043b\:043e\:0441\
\:043a\:043e\:0441\:0442\:0438 \:0441 \:0438\:0441\:043f\:043e\:043b\:044c\
\:0437\:043e\:0432\:0430\:043d\:0438\:0435\:043c \:0430\:043b\:0433\:043e\
\:0440\:0438\:0442\:043c\:0430 \:0414\:0436\:0430\:0440\:0432\:0438\:0441\
\:0430 . \:041f\:0440\:043e\:0432\:0435\:0434\:0438\:0442\:0435 \:0442\:0435\
\:0441\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:0435 .\
\>", "Text",
 CellChangeTimes->{{3.908194054615077*^9, 
  3.9081940664977617`*^9}},ExpressionUUID->"999f711a-b7c3-416d-8cda-\
0eb80c502ab1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"NamedQ", ",", "\[GothicK]\[GothicM]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[GothicK]\[GothicM]", "::", "usage"}], "=", 
   "\"\<Knowledge base \[LeftGuillemet]computer \
mathematics\[RightGuillemet]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"\[GothicK]\[GothicM]", ",", 
    RowBox[{"{", 
     RowBox[{"Protected", ",", "ReadProtected"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "::", "usage"}], "=", 
   "\"\<Check: is there a name of tested equations\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"n1_", ",", "n2__"}], "]"}], ":=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"NamedQ", "[", "n1", "]"}], ",", 
     RowBox[{"NamedQ", "[", "n2", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"NamedQ", ",", "Listable"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.690794992403058*^9, 3.6907950310873785`*^9}, {
   3.6908843882251835`*^9, 3.690884505856181*^9}, {3.6908846097825623`*^9, 
   3.6908846204600935`*^9}, {3.6908851707345686`*^9, 3.690885189421761*^9}, {
   3.690885248622609*^9, 3.690885266162938*^9}, {3.690885297959387*^9, 
   3.6908853003290596`*^9}, {3.6908853495988426`*^9, 3.690885357912713*^9}, {
   3.690885425150182*^9, 3.6908855152097607`*^9}, 3.6908856863125563`*^9, {
   3.6910553673987675`*^9, 3.6910554440588427`*^9}, {3.691055759975873*^9, 
   3.6910557646421666`*^9}, {3.6910557953308516`*^9, 
   3.6910558052688613`*^9}, {3.6910571930455256`*^9, 3.691057228129295*^9}, {
   3.6910573506928344`*^9, 3.6910573774560704`*^9}, 3.6910576910021176`*^9, {
   3.6914831461963997`*^9, 3.691483217152506*^9}, {3.6914838378740425`*^9, 
   3.691483842954578*^9}, {3.6914841790840755`*^9, 3.6914842060151005`*^9}, {
   3.691484255964369*^9, 3.691484308725642*^9}, {3.6914845063919625`*^9, 
   3.6914845071945424`*^9}, {3.69434039018277*^9, 3.694340502302164*^9}, {
   3.6943405533833623`*^9, 3.6943406466564827`*^9}, {3.6943409639572678`*^9, 
   3.694340968589549*^9}, {3.694341017695356*^9, 3.6943411035181704`*^9}, {
   3.696527247175319*^9, 3.6965272674873896`*^9}, 3.6965273138255253`*^9, {
   3.6965273615373993`*^9, 3.696527376755241*^9}, {3.69655510758998*^9, 
   3.6965552164478436`*^9}, {3.6965571661798143`*^9, 3.696557253853815*^9}, {
   3.696557292956991*^9, 3.6965573605427628`*^9}, {3.696558180263235*^9, 
   3.6965582440903544`*^9}, {3.6965583228056045`*^9, 
   3.6965583244067326`*^9}, {3.696559034465626*^9, 3.6965590354423246`*^9}, {
   3.696559261869051*^9, 3.696559292198389*^9}, {3.696559424453185*^9, 
   3.6965597066890697`*^9}, {3.69656108443996*^9, 3.6965611840235605`*^9}, {
   3.699846757775649*^9, 3.6998467603900304`*^9}, {3.6998478401435823`*^9, 
   3.699847843066986*^9}, {3.699867641692709*^9, 3.6998677591126623`*^9}, {
   3.6998690125200963`*^9, 3.6998690730458527`*^9}, 3.6998691223852415`*^9, 
   3.6998704309808755`*^9, {3.6998908518565655`*^9, 3.6998908741894794`*^9}, 
   3.6998911478080683`*^9, {3.699892062435873*^9, 3.6998920849038467`*^9}, {
   3.6998986854257493`*^9, 3.699898716756649*^9}, 3.699898932473677*^9, {
   3.6999026922242355`*^9, 3.699902707845271*^9}, {3.699902776288621*^9, 
   3.69990290528961*^9}, 3.699902958669608*^9, 3.699902996994115*^9, {
   3.6999493396563025`*^9, 3.6999495516970167`*^9}, {3.905153834663835*^9, 
   3.905153887263437*^9}, {3.9051539254097486`*^9, 3.9051539401716366`*^9}, {
   3.9051541956496224`*^9, 3.90515420030477*^9}, 3.9082601425336275`*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[1]:=",ExpressionUUID->"16162efc-264d-43bd-8d73-7f94a9cd664c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmPoint", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmPoint", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "::", "usage"}], "=", "\"\<Point on the surface\>\""}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}], 
     "]"}], "[", "\"\<coord\>\"", "]"}], ":=", "coord"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmPoint", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Point\>\"", ",", 
      "id"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"coord", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coord"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"coord", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"L1_kmLine", ",", "L2_kmLine"}], "}"}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"First", "@", 
       RowBox[{"NSolve", "@", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"L1", ",", "L2"}], "}"}], "@", "\"\<equ\>\""}], "]"}]}]}], 
      ")"}]}], "]"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"P_kmPoint", ",", "StandardForm"}], "]"}], ":=", 
   RowBox[{"Row", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "[", "\"\<id\>\"", "]"}], ",", "\"\<(\>\"", ",", 
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"P", "[", "\"\<coord\>\"", "]"}], ",", "\"\<,\>\""}], "]"}], 
      ",", "\"\<)\>\""}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.907599406479768*^9, 3.9075994074788437`*^9}, {
  3.9075998596210737`*^9, 3.9075998623707933`*^9}, {3.907600755005046*^9, 
  3.907600757670816*^9}, {3.9076055006551104`*^9, 3.907605501604168*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[7]:=",ExpressionUUID->"ec09dff8-3ab6-4d09-9e09-a4e23f250f03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmVector", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmVector", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "::", "usage"}], "=", 
    "\"\<Vector on the surface\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmVector", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "[", "\"\<id\>\"", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Vector\>\"", ",", 
     "id"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}], 
     "]"}], "[", "\"\<coord\>\"", "]"}], ":=", "coord"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmVector", "[", 
      RowBox[{
      "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}],
       "]"}], "[", "\"\<norm\>\"", "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"coord", "*", "coord"}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", 
    RowBox[{"id_String", ",", "coord_List"}], "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", "coord_List", "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", 
    RowBox[{"id_String", ",", "P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"id", ",", 
     RowBox[{
      RowBox[{"P1", "@", "\"\<coord\>\""}], "-", 
      RowBox[{"P0", "@", "\"\<coord\>\""}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{"P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
    RowBox[{"kmVector", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NamedQ", "[", 
         RowBox[{"P0", ",", "P1"}], "]"}], ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"P0", "@", "\"\<id\>\""}], ",", 
          RowBox[{"P1", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
       "]"}], ",", "P0", ",", "P1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"V_kmVector", ",", "StandardForm"}], "]"}], "^:=", 
   RowBox[{"TemplateBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V", "@", "\"\<id\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"RowBox", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"#", ",", "StandardForm"}], "]"}], "&"}], "/@", 
           RowBox[{"V", "[", "\"\<coord\>\"", "]"}]}], ",", "\"\<,\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\"\<Point2D\>\"", ",",
      "\[IndentingNewLine]", 
     RowBox[{"DisplayFunction", "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"OverscriptBox", "[", 
            RowBox[{"#1", ",", "\"\<\[RightVector]\>\""}], "]"}], ",", 
           "\"\<(\>\"", ",", "#2", ",", "\"\<)\>\""}], "}"}]}], "&"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"InterpretationFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<{\>\"", ",", "#2", ",", "\"\<}\>\""}], "}"}]}], "&"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Tooltip", "\[Rule]", "Automatic"}]}], "]"}]}], ";"}]}], "Input",
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[17]:=",ExpressionUUID->"286e5e4f-b637-4c69-80c1-575982b2725b"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "kmLine", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
     "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ",
     "**)"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"kmLine", ",", "ReadProtected"}], "]"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "::", "usage"}], "=", "\"\<Line on the surface\>\""}], 
    ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
    " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"NamedQ", "[", 
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "]"}], "^:=", 
    RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Line\>\"", ",", 
      "id"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{
      "\[GothicK]\[GothicM]", ",", "_String", ",", "coef_List", ",", "___"}], 
      "]"}], "[", "\"\<coef\>\"", "]"}], ":=", "coef"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"kmLine", "[", 
       RowBox[{
       "\[GothicK]\[GothicM]", ",", "_String", ",", "coef_List", ",", "___"}],
        "]"}], "[", 
      RowBox[{"\"\<equ\>\"", ",", 
       RowBox[{"vars", ":", 
        RowBox[{"{", 
         RowBox[{"_Symbol", ",", "_Symbol"}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"\[FormalX]", ",", "\[FormalY]"}], "}"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coef", ".", 
       RowBox[{"Append", "[", 
        RowBox[{"vars", ",", "1"}], "]"}]}], "\[Equal]", "0"}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{
      RowBox[{"equ", ":", 
       RowBox[{"(", 
        RowBox[{"__", "\[Equal]", "0"}], ")"}]}], ",", 
      RowBox[{"vars", ":", 
       RowBox[{"{", 
        RowBox[{"_Symbol", ",", "_Symbol"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\"\<\>\"", ",", "equ", ",", "vars"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"A_.", " ", "x_"}], "+", 
        RowBox[{"B_.", "y_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_Symbol", ",", "y_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}], "/;", 
     RowBox[{"\[Not]", 
      RowBox[{"PossibleZeroQ", "[", 
       RowBox[{
        RowBox[{"Abs", "@", "A"}], "+", 
        RowBox[{"Abs", "@", "B"}]}], "]"}]}]}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"A_.", " ", "x_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_Symbol", ",", "_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "0", ",", "C"}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"B_.", " ", "y_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"_Symbol", ",", "y_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "B", ",", "C"}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", "P_kmPoint", ",", "Dir_kmVector"}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"-", 
           RowBox[{"#", ".", 
            RowBox[{"P", "[", "\"\<coord\>\"", "]"}]}]}]}], "]"}], "&"}], "[", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"Dir", "[", "\"\<coord\>\"", "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"P_kmPoint", ",", "Dir_kmVector"}], "]"}], ":=", 
    RowBox[{"kmLine", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NamedQ", "[", 
         RowBox[{"P", ",", "Dir"}], "]"}], ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"P", "@", "\"\<id\>\""}], ",", 
          RowBox[{"Dir", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
       "]"}], ",", "P", ",", "Dir"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"kmLine", "[", 
    RowBox[{"id_String", ",", "P1_kmPoint", ",", "P2_kmPoint"}], "]"}], ":=", 
   RowBox[{"kmLine", "[", 
    RowBox[{"id", ",", "P1", ",", 
     RowBox[{"kmVector", "[", 
      RowBox[{"\"\<\>\"", ",", "P1", ",", "P2"}], "]"}]}], "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{"P1_kmPoint", ",", "P2_kmPoint"}], "}"}], "]"}], ":=", 
   RowBox[{"kmLine", "[", 
    RowBox[{"P1", ",", 
     RowBox[{"kmVector", "[", 
      RowBox[{
       RowBox[{"P2", "@", "\"\<id\>\""}], ",", "P1", ",", "P2"}], "]"}]}], 
    "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmLine", "[", 
   RowBox[{"id_String", ",", "segment_kmSegment"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"kmLine", "[", 
     RowBox[{"id", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}], "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}], "y"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", "*", "y2"}], "-", 
          RowBox[{"x2", "*", "y1"}]}], ")"}]}], "==", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmLine", "[", "segment_kmSegment", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"kmLine", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y1", "-", "y2"}], ")"}], "x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x1"}], ")"}], "y"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", "*", "y2"}], "-", 
           RowBox[{"x2", "*", "y1"}]}], ")"}]}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}], " ", 
    "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{"L_kmLine", ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "@", "\"\<id\>\""}], ",", "\"\<: \>\"", ",", 
       RowBox[{"L", "@", "\"\<equ\>\""}]}], "}"}]}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]]}], "Input",
 CellChangeTimes->{{3.907585689627097*^9, 3.907585692343799*^9}, {
   3.9076005643124437`*^9, 3.9076005646295414`*^9}, 3.9076054145176597`*^9, {
   3.907659283005635*^9, 3.907659287691595*^9}, {3.907659346245527*^9, 
   3.9076594479527273`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[29]:=",ExpressionUUID->"f601de5c-989f-40cb-93b5-75768e8dae96"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"ClearAll", "[", "kmSegment", "]"}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
     "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ",
     "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"kmSegment", ",", "ReadProtected"}], "]"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "::", "usage"}], "=", 
     "\"\<\:041e\:0442\:0440\:0435\:0437\:043e\:043a \:043d\:0430 \
\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
    " ", "**)"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"NamedQ", "[", 
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "]"}], "^:=", 
    RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Segment\>\"", ",", 
      "id"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<coords\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"kmPoint", "[", "#", "]"}], "&"}], "/@", "endCoords"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<end1Coord\>\"", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"x2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "<", "x2"}], "||", 
         RowBox[{"y1", "<", "y2"}]}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], "]"}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<end2Coord\>\"", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"x2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "<", "x2"}], "||", 
         RowBox[{"y1", "<", "y2"}]}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}], "]"}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
      RowBox[{"endCoords", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
    "\"\<len\>\"", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Plus", "@@", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"endCoords", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"endCoords", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}], "]"}]}], 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmSegment", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"endsCoords", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "endsCoords"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmSegment", "[", 
    RowBox[{"endsCoords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "endsCoords"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"id_String", ",", "P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
    RowBox[{"kmSegment", "[", 
     RowBox[{"id", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P1", "@", "\"\<coord\>\""}], ",", 
        RowBox[{"P0", "@", "\"\<coord\>\""}]}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
     RowBox[{"kmSegment", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NamedQ", "[", 
          RowBox[{"P0", ",", "P1"}], "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"P0", "@", "\"\<id\>\""}], ",", 
           RowBox[{"P1", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
        "]"}], ",", "P0", ",", "P1"}], "]"}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}], " ", 
    "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"Segment_kmSegment", ",", "StandardForm"}], "]"}], ":=", 
     RowBox[{"Row", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Segment", "@", "\"\<id\>\""}], ",", "\"\<: \>\"", ",", 
        RowBox[{"Segment", "@", "\"\<coords\>\""}]}], "}"}]}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", "\:041e\:0442\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\:0435",
      " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0430", " ", "\:043d\:0430", 
     " ", "\:0440\:0438\:0441\:0443\:043d\:043a\:0435"}], "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "kmGraphics2D", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmGraphics2D", "[", 
    RowBox[{"gp_List", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"gp", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P_kmPoint", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{
            RowBox[{"Point", "@", 
             RowBox[{"P", "@", "\"\<coord\>\""}]}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"P", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"L_kmLine", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"InfiniteLine", "@", 
             RowBox[{"Through", "@", 
              RowBox[{
               RowBox[{"getTwoLinePoints", "[", "L", "]"}], "@", 
               "\"\<coord\>\""}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"L", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Segment_kmSegment", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Segment", "@", "\"\<end1Coord\>\""}], ",", 
              RowBox[{"Segment", "@", "\"\<end2Coord\>\""}]}], "}"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "opts"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9046685125381203`*^9, 3.904668536751914*^9}, {
   3.9046690203567905`*^9, 3.9046690368542547`*^9}, {3.9046693933418837`*^9, 
   3.904669417588151*^9}, {3.90466978882434*^9, 3.904669792239921*^9}, 
   3.9046699658807673`*^9, {3.904670081023004*^9, 3.904670099611061*^9}, {
   3.904670300458583*^9, 3.904670308740033*^9}, {3.9046703658050957`*^9, 
   3.9046704147201924`*^9}, {3.9046704915499024`*^9, 3.904670492066557*^9}, {
   3.904670527895545*^9, 3.9046705281946983`*^9}, {3.904670709404814*^9, 
   3.9046707176680346`*^9}, {3.904671051060985*^9, 3.904671106870425*^9}, {
   3.904671215788891*^9, 3.904671218672679*^9}, {3.904672152718809*^9, 
   3.904672173016215*^9}, 3.9046722258427725`*^9, {3.904672267404024*^9, 
   3.9046723281286473`*^9}, {3.9046726016768165`*^9, 
   3.9046727633401175`*^9}, {3.9046733567087173`*^9, 3.904673396471535*^9}, {
   3.90467343201515*^9, 3.9046734527471523`*^9}, {3.904673523920989*^9, 
   3.90467363662348*^9}, {3.9046737131297865`*^9, 3.9046737413094463`*^9}, {
   3.9046740510152445`*^9, 3.904674065017725*^9}, 3.9046741210439873`*^9, {
   3.9046756920067773`*^9, 3.904675698589094*^9}, {3.9048117579284134`*^9, 
   3.90481176882706*^9}, {3.9048125182158003`*^9, 3.9048126541989794`*^9}, {
   3.9048137538510246`*^9, 3.9048137635669937`*^9}, {3.9048138138438115`*^9, 
   3.9048138213761215`*^9}, {3.905155636458993*^9, 3.9051556385991087`*^9}, 
   3.9051571723419247`*^9, {3.9051753249562893`*^9, 3.905175325206192*^9}, {
   3.9075756017663727`*^9, 3.907575630379318*^9}, {3.9075756624088974`*^9, 
   3.907575709168853*^9}, {3.9075759093770657`*^9, 3.9075759179260125`*^9}, {
   3.907575955603362*^9, 3.907575962620142*^9}, {3.907576123215556*^9, 
   3.9075761247311635`*^9}, {3.907583266490574*^9, 3.907583267573224*^9}, {
   3.9082901585569887`*^9, 3.908290403729882*^9}, {3.9082904413168893`*^9, 
   3.908290452657977*^9}, 3.908295109787471*^9},
 Background->RGBColor[
  0.88, 1, 0.88],ExpressionUUID->"2c7bdca1-d923-4ee2-8ff1-2b99ebfbd0a5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}], "}"}], "]"}], 
    "&"}], "/@", 
   RowBox[{"Range", "[", "20", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.908195449285694*^9, {3.9081955640536375`*^9, 3.9081957044021196`*^9}, {
   3.9081966412818613`*^9, 3.908196641481228*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"508b7830-4ff7-44ed-848b-6a92855c34a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3.450863040812891`", 
       RowBox[{"-", "9.183166400942934`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2.858016341238283`", "5.567321074837189`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "0.2529126375449522`"}], 
       RowBox[{"-", "7.451234902267853`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.305603084067279`", "2.11850810196389`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "5.671296097069668`"}], "6.2803645639637224`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.614707593767065`", 
       RowBox[{"-", "2.6382040813385608`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.1116217149654588`", "8.221829714723668`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2.502238819838368`", "4.221682821981723`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.023710188874315`"}], 
       RowBox[{"-", "5.979732974477837`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "4.253865943041838`"}], 
       RowBox[{"-", "6.943573389829744`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.837970762444371`", "9.812002055117873`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.101843048596898`", 
       RowBox[{"-", "1.5972141476243422`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8.525691458418457`", 
       RowBox[{"-", "7.708950709545061`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9.01031859052815`", 
       RowBox[{"-", "2.4893809728586476`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.379983606599044`"}], "9.53140734835221`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8.674190061483692`", "5.427066911126097`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3.704706656704971`", "3.0865770479545276`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "3.6445819459457773`"}], "2.031144210095995`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2.072251475558268`", 
       RowBox[{"-", "1.917543314739035`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.0941805697503355`", "6.421305883307909`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.908195449851229*^9, 3.908195581318699*^9, {3.9081956501419635`*^9, 
   3.9081957054514837`*^9}, {3.908196642130308*^9, 3.9081966483460255`*^9}, 
   3.908215800834552*^9, 3.9082158383964877`*^9, 3.9082504516403303`*^9, 
   3.9082559302100163`*^9, 3.9082571131228156`*^9, 3.908260150480048*^9, 
   3.9082603080225215`*^9, {3.908260413987914*^9, 3.908260466479351*^9}, 
   3.908260547012972*^9, 3.9082610293107843`*^9, 3.9082610910155816`*^9, {
   3.9082611725203543`*^9, 3.9082611991353865`*^9}, 3.908261250440432*^9, {
   3.908261397657208*^9, 3.9082614217261257`*^9}, 3.9082614857671213`*^9, 
   3.9082616402324924`*^9, 3.9082705779936876`*^9, 3.9082733598193665`*^9, 
   3.908273969746954*^9, 3.9082851128883514`*^9, 3.908287811733884*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"7adef4fa-ac9c-4f21-a2a1-bd60d029e042"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getTriangleAlgebraicSquare", "[", "points_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}]}], 
     "}"}], ",", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "-", "a"}], ",", 
        RowBox[{"c", "-", "a"}]}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082106229389763`*^9, 3.9082106240218616`*^9}, 
   3.908211217345231*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[244]:=",ExpressionUUID->"7f6eac22-11d6-4258-81ab-7bc34c95371d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isPointOnLine", "[", 
   RowBox[{"Line_kmLine", ",", "P_kmPoint"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Line", "[", "\"\<equ\>\"", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[FormalX]", "->", 
      RowBox[{
       RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"\[FormalY]", "->", 
      RowBox[{
       RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.904815420337186*^9, 3.9048154519503098`*^9}, {
  3.9048157773468633`*^9, 3.9048157856785975`*^9}, {3.9048158648699355`*^9, 
  3.9048158724686975`*^9}, {3.9048190916991386`*^9, 3.904819148463625*^9}, {
  3.9048193710953183`*^9, 3.9048193774866447`*^9}, {3.9054223173088293`*^9, 
  3.905422323057804*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[65]:=",ExpressionUUID->"cd9ec9c2-2ebb-411b-bbb0-2cdb4664ae0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "Unequal", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.908253016716829*^9, 3.908253022385515*^9}, {
   3.908253183869872*^9, 3.9082531928622837`*^9}, {3.908253253320803*^9, 
   3.908253255554241*^9}, 3.908261363217743*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[66]:=",ExpressionUUID->"7617d9e4-2851-4260-b9c4-aa86a84cdc0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unequal", "[", 
   RowBox[{"Point1_kmPoint", ",", "Point2_kmPoint"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Point1", "[", "\"\<coord\>\"", "]"}], "!=", 
   RowBox[{"Point2", "[", "\"\<coord\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.908252917605296*^9, 3.908252975214261*^9}, {
  3.908253085625863*^9, 3.9082531090584154`*^9}, {3.9082532594325275`*^9, 
  3.9082532754652853`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[67]:=",ExpressionUUID->"ad5aa6db-08c4-47dd-a63f-0046f27d91ef"],

Cell["\:0412\:0430\:0436\:043d\:043e \:0437\:0430\:043a\:0438\:043d\:0443\
\:0442\:044c \:0441\:0442\:0430\:0440\:0442\:043e\:0432\:0443\:044e \:0442\
\:043e\:0447\:043a\:0443 \:0432 \:043a\:043e\:043d\:0435\:0446 Q.", "Text",
 CellChangeTimes->{{3.9082540997353363`*^9, 3.908254120998789*^9}, {
  3.9082559567666283`*^9, 3.9082559621871433`*^9}, {3.9082605919210663`*^9, 
  3.908260594092931*^9}},ExpressionUUID->"5fd0810c-3332-4a85-b3cb-\
2308a9bc5015"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getStartPoint", "[", "Q_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"StartPoint", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "@", "Q"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Or", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{"StartPoint", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], "==", 
              RowBox[{
               RowBox[{"StartPoint", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{
             RowBox[{"StartPoint", "[", "\"\<coord\>\"", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"StartPoint", "=", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "StartPoint"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9082541463958406`*^9, 3.9082541608119807`*^9}, {
   3.9082543509537926`*^9, 3.9082543925314045`*^9}, {3.908254497201454*^9, 
   3.9082545080001445`*^9}, 3.908295367122085*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[218]:=",ExpressionUUID->"6f6cabf9-2779-401e-826e-2824ac168cab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"moveToEndOfList", "[", 
   RowBox[{"lst_List", ",", "obj_"}], "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{"lst", ",", "obj"}], "]"}], ",", "obj"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082546118859673`*^9, 3.908254658730665*^9}, {
  3.9082547562006397`*^9, 3.9082547805804815`*^9}, {3.9082560025321026`*^9, 
  3.9082560180837793`*^9}, {3.9082562090188313`*^9, 3.9082562102212124`*^9}, {
  3.908256244702718*^9, 3.9082562481389503`*^9}, {3.9082563048503056`*^9, 
  3.908256324687222*^9}, {3.908256445721245*^9, 3.9082564665404234`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[69]:=",ExpressionUUID->"2478a258-7b3c-4f6b-84a0-96d971fd7f4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getParameter", "[", 
   RowBox[{"Segment_kmSegment", ",", "P_kmPoint"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"y0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "-", "x0"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"NSolve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y1", "-", "y0"}], ")"}], "*", "t"}], "+", "y0"}], "==", 
             RowBox[{
              RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "t"}], "]"}]}]}], ")"}], 
       "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"NSolve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x0"}], ")"}], "*", "t"}], "+", "x0"}], "==", 
             RowBox[{
              RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "t"}], "]"}]}]}], ")"}], 
       "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082876538960047`*^9, 3.908287747120054*^9}, {
   3.9082883697230377`*^9, 3.908288408191224*^9}, 3.9082884394935637`*^9, {
   3.9082885237745523`*^9, 3.908288565278925*^9}, {3.908288929483199*^9, 
   3.908288947703117*^9}, {3.9082893972019053`*^9, 3.9082894050750537`*^9}, {
   3.908289439903906*^9, 3.908289515266131*^9}, {3.9082895751678996`*^9, 
   3.9082896725166054`*^9}, {3.9082897974676557`*^9, 3.9082898375802894`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[197]:=",ExpressionUUID->"b308d98b-f4d8-4e73-ae8b-5bc190bd1758"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CH", "[", "pointsList_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"Q", "=", "pointsList"}], ",", "StartPoint", ",", 
      "CurrentPoint", ",", "NextPoint", ",", "algebraicSquare", ",", 
      RowBox[{"L", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StartPoint", "=", 
      RowBox[{"getStartPoint", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"L", ",", "StartPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"moveToEndOfList", "[", 
       RowBox[{"Q", ",", "StartPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurrentPoint", "=", "StartPoint"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NextPoint", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"NextPoint", "!=", "StartPoint"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"isPointOnLine", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"kmLine", "[", 
                RowBox[{"{", 
                 RowBox[{"CurrentPoint", ",", "NextPoint"}], "}"}], "]"}], 
               ",", "i"}], "\[IndentingNewLine]", "]"}], 
             "\[IndentingNewLine]", "&&", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"kmSegment", "[", 
                RowBox[{"CurrentPoint", ",", "i"}], "]"}], "[", "\"\<len\>\"",
                "]"}], ">", 
              RowBox[{
               RowBox[{"kmSegment", "[", 
                RowBox[{"CurrentPoint", ",", "NextPoint"}], "]"}], "[", 
               "\"\<len\>\"", "]"}]}]}], ",", 
            RowBox[{"NextPoint", "=", "i"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"algebraicSquare", "=", 
              RowBox[{"getTriangleAlgebraicSquare", "[", 
               RowBox[{"{", 
                RowBox[{"CurrentPoint", ",", "i", ",", "NextPoint"}], "}"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"algebraicSquare", ">", "0"}], ",", 
               RowBox[{"NextPoint", "=", "i"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"Q", ",", "NextPoint"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"Q", ",", "NextPoint"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"L", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"L", ",", "NextPoint"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NextPoint", "==", "StartPoint"}], ",", 
          RowBox[{"Return", "@", "L"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CurrentPoint", "=", "NextPoint"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NextPoint", "=", 
         RowBox[{"Q", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908250927878682*^9, 3.908250994404273*^9}, {
   3.9082510299158316`*^9, 3.9082511388188243`*^9}, {3.9082515550154037`*^9, 
   3.9082516618181787`*^9}, {3.9082523212660503`*^9, 
   3.9082523734423127`*^9}, {3.9082524165369673`*^9, 
   3.9082524325683026`*^9}, {3.908252550285983*^9, 3.9082525624518995`*^9}, {
   3.9082526953347173`*^9, 3.908252705615407*^9}, {3.908252754310522*^9, 
   3.9082527572931004`*^9}, {3.908253052617037*^9, 3.9082530529345565`*^9}, {
   3.908253139753969*^9, 3.9082531414267597`*^9}, {3.9082532002973704`*^9, 
   3.9082532015049934`*^9}, {3.9082535005950212`*^9, 3.908253544019482*^9}, {
   3.9082565224663453`*^9, 3.908256577266274*^9}, {3.9082567143133326`*^9, 
   3.9082567708773975`*^9}, {3.908256802015442*^9, 3.9082568066388874`*^9}, {
   3.9082569210019875`*^9, 3.908256979214096*^9}, {3.9082574485220747`*^9, 
   3.9082574536141973`*^9}, {3.9082576907235823`*^9, 3.908257698910514*^9}, 
   3.9082578084004097`*^9, {3.9082578422863445`*^9, 3.908257844067604*^9}, {
   3.9082579278556194`*^9, 3.90825799352521*^9}, {3.9082588953480372`*^9, 
   3.908258920313446*^9}, {3.9082589545077295`*^9, 3.908258984130452*^9}, {
   3.908259062252597*^9, 3.908259078010109*^9}, {3.908259217676468*^9, 
   3.908259249017087*^9}, {3.9082593356003695`*^9, 3.908259355725422*^9}, {
   3.90825942738*^9, 3.908259449264616*^9}, {3.9082596825582685`*^9, 
   3.908259714938834*^9}, {3.9082599895548677`*^9, 3.908259990054753*^9}, 
   3.9082603529290357`*^9, {3.9082609715853815`*^9, 3.9082609878719854`*^9}, 
   3.908261076628377*^9, {3.908261431349326*^9, 3.9082614744165735`*^9}, {
   3.908261575116276*^9, 3.9082615763030753`*^9}, {3.908261612085804*^9, 
   3.908261612757522*^9}, {3.90826186547314*^9, 3.908261886116741*^9}, {
   3.9082704525190125`*^9, 3.9082705719642925`*^9}, {3.9082706221029644`*^9, 
   3.908270622431472*^9}, {3.9082706664965487`*^9, 3.908270725200473*^9}, {
   3.9082707683974133`*^9, 3.9082707687718706`*^9}, {3.9082708158505325`*^9, 
   3.9082708300293283`*^9}, {3.9082708702013597`*^9, 3.908270982207373*^9}, {
   3.9082711722114725`*^9, 3.9082711724765644`*^9}, {3.9082712697639327`*^9, 
   3.908271270170555*^9}, {3.9082713211727653`*^9, 3.9082713307214317`*^9}, {
   3.9082714852083607`*^9, 3.908271535606062*^9}, {3.908271974078084*^9, 
   3.9082719763436003`*^9}, {3.9082721812171974`*^9, 
   3.9082722055988245`*^9}, {3.908272753502487*^9, 3.9082727808832703`*^9}, {
   3.9082731935457416`*^9, 3.9082732361144753`*^9}, {3.9082734223155594`*^9, 
   3.908273428579713*^9}, {3.908273477278103*^9, 3.9082735533929453`*^9}, 
   3.9082736451881227`*^9, {3.9082739493573503`*^9, 3.9082739594093103`*^9}, {
   3.908274080214141*^9, 3.9082741140956163`*^9}, {3.908274248765647*^9, 
   3.908274313373845*^9}, {3.9082755639961405`*^9, 3.9082755645742626`*^9}, {
   3.9082756611027393`*^9, 3.90827566875465*^9}, {3.908278359090017*^9, 
   3.908278365916067*^9}, {3.9082791445321193`*^9, 3.9082792294784365`*^9}, {
   3.908279288789662*^9, 3.9082793103152866`*^9}, 3.90827936422464*^9, {
   3.9082794396529713`*^9, 3.9082795033304834`*^9}, {3.9082795631132812`*^9, 
   3.9082795879041853`*^9}, {3.908285062039118*^9, 3.908285064210516*^9}, {
   3.9082854937280703`*^9, 3.908285504721881*^9}, {3.908285563144332*^9, 
   3.9082855724394817`*^9}, {3.9082857652859726`*^9, 3.908285847124516*^9}, 
   3.9082859014609847`*^9, 3.908285935122199*^9, {3.908286502512192*^9, 
   3.908286521210315*^9}, {3.908290488897902*^9, 3.908290491808666*^9}, {
   3.9082951363397875`*^9, 3.9082951697893457`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->
  "In[214]:=",ExpressionUUID->"0103ac2f-3c37-45b6-97ac-5e3d52def9c9"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"4f263991-1209-4fee-b54e-5a10735d40d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}], "}"}], "]"}], 
    "&"}], "/@", 
   RowBox[{"Range", "[", "20", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.908195449285694*^9, {3.9081955640536375`*^9, 3.9081957044021196`*^9}, {
   3.9081966412818613`*^9, 3.908196641481228*^9}, 3.908282262894511*^9},
 CellLabel->
  "In[231]:=",ExpressionUUID->"3e44a78c-0109-4c4c-839e-21429a177844"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "4.449633319686463`"}], "5.147367382929133`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3.380750823280991`", 
       RowBox[{"-", "3.725547750165788`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "3.063030440701265`"}], 
       RowBox[{"-", "1.976627853855895`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2.859101934668601`", "6.701798978404291`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.6058907851244655`", 
       RowBox[{"-", "6.072445079124357`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.530647447477634`"}], "3.942217165368106`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.2032947134184866`", "5.602517085700391`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "2.6981106682178932`"}], 
       RowBox[{"-", "2.3294596487033346`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.006538340711153`", "7.760123549478557`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4.806487343871652`", 
       RowBox[{"-", "2.7093472914626844`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "2.25752399813139`"}], 
       RowBox[{"-", "6.758456776155818`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "5.134938288154935`"}], "3.9200873967856964`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "3.466631335168458`"}], 
       RowBox[{"-", "9.088406863994173`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.581856108176325`", "1.1880065674871823`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4.060892967281838`", "9.591614795557945`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.539125301831831`", 
       RowBox[{"-", "6.417463072664923`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4.341161676484646`", "3.7229310275269327`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.366931228879913`", "7.037624445942846`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.4195455898249776`"}], 
       RowBox[{"-", "2.982826859568817`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.89377086170073`"}], 
       RowBox[{"-", "4.695943255370324`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9082796202559476`*^9, 3.9082822666123476`*^9, 3.9082851131226697`*^9, 
   3.90828781212442*^9, 3.908290495463585*^9, 3.9082906081976547`*^9, {
   3.908295391646243*^9, 3.9082954087511034`*^9}},
 CellLabel->
  "Out[231]=",ExpressionUUID->"dcac04b3-aff3-4752-b5ac-f109fd78e32e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res1", "=", 
  RowBox[{"CH", "[", "Q1", "]"}]}]], "Input",
 CellChangeTimes->{{3.9082725239770145`*^9, 3.908272539239046*^9}, {
   3.9082741162830505`*^9, 3.9082741177358313`*^9}, {3.9082783837334614`*^9, 
   3.9082783840463457`*^9}, 3.9082822646909275`*^9, 3.9082904980567617`*^9},
 CellLabel->
  "In[232]:=",ExpressionUUID->"1020c647-999a-4f7f-8bbc-2faf708de9a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.89377086170073`"}], 
       RowBox[{"-", "4.695943255370324`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "3.466631335168458`"}], 
       RowBox[{"-", "9.088406863994173`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.539125301831831`", 
       RowBox[{"-", "6.417463072664923`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.581856108176325`", "1.1880065674871823`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.366931228879913`", "7.037624445942846`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.006538340711153`", "7.760123549478557`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4.060892967281838`", "9.591614795557945`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.530647447477634`"}], "3.942217165368106`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.89377086170073`"}], 
       RowBox[{"-", "4.695943255370324`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9082743185013123`*^9, {3.908275407781542*^9, 3.908275419106675*^9}, 
   3.9082755663077908`*^9, 3.90827567020746*^9, 3.9082757521486664`*^9, {
   3.908278367534566*^9, 3.908278396324239*^9}, 3.908279621630619*^9, 
   3.9082822675808697`*^9, 3.9082851132163982`*^9, 3.9082878168264356`*^9, 
   3.908290498447261*^9, 3.9082906090724545`*^9, {3.908295392583557*^9, 
   3.9082954095790625`*^9}},
 CellLabel->
  "Out[232]=",ExpressionUUID->"ac044b02-04b2-456c-9ae4-337b48eb0c64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointsPicture", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.02"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "]"}], "&"}], "/@", "Q1"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", "res1"}], 
       "}"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.908272362543335*^9, 3.9082723637623644`*^9}, {
   3.908272516462875*^9, 3.9082726203442764`*^9}, {3.90827268023132*^9, 
   3.9082727289863725`*^9}, {3.908274328361686*^9, 3.9082743379156103`*^9}, {
   3.908275370342991*^9, 3.908275400023144*^9}, {3.908275585421457*^9, 
   3.9082756497147055`*^9}, {3.9082757236841164`*^9, 
   3.9082757380758653`*^9}, {3.908278387092045*^9, 3.908278387498192*^9}, {
   3.908279775852665*^9, 3.908279815272338*^9}, 3.908279907787635*^9, 
   3.908282275054817*^9, 3.9082905019789424`*^9},
 CellLabel->
  "In[233]:=",ExpressionUUID->"cec75690-e8c4-4eda-ae27-8324a9828558"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[
   0.02], {PointBox[{-4.449633319686463, 5.147367382929133}], 
    PointBox[{3.380750823280991, -3.725547750165788}], 
    PointBox[{-3.063030440701265, -1.976627853855895}], 
    PointBox[{2.859101934668601, 6.701798978404291}], 
    PointBox[{1.6058907851244655`, -6.072445079124357}], 
    PointBox[{-8.530647447477634, 3.942217165368106}], 
    PointBox[{1.2032947134184866`, 5.602517085700391}], 
    PointBox[{-2.6981106682178932`, -2.3294596487033346`}], 
    PointBox[{5.006538340711153, 7.760123549478557}], 
    PointBox[{4.806487343871652, -2.7093472914626844`}], 
    PointBox[{-2.25752399813139, -6.758456776155818}], 
    PointBox[{-5.134938288154935, 3.9200873967856964`}], 
    PointBox[{-3.466631335168458, -9.088406863994173}], 
    PointBox[{6.581856108176325, 1.1880065674871823`}], 
    PointBox[{4.060892967281838, 9.591614795557945}], 
    PointBox[{6.539125301831831, -6.417463072664923}], 
    PointBox[{4.341161676484646, 3.7229310275269327`}], 
    PointBox[{5.366931228879913, 7.037624445942846}], 
    PointBox[{-1.4195455898249776`, -2.982826859568817}], 
    PointBox[{-9.89377086170073, -4.695943255370324}]}, 
   LineBox[{{{-9.89377086170073, -4.695943255370324}, {-3.466631335168458, \
-9.088406863994173}, {6.539125301831831, -6.417463072664923}, {
    6.581856108176325, 1.1880065674871823`}, {5.366931228879913, 
    7.037624445942846}, {5.006538340711153, 7.760123549478557}, {
    4.060892967281838, 9.591614795557945}, {-8.530647447477634, 
    3.942217165368106}, {-9.89377086170073, -4.695943255370324}}}]},
  ImageSize->{
    UpTo[600], 
    UpTo[412]}]], "Output",
 CellChangeTimes->{
  3.908272380070496*^9, {3.9082724297395077`*^9, 3.908272458601101*^9}, 
   3.908272517618702*^9, {3.908272575153598*^9, 3.9082725889950914`*^9}, 
   3.908272620921807*^9, {3.908272683417632*^9, 3.908272729579975*^9}, 
   3.9082732113096857`*^9, 3.9082732440182004`*^9, 3.9082733817737412`*^9, 
   3.90827349185157*^9, 3.9082739833375034`*^9, {3.9082741556147194`*^9, 
   3.9082741823409*^9}, 3.908274298861661*^9, {3.9082743295484753`*^9, 
   3.908274338384246*^9}, {3.908275400507412*^9, 3.908275420122064*^9}, {
   3.9082755676511946`*^9, 3.9082756050810337`*^9}, {3.908275638462426*^9, 
   3.9082756718789406`*^9}, {3.9082757386065297`*^9, 
   3.9082757549136095`*^9}, {3.908278369684473*^9, 3.908278397089718*^9}, 
   3.9082796242317533`*^9, {3.908279785662857*^9, 3.9082798156784954`*^9}, 
   3.908279908459422*^9, {3.9082822688618526`*^9, 3.90828227831971*^9}, 
   3.9082851133726125`*^9, 3.9082878169982834`*^9, 3.9082905026192675`*^9, 
   3.908290609791029*^9, {3.908295393302136*^9, 3.908295410328849*^9}},
 CellLabel->
  "Out[233]=",ExpressionUUID->"edb434a8-27df-4b4a-839a-e9bc437b0c1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.908282257305259*^9, 3.9082822595703783`*^9}, {
  3.908282349263899*^9, 3.9082824397305408`*^9}, {3.908282890397628*^9, 
  3.9082829766608405`*^9}, {3.9082866192449055`*^9, 3.908286635503408*^9}, {
  3.9082948637350707`*^9, 3.908294865734601*^9}, {3.908295377112959*^9, 
  3.9082953806126013`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"a0fe7fba-9ea5-4a59-ac5f-16d662fd4795"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4", "6"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{3.908282977551256*^9, 3.9082851134663377`*^9, 
  3.908286636690654*^9, 3.9082878170451703`*^9, 3.9082905078367925`*^9, 
  3.9082948664995794`*^9, 3.908295381377616*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"28c69630-acfd-4190-aad0-84aa012d72f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res2", "=", 
  RowBox[{"CH", "[", "Q2", "]"}]}]], "Input",
 CellChangeTimes->{{3.908282983541211*^9, 3.9082829920708923`*^9}, 
   3.9082905159105463`*^9},
 CellLabel->
  "In[220]:=",ExpressionUUID->"4fc8fb58-459e-4318-818b-f6c26db10d50"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4", "6"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{3.9082858587063265`*^9, 3.908285909131007*^9, 
  3.9082859412132893`*^9, 3.908286486651802*^9, 3.908286529039461*^9, 
  3.9082866428307962`*^9, 3.908287819122772*^9, 3.9082905168946824`*^9, 
  3.908294869248966*^9, 3.908295343365864*^9, 3.9082953825804195`*^9},
 CellLabel->
  "Out[220]=",ExpressionUUID->"931e6491-bc79-4d74-ad9c-80f2d16bce5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointsPicture", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.02"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "]"}], "&"}], "/@", "Q2"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", "res2"}], 
       "}"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082865739034767`*^9, 3.9082865742163258`*^9}, 
   3.9082905203342333`*^9},
 CellLabel->
  "In[221]:=",ExpressionUUID->"0f362f54-7e29-4fbf-8fa3-0023da15129d"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[
   0.02], {PointBox[{6, 3}], PointBox[{6, 5}], PointBox[{3, 5}], 
    PointBox[{6, 1}], PointBox[{1, 2}], PointBox[{1, 1}], PointBox[{3, 1}], 
    PointBox[{4, 6}], PointBox[{2, 4}], PointBox[{6, 5}], PointBox[{5, 1}], 
    PointBox[{1, 3}]}, 
   LineBox[{{{1, 1}, {6, 1}, {6, 5}, {4, 6}, {1, 3}, {1, 1}}}]}]], "Output",
 CellChangeTimes->{
  3.9082865747782326`*^9, 3.908286649641757*^9, 3.908287819200881*^9, 
   3.908290520912255*^9, 3.9082948710577483`*^9, {3.9082953378201065`*^9, 
   3.908295348563484*^9}, 3.9082953838145404`*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"b2d950f3-de56-48c9-8a9e-c98a706c7c6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2.", "Section",
 CellChangeTimes->{{3.908193991490741*^9, 3.908194002839224*^9}, {
  3.908300977453188*^9, 
  3.908300978140397*^9}},ExpressionUUID->"666ac3e7-7bfe-48bb-b1db-\
d97d9649797e"],

Cell["\<\
\:0421\:043f\:0440\:043e\:0435\:043a\:0442\:0438\:0440\:0443\:0439\:0442\:0435\
 \:0438 \:0441\:043e\:0437\:0434\:0430\:0439\:0442\:0435 \:0444\:0443\:043d\
\:043a\:0446\:0438\:0438 \:0434\:043b\:044f \:043f\:043e\:0441\:0442\:0440\
\:043e\:0435\:043d\:0438\:044f \:0432\:044b\:043f\:0443\:043a\:043b\:043e\
\:0439 \:043e\:0431\:043e\:043b\:043e\:0447\:043a\:0438 \:0437\:0430\:0434\
\:0430\:043d\:043d\:043e\:0433\:043e \:043c\:043d\:043e\:0436\:0435\:0441\
\:0442\:0432\:0430 \:0442\:043e\:0447\:0435\:043a \:043f\:043b\:043e\:0441\
\:043a\:043e\:0441\:0442\:0438 \:0441 \:0438\:0441\:043f\:043e\:043b\:044c\
\:0437\:043e\:0432\:0430\:043d\:0438\:0435\:043c \:0430\:043b\:0433\:043e\
\:0440\:0438\:0442\:043c\:0430 \:0414\:0436\:0430\:0440\:0432\:0438\:0441\
\:0430 . \:041f\:0440\:043e\:0432\:0435\:0434\:0438\:0442\:0435 \:0442\:0435\
\:0441\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:0435 .\
\>", "Text",
 CellChangeTimes->{{3.908194054615077*^9, 
  3.9081940664977617`*^9}},ExpressionUUID->"f2e65b36-a474-4fba-acef-\
c79d23e6d12c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sortByPolarAngle", "[", "points_List", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"StartPoint", "=", 
       RowBox[{"getStartPoint", "[", "points", "]"}]}], ",", 
      RowBox[{"sorted", "=", "points"}], ",", "flag"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sorted", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"sorted", ",", "StartPoint"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sorted", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"sorted", ",", "StartPoint", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"1", "<=", 
        RowBox[{"Length", "@", "sorted"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flag", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", "2"}], ",", 
          RowBox[{"j", "<", 
           RowBox[{"Length", "@", "sorted"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"isLess", "[", 
             RowBox[{"StartPoint", ",", 
              RowBox[{"sorted", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"sorted", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", "sorted", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sorted", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"sorted", ",", 
                RowBox[{"sorted", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"j", "+", "2"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sorted", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"sorted", ",", "j"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"flag", "=", "False"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "sorted", "]"}]}]}], "\[IndentingNewLine]",
            "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"flag", ",", "Break"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "sorted"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908303027458833*^9, 3.9083031146139727`*^9}, {
  3.908303957460945*^9, 3.908304290425764*^9}, {3.908304432294958*^9, 
  3.9083045480892644`*^9}, {3.9083384030960875`*^9, 3.908338426519901*^9}, {
  3.9083384712119856`*^9, 3.9083385231252794`*^9}, {3.908338555320693*^9, 
  3.9083386191303835`*^9}, {3.9083431242275124`*^9, 3.908343218037817*^9}, {
  3.908343282320024*^9, 3.908343307641384*^9}, {3.908343414488595*^9, 
  3.9083434202684875`*^9}, {3.9083434954207478`*^9, 3.9083435426464615`*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"8dd92e2e-5006-42de-b9ab-2f0c2aa208c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getStartPoint", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"9", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.90833732448966*^9, 3.9083373413247485`*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"d33f7eeb-e09f-4cf3-93a6-7b8c5ce78f78"],

Cell[BoxData[
 TemplateBox[{"\"Point\"", "\"(\"", 
   TemplateBox[{",", "\",\"", 
     RowBox[{"-", "6"}], 
     RowBox[{"-", "1"}]}, "RowWithSeparators"], "\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{3.908337341871487*^9, 3.908343570949587*^9},
 CellLabel->
  "Out[270]=",ExpressionUUID->"a9912791-399b-40b6-a4e6-39e1c08d499e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"isLess", "[", 
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "6"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"9", ",", "4"}], "}"}], "]"}], ",", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.908337422071432*^9, 3.908337468145481*^9}, {
  3.908337752867025*^9, 3.9083377554137588`*^9}, {3.908337803086449*^9, 
  3.9083378054921403`*^9}, {3.908337883938208*^9, 3.9083379170211086`*^9}, {
  3.9083379501598997`*^9, 3.9083379784396076`*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"f0e50409-264b-4d10-8090-802a3372210a"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.9083374687387743`*^9, 3.908337515434605*^9, 3.9083377567572927`*^9, 
   3.9083378060227957`*^9, {3.908337937515852*^9, 3.9083379787676473`*^9}, 
   3.90834357185515*^9},
 CellLabel->
  "Out[271]=",ExpressionUUID->"9e7c0cfe-0baa-47ee-9a00-0755aaf8260f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sortByPolarAngle", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"9", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9083045242890606`*^9, 3.9083045249763947`*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"6d71e66d-bf53-4380-9ce1-e221afa8f98c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6"}], 
       RowBox[{"-", "1"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Print",
 CellChangeTimes->{{3.9083385795805473`*^9, 3.908338622415305*^9}, 
   3.908343338380771*^9, 3.908343383095522*^9, 3.9083435728705387`*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"144046e4-2fe1-4798-b814-e194d74a5afe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6"}], 
       RowBox[{"-", "1"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Print",
 CellChangeTimes->{{3.9083385795805473`*^9, 3.908338622415305*^9}, 
   3.908343338380771*^9, 3.908343383095522*^9, 3.9083435728861933`*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"5f6f66b8-6cda-4a46-89bd-b60a2609105e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6"}], 
       RowBox[{"-", "1"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Print",
 CellChangeTimes->{{3.9083385795805473`*^9, 3.908338622415305*^9}, 
   3.908343338380771*^9, 3.908343383095522*^9, 3.90834357290178*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"36024372-3c4b-438a-9429-a84368a9056f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6"}], 
       RowBox[{"-", "1"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Print",
 CellChangeTimes->{{3.9083385795805473`*^9, 3.908338622415305*^9}, 
   3.908343338380771*^9, 3.908343383095522*^9, 3.9083435729173985`*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"4c90ea89-6c65-4d87-938c-537b005b5b4e"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.9083045496357408`*^9, 3.908337518012684*^9, 3.908338534482178*^9, {
   3.908338579720767*^9, 3.9083386225871716`*^9}, {3.9083433756910124`*^9, 
   3.9083433998027387`*^9}, 3.908343897882674*^9},
 CellLabel->
  "Out[272]=",ExpressionUUID->"98042e9d-60dd-4c17-a853-8f2280cc89ff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"isLess", "[", 
   RowBox[{
   "StartPoint_kmPoint", ",", "Point1_kmPoint", ",", "Point2_kmPoint"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"getTriangleAlgebraicSquare", "[", 
     RowBox[{"{", 
      RowBox[{"StartPoint", ",", "Point2", ",", "Point1"}], "}"}], "]"}], ">",
     "0"}], "||", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"isPointOnLine", "[", 
      RowBox[{
       RowBox[{"kmLine", "[", 
        RowBox[{"{", 
         RowBox[{"StartPoint", ",", "Point1"}], "}"}], "]"}], ",", "Point2"}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"kmSegment", "[", 
        RowBox[{"StartPoint", ",", "Point2"}], "]"}], "[", "\"\<len\>\"", 
       "]"}], ">", 
      RowBox[{
       RowBox[{"kmSegment", "[", 
        RowBox[{"StartPoint", ",", "Point1"}], "]"}], "[", "\"\<len\>\"", 
       "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9083033642488112`*^9, 3.9083034144311733`*^9}, {
  3.9083035218293686`*^9, 3.9083035618182135`*^9}, {3.908303593367758*^9, 
  3.90830364941908*^9}, {3.9083375083894024`*^9, 3.9083375117636533`*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"a9d3f6cb-5207-474d-b4bb-03878834329f"]
}, Open  ]]
},
WindowSize->{1152, 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8c90ee3c-e8e9-41cd-9906-120e8a0de721"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 190, 3, 59, "Section",ExpressionUUID->"8ee7ed7f-4584-47c6-b154-b36cb2931704"],
Cell[773, 27, 1053, 16, 52, "Text",ExpressionUUID->"999f711a-b7c3-416d-8cda-0eb80c502ab1"],
Cell[1829, 45, 4027, 75, 143, "Input",ExpressionUUID->"16162efc-264d-43bd-8d73-7f94a9cd664c"],
Cell[5859, 122, 3731, 108, 263, "Input",ExpressionUUID->"ec09dff8-3ab6-4d09-9e09-a4e23f250f03"],
Cell[9593, 232, 5197, 145, 400, "Input",ExpressionUUID->"286e5e4f-b637-4c69-80c1-575982b2725b"],
Cell[14793, 379, 11580, 339, 547, "Input",ExpressionUUID->"f601de5c-989f-40cb-93b5-75768e8dae96"],
Cell[26376, 720, 13157, 346, 574, "Input",ExpressionUUID->"2c7bdca1-d923-4ee2-8ff1-2b99ebfbd0a5"],
Cell[CellGroupData[{
Cell[39558, 1070, 704, 20, 25, "Input",ExpressionUUID->"508b7830-4ff7-44ed-848b-6a92855c34a8"],
Cell[40265, 1092, 4785, 100, 81, "Output",ExpressionUUID->"7adef4fa-ac9c-4f21-a2a1-bd60d029e042"]
}, Open  ]],
Cell[45065, 1195, 1067, 31, 55, "Input",ExpressionUUID->"7f6eac22-11d6-4258-81ab-7bc34c95371d"],
Cell[46135, 1228, 972, 22, 44, "Input",ExpressionUUID->"cd9ec9c2-2ebb-411b-bbb0-2cdb4664ae0a"],
Cell[47110, 1252, 393, 7, 39, "Input",ExpressionUUID->"7617d9e4-2851-4260-b9c4-aa86a84cdc0a"],
Cell[47506, 1261, 537, 11, 39, "Input",ExpressionUUID->"ad5aa6db-08c4-47dd-a63f-0046f27d91ef"],
Cell[48046, 1274, 455, 6, 31, "Text",ExpressionUUID->"5fd0810c-3332-4a85-b3cb-2308a9bc5015"],
Cell[48504, 1282, 2712, 65, 297, "Input",ExpressionUUID->"6f6cabf9-2779-401e-826e-2824ac168cab"],
Cell[51219, 1349, 746, 14, 39, "Input",ExpressionUUID->"2478a258-7b3c-4f6b-84a0-96d971fd7f4c"],
Cell[51968, 1365, 2900, 76, 75, "Input",ExpressionUUID->"b308d98b-f4d8-4e73-ae8b-5bc190bd1758"],
Cell[54871, 1443, 7343, 135, 468, "Input",ExpressionUUID->"0103ac2f-3c37-45b6-97ac-5e3d52def9c9"],
Cell[62217, 1580, 279, 4, 45, "Text",ExpressionUUID->"4f263991-1209-4fee-b54e-5a10735d40d3"],
Cell[CellGroupData[{
Cell[62521, 1588, 731, 21, 25, "Input",ExpressionUUID->"3e44a78c-0109-4c4c-839e-21429a177844"],
Cell[63255, 1611, 4328, 97, 81, "Output",ExpressionUUID->"dcac04b3-aff3-4752-b5ac-f109fd78e32e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67620, 1713, 389, 7, 25, "Input",ExpressionUUID->"1020c647-999a-4f7f-8bbc-2faf708de9a8"],
Cell[68012, 1722, 2327, 51, 47, "Output",ExpressionUUID->"ac044b02-04b2-456c-9ae4-337b48eb0c64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70376, 1778, 1129, 26, 25, "Input",ExpressionUUID->"cec75690-e8c4-4eda-ae27-8324a9828558"],
Cell[71508, 1806, 2770, 48, 386, "Output",ExpressionUUID->"edb434a8-27df-4b4a-839a-e9bc437b0c1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74315, 1859, 1668, 46, 43, "Input",ExpressionUUID->"a0fe7fba-9ea5-4a59-ac5f-16d662fd4795"],
Cell[75986, 1907, 1992, 43, 28, "Output",ExpressionUUID->"28c69630-acfd-4190-aad0-84aa012d72f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78015, 1955, 261, 6, 25, "Input",ExpressionUUID->"4fc8fb58-459e-4318-818b-f6c26db10d50"],
Cell[78279, 1963, 1251, 26, 28, "Output",ExpressionUUID->"931e6491-bc79-4d74-ad9c-80f2d16bce5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79567, 1994, 684, 20, 25, "Input",ExpressionUUID->"0f362f54-7e29-4fbf-8fa3-0023da15129d"],
Cell[80254, 2016, 662, 13, 338, "Output",ExpressionUUID->"b2d950f3-de56-48c9-8a9e-c98a706c7c6e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80965, 2035, 239, 4, 59, "Section",ExpressionUUID->"666ac3e7-7bfe-48bb-b1db-d97d9649797e"],
Cell[81207, 2041, 1053, 16, 52, "Text",ExpressionUUID->"f2e65b36-a474-4fba-acef-c79d23e6d12c"],
Cell[82263, 2059, 3350, 74, 386, "Input",ExpressionUUID->"8dd92e2e-5006-42de-b9ab-2f0c2aa208c2"],
Cell[CellGroupData[{
Cell[85638, 2137, 784, 23, 25, "Input",ExpressionUUID->"d33f7eeb-e09f-4cf3-93a6-7b8c5ce78f78"],
Cell[86425, 2162, 340, 8, 28, "Output",ExpressionUUID->"a9912791-399b-40b6-a4e6-39e1c08d499e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86802, 2175, 746, 19, 25, "Input",ExpressionUUID->"f0e50409-264b-4d10-8090-802a3372210a"],
Cell[87551, 2196, 309, 6, 28, "Output",ExpressionUUID->"9e7c0cfe-0baa-47ee-9a00-0755aaf8260f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87897, 2207, 790, 23, 25, "Input",ExpressionUUID->"6d71e66d-bf53-4380-9ce1-e221afa8f98c"],
Cell[CellGroupData[{
Cell[88712, 2234, 1039, 24, 19, "Print",ExpressionUUID->"144046e4-2fe1-4798-b814-e194d74a5afe"],
Cell[89754, 2260, 1039, 24, 19, "Print",ExpressionUUID->"5f6f66b8-6cda-4a46-89bd-b60a2609105e"],
Cell[90796, 2286, 1036, 24, 19, "Print",ExpressionUUID->"36024372-3c4b-438a-9429-a84368a9056f"],
Cell[91835, 2312, 1039, 24, 19, "Print",ExpressionUUID->"4c90ea89-6c65-4d87-938c-537b005b5b4e"]
}, Open  ]],
Cell[92889, 2339, 337, 6, 28, "Output",ExpressionUUID->"98042e9d-60dd-4c17-a853-8f2280cc89ff"]
}, Open  ]],
Cell[93241, 2348, 1228, 33, 60, "Input",ExpressionUUID->"a9d3f6cb-5207-474d-b4bb-03878834329f"]
}, Open  ]]
}
]
*)

