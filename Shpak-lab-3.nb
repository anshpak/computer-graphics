(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    114639,       2785]
NotebookOptionsPosition[    109016,       2692]
NotebookOutlinePosition[    109482,       2710]
CellTagsIndexPosition[    109439,       2707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 1.", "Section",
 CellChangeTimes->{{3.908193991490741*^9, 
  3.908194002839224*^9}},ExpressionUUID->"8ee7ed7f-4584-47c6-b154-\
b36cb2931704"],

Cell["\<\
\:0421\:043f\:0440\:043e\:0435\:043a\:0442\:0438\:0440\:0443\:0439\:0442\:0435\
 \:0438 \:0441\:043e\:0437\:0434\:0430\:0439\:0442\:0435 \:0444\:0443\:043d\
\:043a\:0446\:0438\:0438 \:0434\:043b\:044f \:043f\:043e\:0441\:0442\:0440\
\:043e\:0435\:043d\:0438\:044f \:0432\:044b\:043f\:0443\:043a\:043b\:043e\
\:0439 \:043e\:0431\:043e\:043b\:043e\:0447\:043a\:0438 \:0437\:0430\:0434\
\:0430\:043d\:043d\:043e\:0433\:043e \:043c\:043d\:043e\:0436\:0435\:0441\
\:0442\:0432\:0430 \:0442\:043e\:0447\:0435\:043a \:043f\:043b\:043e\:0441\
\:043a\:043e\:0441\:0442\:0438 \:0441 \:0438\:0441\:043f\:043e\:043b\:044c\
\:0437\:043e\:0432\:0430\:043d\:0438\:0435\:043c \:0430\:043b\:0433\:043e\
\:0440\:0438\:0442\:043c\:0430 \:0414\:0436\:0430\:0440\:0432\:0438\:0441\
\:0430 . \:041f\:0440\:043e\:0432\:0435\:0434\:0438\:0442\:0435 \:0442\:0435\
\:0441\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:0435 .\
\>", "Text",
 CellChangeTimes->{{3.908194054615077*^9, 
  3.9081940664977617`*^9}},ExpressionUUID->"999f711a-b7c3-416d-8cda-\
0eb80c502ab1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"NamedQ", ",", "\[GothicK]\[GothicM]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[GothicK]\[GothicM]", "::", "usage"}], "=", 
   "\"\<Knowledge base \[LeftGuillemet]computer \
mathematics\[RightGuillemet]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"\[GothicK]\[GothicM]", ",", 
    RowBox[{"{", 
     RowBox[{"Protected", ",", "ReadProtected"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "::", "usage"}], "=", 
   "\"\<Check: is there a name of tested equations\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"n1_", ",", "n2__"}], "]"}], ":=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"NamedQ", "[", "n1", "]"}], ",", 
     RowBox[{"NamedQ", "[", "n2", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"NamedQ", ",", "Listable"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.690794992403058*^9, 3.6907950310873785`*^9}, {
   3.6908843882251835`*^9, 3.690884505856181*^9}, {3.6908846097825623`*^9, 
   3.6908846204600935`*^9}, {3.6908851707345686`*^9, 3.690885189421761*^9}, {
   3.690885248622609*^9, 3.690885266162938*^9}, {3.690885297959387*^9, 
   3.6908853003290596`*^9}, {3.6908853495988426`*^9, 3.690885357912713*^9}, {
   3.690885425150182*^9, 3.6908855152097607`*^9}, 3.6908856863125563`*^9, {
   3.6910553673987675`*^9, 3.6910554440588427`*^9}, {3.691055759975873*^9, 
   3.6910557646421666`*^9}, {3.6910557953308516`*^9, 
   3.6910558052688613`*^9}, {3.6910571930455256`*^9, 3.691057228129295*^9}, {
   3.6910573506928344`*^9, 3.6910573774560704`*^9}, 3.6910576910021176`*^9, {
   3.6914831461963997`*^9, 3.691483217152506*^9}, {3.6914838378740425`*^9, 
   3.691483842954578*^9}, {3.6914841790840755`*^9, 3.6914842060151005`*^9}, {
   3.691484255964369*^9, 3.691484308725642*^9}, {3.6914845063919625`*^9, 
   3.6914845071945424`*^9}, {3.69434039018277*^9, 3.694340502302164*^9}, {
   3.6943405533833623`*^9, 3.6943406466564827`*^9}, {3.6943409639572678`*^9, 
   3.694340968589549*^9}, {3.694341017695356*^9, 3.6943411035181704`*^9}, {
   3.696527247175319*^9, 3.6965272674873896`*^9}, 3.6965273138255253`*^9, {
   3.6965273615373993`*^9, 3.696527376755241*^9}, {3.69655510758998*^9, 
   3.6965552164478436`*^9}, {3.6965571661798143`*^9, 3.696557253853815*^9}, {
   3.696557292956991*^9, 3.6965573605427628`*^9}, {3.696558180263235*^9, 
   3.6965582440903544`*^9}, {3.6965583228056045`*^9, 
   3.6965583244067326`*^9}, {3.696559034465626*^9, 3.6965590354423246`*^9}, {
   3.696559261869051*^9, 3.696559292198389*^9}, {3.696559424453185*^9, 
   3.6965597066890697`*^9}, {3.69656108443996*^9, 3.6965611840235605`*^9}, {
   3.699846757775649*^9, 3.6998467603900304`*^9}, {3.6998478401435823`*^9, 
   3.699847843066986*^9}, {3.699867641692709*^9, 3.6998677591126623`*^9}, {
   3.6998690125200963`*^9, 3.6998690730458527`*^9}, 3.6998691223852415`*^9, 
   3.6998704309808755`*^9, {3.6998908518565655`*^9, 3.6998908741894794`*^9}, 
   3.6998911478080683`*^9, {3.699892062435873*^9, 3.6998920849038467`*^9}, {
   3.6998986854257493`*^9, 3.699898716756649*^9}, 3.699898932473677*^9, {
   3.6999026922242355`*^9, 3.699902707845271*^9}, {3.699902776288621*^9, 
   3.69990290528961*^9}, 3.699902958669608*^9, 3.699902996994115*^9, {
   3.6999493396563025`*^9, 3.6999495516970167`*^9}, {3.905153834663835*^9, 
   3.905153887263437*^9}, {3.9051539254097486`*^9, 3.9051539401716366`*^9}, {
   3.9051541956496224`*^9, 3.90515420030477*^9}, 3.9082601425336275`*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[1]:=",ExpressionUUID->"16162efc-264d-43bd-8d73-7f94a9cd664c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmPoint", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmPoint", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "::", "usage"}], "=", "\"\<Point on the surface\>\""}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}], 
     "]"}], "[", "\"\<coord\>\"", "]"}], ":=", "coord"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmPoint", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Point\>\"", ",", 
      "id"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"coord", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coord"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"coord", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmPoint", "[", 
    RowBox[{"{", 
     RowBox[{"L1_kmLine", ",", "L2_kmLine"}], "}"}], "]"}], ":=", 
   RowBox[{"kmPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"First", "@", 
       RowBox[{"NSolve", "@", 
        RowBox[{"Through", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"L1", ",", "L2"}], "}"}], "@", "\"\<equ\>\""}], "]"}]}]}], 
      ")"}]}], "]"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{"P_kmPoint", ",", "StandardForm"}], "]"}], ":=", 
   RowBox[{"Row", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P", "[", "\"\<id\>\"", "]"}], ",", "\"\<(\>\"", ",", 
      RowBox[{"Row", "[", 
       RowBox[{
        RowBox[{"P", "[", "\"\<coord\>\"", "]"}], ",", "\"\<,\>\""}], "]"}], 
      ",", "\"\<)\>\""}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.907599406479768*^9, 3.9075994074788437`*^9}, {
  3.9075998596210737`*^9, 3.9075998623707933`*^9}, {3.907600755005046*^9, 
  3.907600757670816*^9}, {3.9076055006551104`*^9, 3.907605501604168*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[7]:=",ExpressionUUID->"ec09dff8-3ab6-4d09-9e09-a4e23f250f03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "kmVector", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
    "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"kmVector", ",", "ReadProtected"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "::", "usage"}], "=", 
    "\"\<Vector on the surface\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
   " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamedQ", "[", 
    RowBox[{"kmVector", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "]"}], "^:=", 
   RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
    "[", "\"\<id\>\"", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Vector\>\"", ",", 
     "id"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{
     "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}], 
     "]"}], "[", "\"\<coord\>\"", "]"}], ":=", "coord"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmVector", "[", 
      RowBox[{
      "\[GothicK]\[GothicM]", ",", "_String", ",", "coord_List", ",", "___"}],
       "]"}], "[", "\"\<norm\>\"", "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"coord", "*", "coord"}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", 
    "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", 
    RowBox[{"id_String", ",", "coord_List"}], "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", "coord_List", "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "coord"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmVector", "[", 
    RowBox[{"id_String", ",", "P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
   RowBox[{"kmVector", "[", 
    RowBox[{"id", ",", 
     RowBox[{
      RowBox[{"P1", "@", "\"\<coord\>\""}], "-", 
      RowBox[{"P0", "@", "\"\<coord\>\""}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmVector", "[", 
     RowBox[{"P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
    RowBox[{"kmVector", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NamedQ", "[", 
         RowBox[{"P0", ",", "P1"}], "]"}], ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"P0", "@", "\"\<id\>\""}], ",", 
          RowBox[{"P1", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
       "]"}], ",", "P0", ",", "P1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}],
    " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"V_kmVector", ",", "StandardForm"}], "]"}], "^:=", 
   RowBox[{"TemplateBox", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V", "@", "\"\<id\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"RowBox", "@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MakeBoxes", "[", 
             RowBox[{"#", ",", "StandardForm"}], "]"}], "&"}], "/@", 
           RowBox[{"V", "[", "\"\<coord\>\"", "]"}]}], ",", "\"\<,\>\""}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\"\<Point2D\>\"", ",",
      "\[IndentingNewLine]", 
     RowBox[{"DisplayFunction", "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"OverscriptBox", "[", 
            RowBox[{"#1", ",", "\"\<\[RightVector]\>\""}], "]"}], ",", 
           "\"\<(\>\"", ",", "#2", ",", "\"\<)\>\""}], "}"}]}], "&"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"InterpretationFunction", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RowBox", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<{\>\"", ",", "#2", ",", "\"\<}\>\""}], "}"}]}], "&"}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Tooltip", "\[Rule]", "Automatic"}]}], "]"}]}], ";"}]}], "Input",
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[17]:=",ExpressionUUID->"286e5e4f-b637-4c69-80c1-575982b2725b"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "kmLine", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
     "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ",
     "**)"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"kmLine", ",", "ReadProtected"}], "]"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "::", "usage"}], "=", "\"\<Line on the surface\>\""}], 
    ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
    " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"NamedQ", "[", 
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "]"}], "^:=", 
    RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Line\>\"", ",", 
      "id"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{
      "\[GothicK]\[GothicM]", ",", "_String", ",", "coef_List", ",", "___"}], 
      "]"}], "[", "\"\<coef\>\"", "]"}], ":=", "coef"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"kmLine", "[", 
       RowBox[{
       "\[GothicK]\[GothicM]", ",", "_String", ",", "coef_List", ",", "___"}],
        "]"}], "[", 
      RowBox[{"\"\<equ\>\"", ",", 
       RowBox[{"vars", ":", 
        RowBox[{"{", 
         RowBox[{"_Symbol", ",", "_Symbol"}], "}"}], ":", 
        RowBox[{"{", 
         RowBox[{"\[FormalX]", ",", "\[FormalY]"}], "}"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coef", ".", 
       RowBox[{"Append", "[", 
        RowBox[{"vars", ",", "1"}], "]"}]}], "\[Equal]", "0"}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{
      RowBox[{"equ", ":", 
       RowBox[{"(", 
        RowBox[{"__", "\[Equal]", "0"}], ")"}]}], ",", 
      RowBox[{"vars", ":", 
       RowBox[{"{", 
        RowBox[{"_Symbol", ",", "_Symbol"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\"\<\>\"", ",", "equ", ",", "vars"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"A_.", " ", "x_"}], "+", 
        RowBox[{"B_.", "y_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_Symbol", ",", "y_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"kmLine", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}], "/;", 
     RowBox[{"\[Not]", 
      RowBox[{"PossibleZeroQ", "[", 
       RowBox[{
        RowBox[{"Abs", "@", "A"}], "+", 
        RowBox[{"Abs", "@", "B"}]}], "]"}]}]}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"A_.", " ", "x_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_Symbol", ",", "_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "0", ",", "C"}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"B_.", " ", "y_"}], "+", "C_."}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"_Symbol", ",", "y_Symbol"}], "}"}]}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "B", ",", "C"}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"id_String", ",", "P_kmPoint", ",", "Dir_kmVector"}], "]"}], ":=", 
    RowBox[{"kmLine", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"-", 
           RowBox[{"#", ".", 
            RowBox[{"P", "[", "\"\<coord\>\"", "]"}]}]}]}], "]"}], "&"}], "[", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"0", 
            RowBox[{"-", "1"}]},
           {"1", "0"}
          }], ")"}], ".", 
        RowBox[{"Dir", "[", "\"\<coord\>\"", "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmLine", "[", 
     RowBox[{"P_kmPoint", ",", "Dir_kmVector"}], "]"}], ":=", 
    RowBox[{"kmLine", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NamedQ", "[", 
         RowBox[{"P", ",", "Dir"}], "]"}], ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"P", "@", "\"\<id\>\""}], ",", 
          RowBox[{"Dir", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
       "]"}], ",", "P", ",", "Dir"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"kmLine", "[", 
    RowBox[{"id_String", ",", "P1_kmPoint", ",", "P2_kmPoint"}], "]"}], ":=", 
   RowBox[{"kmLine", "[", 
    RowBox[{"id", ",", "P1", ",", 
     RowBox[{"kmVector", "[", 
      RowBox[{"\"\<\>\"", ",", "P1", ",", "P2"}], "]"}]}], "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"kmLine", "[", 
    RowBox[{"{", 
     RowBox[{"P1_kmPoint", ",", "P2_kmPoint"}], "}"}], "]"}], ":=", 
   RowBox[{"kmLine", "[", 
    RowBox[{"P1", ",", 
     RowBox[{"kmVector", "[", 
      RowBox[{
       RowBox[{"P2", "@", "\"\<id\>\""}], ",", "P1", ",", "P2"}], "]"}]}], 
    "]"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmLine", "[", 
   RowBox[{"id_String", ",", "segment_kmSegment"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"x2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"y2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"kmLine", "[", 
     RowBox[{"id", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}], "x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}], "y"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x1", "*", "y2"}], "-", 
          RowBox[{"x2", "*", "y1"}]}], ")"}]}], "==", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmLine", "[", "segment_kmSegment", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end1Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"x2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"segment", "[", "\"\<end2Coord\>\"", "]"}], ")"}], "[", 
          "\"\<coord\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"kmLine", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"y1", "-", "y2"}], ")"}], "x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x1"}], ")"}], "y"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x1", "*", "y2"}], "-", 
           RowBox[{"x2", "*", "y1"}]}], ")"}]}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}], " ", 
    "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{"L_kmLine", ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "@", "\"\<id\>\""}], ",", "\"\<: \>\"", ",", 
       RowBox[{"L", "@", "\"\<equ\>\""}]}], "}"}]}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]]}], "Input",
 CellChangeTimes->{{3.907585689627097*^9, 3.907585692343799*^9}, {
   3.9076005643124437`*^9, 3.9076005646295414`*^9}, 3.9076054145176597`*^9, {
   3.907659283005635*^9, 3.907659287691595*^9}, {3.907659346245527*^9, 
   3.9076594479527273`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[29]:=",ExpressionUUID->"f601de5c-989f-40cb-93b5-75768e8dae96"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"ClearAll", "[", "kmSegment", "]"}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "\:0410\:0442\:0440\:0438\:0431\:0443\:0442\:044b", " ", 
     "\:0438", " ", "\:043e\:043f\:0438\:0441\:0430\:043d\:0438\:0435"}], " ",
     "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"kmSegment", ",", "ReadProtected"}], "]"}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmLine", "::", "usage"}], "=", 
     "\"\<\:041e\:0442\:0440\:0435\:0437\:043e\:043a \:043d\:0430 \
\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "\:0421\:0432\:043e\:0439\:0441\:0442\:0432\:0430"}], 
    " ", "**)"}]}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"NamedQ", "[", 
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "]"}], "^:=", 
    RowBox[{"id", "\[NotEqual]", "\"\<\>\""}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", "___"}], "]"}], 
     "[", "\"\<id\>\"", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[Equal]", "\"\<\>\""}], ",", "\"\<Segment\>\"", ",", 
      "id"}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<coords\>\"", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"kmPoint", "[", "#", "]"}], "&"}], "/@", "endCoords"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<end1Coord\>\"", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"x2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "<", "x2"}], "||", 
         RowBox[{"y1", "<", "y2"}]}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], "]"}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
       RowBox[{"endCoords", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
     "\"\<end2Coord\>\"", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y1", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"x2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"y2", "=", 
         RowBox[{"endCoords", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "<", "x2"}], "||", 
         RowBox[{"y1", "<", "y2"}]}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}], "]"}], ",", 
        RowBox[{"kmPoint", "[", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"\[GothicK]\[GothicM]", ",", "id_String", ",", 
      RowBox[{"endCoords", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], "[", 
    "\"\<len\>\"", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Plus", "@@", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"endCoords", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"endCoords", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}], "]"}]}], 
  "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:041a\:043e\:043d\:0441\:0442\:0440\:0443\:043a\:0442\:043e\:0440\:044b\
"}], " ", "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmSegment", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"endsCoords", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "id", ",", "endsCoords"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"kmSegment", "[", 
    RowBox[{"endsCoords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"kmSegment", "[", 
    RowBox[{"\[GothicK]\[GothicM]", ",", "\"\<\>\"", ",", "endsCoords"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"kmSegment", "[", 
     RowBox[{"id_String", ",", "P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
    RowBox[{"kmSegment", "[", 
     RowBox[{"id", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"P1", "@", "\"\<coord\>\""}], ",", 
        RowBox[{"P0", "@", "\"\<coord\>\""}]}], "}"}]}], "]"}]}], ";"}],
  Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"kmSegment", "[", 
      RowBox[{"P0_kmPoint", ",", "P1_kmPoint"}], "]"}], ":=", 
     RowBox[{"kmSegment", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NamedQ", "[", 
          RowBox[{"P0", ",", "P1"}], "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"P0", "@", "\"\<id\>\""}], ",", 
           RowBox[{"P1", "@", "\"\<id\>\""}]}], "]"}], ",", "\"\<\>\""}], 
        "]"}], ",", "P0", ",", "P1"}], "]"}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", " ", 
     "\:0414\:0435\:043a\:043e\:0440\:0430\:0442\:043e\:0440\:044b"}], " ", 
    "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{"Segment_kmSegment", ",", "StandardForm"}], "]"}], ":=", 
     RowBox[{"Row", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Segment", "@", "\"\<id\>\""}], ",", "\"\<: \>\"", ",", 
        RowBox[{"Segment", "@", "\"\<coords\>\""}]}], "}"}]}]}], ";"}],
   Background->RGBColor[0.88, 1, 0.88]], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
    "*", "\:041e\:0442\:043e\:0431\:0440\:0430\:0436\:0435\:043d\:0438\:0435",
      " ", "\:043e\:0442\:0440\:0435\:0437\:043a\:0430", " ", "\:043d\:0430", 
     " ", "\:0440\:0438\:0441\:0443\:043d\:043a\:0435"}], "**)"}],
   Background->RGBColor[0.88, 1, 0.88]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "kmGraphics2D", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmGraphics2D", "[", 
    RowBox[{"gp_List", ",", "opts___"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"gp", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P_kmPoint", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{
            RowBox[{"Point", "@", 
             RowBox[{"P", "@", "\"\<coord\>\""}]}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"P", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"L_kmLine", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"InfiniteLine", "@", 
             RowBox[{"Through", "@", 
              RowBox[{
               RowBox[{"getTwoLinePoints", "[", "L", "]"}], "@", 
               "\"\<coord\>\""}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Format", "[", 
               RowBox[{"L", ",", "StandardForm"}], "]"}], ",", "Large"}], 
             "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Segment_kmSegment", "\[RuleDelayed]", 
          RowBox[{"Tooltip", "[", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Segment", "@", "\"\<end1Coord\>\""}], ",", 
              RowBox[{"Segment", "@", "\"\<end2Coord\>\""}]}], "}"}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "opts"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9046685125381203`*^9, 3.904668536751914*^9}, {
   3.9046690203567905`*^9, 3.9046690368542547`*^9}, {3.9046693933418837`*^9, 
   3.904669417588151*^9}, {3.90466978882434*^9, 3.904669792239921*^9}, 
   3.9046699658807673`*^9, {3.904670081023004*^9, 3.904670099611061*^9}, {
   3.904670300458583*^9, 3.904670308740033*^9}, {3.9046703658050957`*^9, 
   3.9046704147201924`*^9}, {3.9046704915499024`*^9, 3.904670492066557*^9}, {
   3.904670527895545*^9, 3.9046705281946983`*^9}, {3.904670709404814*^9, 
   3.9046707176680346`*^9}, {3.904671051060985*^9, 3.904671106870425*^9}, {
   3.904671215788891*^9, 3.904671218672679*^9}, {3.904672152718809*^9, 
   3.904672173016215*^9}, 3.9046722258427725`*^9, {3.904672267404024*^9, 
   3.9046723281286473`*^9}, {3.9046726016768165`*^9, 
   3.9046727633401175`*^9}, {3.9046733567087173`*^9, 3.904673396471535*^9}, {
   3.90467343201515*^9, 3.9046734527471523`*^9}, {3.904673523920989*^9, 
   3.90467363662348*^9}, {3.9046737131297865`*^9, 3.9046737413094463`*^9}, {
   3.9046740510152445`*^9, 3.904674065017725*^9}, 3.9046741210439873`*^9, {
   3.9046756920067773`*^9, 3.904675698589094*^9}, {3.9048117579284134`*^9, 
   3.90481176882706*^9}, {3.9048125182158003`*^9, 3.9048126541989794`*^9}, {
   3.9048137538510246`*^9, 3.9048137635669937`*^9}, {3.9048138138438115`*^9, 
   3.9048138213761215`*^9}, {3.905155636458993*^9, 3.9051556385991087`*^9}, 
   3.9051571723419247`*^9, {3.9051753249562893`*^9, 3.905175325206192*^9}, {
   3.9075756017663727`*^9, 3.907575630379318*^9}, {3.9075756624088974`*^9, 
   3.907575709168853*^9}, {3.9075759093770657`*^9, 3.9075759179260125`*^9}, {
   3.907575955603362*^9, 3.907575962620142*^9}, {3.907576123215556*^9, 
   3.9075761247311635`*^9}, {3.907583266490574*^9, 3.907583267573224*^9}, {
   3.9082901585569887`*^9, 3.908290403729882*^9}, {3.9082904413168893`*^9, 
   3.908290452657977*^9}, 3.908295109787471*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[47]:=",ExpressionUUID->"2c7bdca1-d923-4ee2-8ff1-2b99ebfbd0a5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}], "}"}], "]"}], 
    "&"}], "/@", 
   RowBox[{"Range", "[", "20", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.908195449285694*^9, {3.9081955640536375`*^9, 3.9081957044021196`*^9}, {
   3.9081966412818613`*^9, 3.908196641481228*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"508b7830-4ff7-44ed-848b-6a92855c34a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.727922784927948`"}], 
       RowBox[{"-", "6.9217664133698165`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "3.218404592648344`"}], 
       RowBox[{"-", "7.8385619247933`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3.1122650382663934`", 
       RowBox[{"-", "5.526751673575102`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0.8286163907144264`", 
       RowBox[{"-", "8.670874834745334`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "2.576728005435541`"}], 
       RowBox[{"-", "8.42389536247087`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "3.9421846190158014`"}], 
       RowBox[{"-", "3.966646765119485`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.93900876885521`", "2.3033835386682995`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "0.547119938973573`"}], "9.232091435572457`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.978623207810436`"}], 
       RowBox[{"-", "0.8906827852861099`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.887056970837321`"}], "7.484639476489221`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.6807588527200856`", 
       RowBox[{"-", "1.6471066597275126`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9.006820696204343`", "5.985575823667737`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.135096532964511`", 
       RowBox[{"-", "7.991966337265435`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.0850624046638018`", 
       RowBox[{"-", "9.754831044676866`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.286789612053319`"}], 
       RowBox[{"-", "2.8777876663902617`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0.8861720354046412`", "8.639002871448255`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0.7480649829314743`", 
       RowBox[{"-", "6.303641053929422`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.580807343232941`", "1.531760842551808`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.675031505022602`"}], 
       RowBox[{"-", "3.3721905870193147`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6.555590734850831`"}], 
       RowBox[{"-", "9.00319209482269`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.908195449851229*^9, 3.908195581318699*^9, {3.9081956501419635`*^9, 
   3.9081957054514837`*^9}, {3.908196642130308*^9, 3.9081966483460255`*^9}, 
   3.908215800834552*^9, 3.9082158383964877`*^9, 3.9082504516403303`*^9, 
   3.9082559302100163`*^9, 3.9082571131228156`*^9, 3.908260150480048*^9, 
   3.9082603080225215`*^9, {3.908260413987914*^9, 3.908260466479351*^9}, 
   3.908260547012972*^9, 3.9082610293107843`*^9, 3.9082610910155816`*^9, {
   3.9082611725203543`*^9, 3.9082611991353865`*^9}, 3.908261250440432*^9, {
   3.908261397657208*^9, 3.9082614217261257`*^9}, 3.9082614857671213`*^9, 
   3.9082616402324924`*^9, 3.9082705779936876`*^9, 3.9082733598193665`*^9, 
   3.908273969746954*^9, 3.9082851128883514`*^9, 3.908287811733884*^9, 
   3.9083442838245955`*^9, 3.9083528356937127`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"74a2b02d-1e53-411a-96e6-85d6c09e6c92"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getTriangleAlgebraicSquare", "[", "points_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"points", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}]}]}], 
     "}"}], ",", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"Det", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "-", "a"}], ",", 
        RowBox[{"c", "-", "a"}]}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082106229389763`*^9, 3.9082106240218616`*^9}, 
   3.908211217345231*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[64]:=",ExpressionUUID->"7f6eac22-11d6-4258-81ab-7bc34c95371d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isPointOnLine", "[", 
   RowBox[{"Line_kmLine", ",", "P_kmPoint"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Line", "[", "\"\<equ\>\"", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[FormalX]", "->", 
      RowBox[{
       RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"\[FormalY]", "->", 
      RowBox[{
       RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.904815420337186*^9, 3.9048154519503098`*^9}, {
  3.9048157773468633`*^9, 3.9048157856785975`*^9}, {3.9048158648699355`*^9, 
  3.9048158724686975`*^9}, {3.9048190916991386`*^9, 3.904819148463625*^9}, {
  3.9048193710953183`*^9, 3.9048193774866447`*^9}, {3.9054223173088293`*^9, 
  3.905422323057804*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[65]:=",ExpressionUUID->"cd9ec9c2-2ebb-411b-bbb0-2cdb4664ae0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "Unequal", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.908253016716829*^9, 3.908253022385515*^9}, {
   3.908253183869872*^9, 3.9082531928622837`*^9}, {3.908253253320803*^9, 
   3.908253255554241*^9}, 3.908261363217743*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[66]:=",ExpressionUUID->"7617d9e4-2851-4260-b9c4-aa86a84cdc0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unequal", "[", 
   RowBox[{"Point1_kmPoint", ",", "Point2_kmPoint"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Point1", "[", "\"\<coord\>\"", "]"}], "!=", 
   RowBox[{"Point2", "[", "\"\<coord\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.908252917605296*^9, 3.908252975214261*^9}, {
  3.908253085625863*^9, 3.9082531090584154`*^9}, {3.9082532594325275`*^9, 
  3.9082532754652853`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[67]:=",ExpressionUUID->"ad5aa6db-08c4-47dd-a63f-0046f27d91ef"],

Cell["\:0412\:0430\:0436\:043d\:043e \:0437\:0430\:043a\:0438\:043d\:0443\
\:0442\:044c \:0441\:0442\:0430\:0440\:0442\:043e\:0432\:0443\:044e \:0442\
\:043e\:0447\:043a\:0443 \:0432 \:043a\:043e\:043d\:0435\:0446 Q.", "Text",
 CellChangeTimes->{{3.9082540997353363`*^9, 3.908254120998789*^9}, {
  3.9082559567666283`*^9, 3.9082559621871433`*^9}, {3.9082605919210663`*^9, 
  3.908260594092931*^9}},ExpressionUUID->"5fd0810c-3332-4a85-b3cb-\
2308a9bc5015"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getStartPoint", "[", "Q_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"StartPoint", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "@", "Q"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Or", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{"StartPoint", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], "==", 
              RowBox[{
               RowBox[{"StartPoint", "[", "\"\<coord\>\"", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", "\"\<coord\>\"", "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{
             RowBox[{"StartPoint", "[", "\"\<coord\>\"", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"StartPoint", "=", 
          RowBox[{"Q", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "StartPoint"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9082541463958406`*^9, 3.9082541608119807`*^9}, {
   3.9082543509537926`*^9, 3.9082543925314045`*^9}, {3.908254497201454*^9, 
   3.9082545080001445`*^9}, 3.908295367122085*^9},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[68]:=",ExpressionUUID->"6f6cabf9-2779-401e-826e-2824ac168cab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"moveToEndOfList", "[", 
   RowBox[{"lst_List", ",", "obj_"}], "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{"lst", ",", "obj"}], "]"}], ",", "obj"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082546118859673`*^9, 3.908254658730665*^9}, {
  3.9082547562006397`*^9, 3.9082547805804815`*^9}, {3.9082560025321026`*^9, 
  3.9082560180837793`*^9}, {3.9082562090188313`*^9, 3.9082562102212124`*^9}, {
  3.908256244702718*^9, 3.9082562481389503`*^9}, {3.9082563048503056`*^9, 
  3.908256324687222*^9}, {3.908256445721245*^9, 3.9082564665404234`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[69]:=",ExpressionUUID->"2478a258-7b3c-4f6b-84a0-96d971fd7f4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getParameter", "[", 
   RowBox[{"Segment_kmSegment", ",", "P_kmPoint"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"x1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"y0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end1Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"y1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Segment", "[", "\"\<end2Coord\>\"", "]"}], "[", 
         "\"\<coord\>\"", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "-", "x0"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"NSolve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y1", "-", "y0"}], ")"}], "*", "t"}], "+", "y0"}], "==", 
             RowBox[{
              RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "t"}], "]"}]}]}], ")"}], 
       "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"NSolve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x1", "-", "x0"}], ")"}], "*", "t"}], "+", "x0"}], "==", 
             RowBox[{
              RowBox[{"P", "[", "\"\<coord\>\"", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "t"}], "]"}]}]}], ")"}], 
       "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082876538960047`*^9, 3.908287747120054*^9}, {
   3.9082883697230377`*^9, 3.908288408191224*^9}, 3.9082884394935637`*^9, {
   3.9082885237745523`*^9, 3.908288565278925*^9}, {3.908288929483199*^9, 
   3.908288947703117*^9}, {3.9082893972019053`*^9, 3.9082894050750537`*^9}, {
   3.908289439903906*^9, 3.908289515266131*^9}, {3.9082895751678996`*^9, 
   3.9082896725166054`*^9}, {3.9082897974676557`*^9, 3.9082898375802894`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[70]:=",ExpressionUUID->"b308d98b-f4d8-4e73-ae8b-5bc190bd1758"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CH", "[", "pointsList_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"Q", "=", "pointsList"}], ",", "StartPoint", ",", 
      "CurrentPoint", ",", "NextPoint", ",", "algebraicSquare", ",", 
      RowBox[{"L", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StartPoint", "=", 
      RowBox[{"getStartPoint", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", "=", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"L", ",", "StartPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"moveToEndOfList", "[", 
       RowBox[{"Q", ",", "StartPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"CurrentPoint", "=", "StartPoint"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NextPoint", "=", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"NextPoint", "!=", "StartPoint"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"isPointOnLine", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"kmLine", "[", 
                RowBox[{"{", 
                 RowBox[{"CurrentPoint", ",", "NextPoint"}], "}"}], "]"}], 
               ",", "i"}], "\[IndentingNewLine]", "]"}], 
             "\[IndentingNewLine]", "&&", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"kmSegment", "[", 
                RowBox[{"CurrentPoint", ",", "i"}], "]"}], "[", "\"\<len\>\"",
                "]"}], ">", 
              RowBox[{
               RowBox[{"kmSegment", "[", 
                RowBox[{"CurrentPoint", ",", "NextPoint"}], "]"}], "[", 
               "\"\<len\>\"", "]"}]}]}], ",", 
            RowBox[{"NextPoint", "=", "i"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"algebraicSquare", "=", 
              RowBox[{"getTriangleAlgebraicSquare", "[", 
               RowBox[{"{", 
                RowBox[{"CurrentPoint", ",", "i", ",", "NextPoint"}], "}"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"algebraicSquare", ">", "0"}], ",", 
               RowBox[{"NextPoint", "=", "i"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"Q", ",", "NextPoint"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"Q", ",", "NextPoint"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"L", "=", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"L", ",", "NextPoint"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NextPoint", "==", "StartPoint"}], ",", 
          RowBox[{"Return", "@", "L"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CurrentPoint", "=", "NextPoint"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NextPoint", "=", 
         RowBox[{"Q", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908250927878682*^9, 3.908250994404273*^9}, {
   3.9082510299158316`*^9, 3.9082511388188243`*^9}, {3.9082515550154037`*^9, 
   3.9082516618181787`*^9}, {3.9082523212660503`*^9, 
   3.9082523734423127`*^9}, {3.9082524165369673`*^9, 
   3.9082524325683026`*^9}, {3.908252550285983*^9, 3.9082525624518995`*^9}, {
   3.9082526953347173`*^9, 3.908252705615407*^9}, {3.908252754310522*^9, 
   3.9082527572931004`*^9}, {3.908253052617037*^9, 3.9082530529345565`*^9}, {
   3.908253139753969*^9, 3.9082531414267597`*^9}, {3.9082532002973704`*^9, 
   3.9082532015049934`*^9}, {3.9082535005950212`*^9, 3.908253544019482*^9}, {
   3.9082565224663453`*^9, 3.908256577266274*^9}, {3.9082567143133326`*^9, 
   3.9082567708773975`*^9}, {3.908256802015442*^9, 3.9082568066388874`*^9}, {
   3.9082569210019875`*^9, 3.908256979214096*^9}, {3.9082574485220747`*^9, 
   3.9082574536141973`*^9}, {3.9082576907235823`*^9, 3.908257698910514*^9}, 
   3.9082578084004097`*^9, {3.9082578422863445`*^9, 3.908257844067604*^9}, {
   3.9082579278556194`*^9, 3.90825799352521*^9}, {3.9082588953480372`*^9, 
   3.908258920313446*^9}, {3.9082589545077295`*^9, 3.908258984130452*^9}, {
   3.908259062252597*^9, 3.908259078010109*^9}, {3.908259217676468*^9, 
   3.908259249017087*^9}, {3.9082593356003695`*^9, 3.908259355725422*^9}, {
   3.90825942738*^9, 3.908259449264616*^9}, {3.9082596825582685`*^9, 
   3.908259714938834*^9}, {3.9082599895548677`*^9, 3.908259990054753*^9}, 
   3.9082603529290357`*^9, {3.9082609715853815`*^9, 3.9082609878719854`*^9}, 
   3.908261076628377*^9, {3.908261431349326*^9, 3.9082614744165735`*^9}, {
   3.908261575116276*^9, 3.9082615763030753`*^9}, {3.908261612085804*^9, 
   3.908261612757522*^9}, {3.90826186547314*^9, 3.908261886116741*^9}, {
   3.9082704525190125`*^9, 3.9082705719642925`*^9}, {3.9082706221029644`*^9, 
   3.908270622431472*^9}, {3.9082706664965487`*^9, 3.908270725200473*^9}, {
   3.9082707683974133`*^9, 3.9082707687718706`*^9}, {3.9082708158505325`*^9, 
   3.9082708300293283`*^9}, {3.9082708702013597`*^9, 3.908270982207373*^9}, {
   3.9082711722114725`*^9, 3.9082711724765644`*^9}, {3.9082712697639327`*^9, 
   3.908271270170555*^9}, {3.9082713211727653`*^9, 3.9082713307214317`*^9}, {
   3.9082714852083607`*^9, 3.908271535606062*^9}, {3.908271974078084*^9, 
   3.9082719763436003`*^9}, {3.9082721812171974`*^9, 
   3.9082722055988245`*^9}, {3.908272753502487*^9, 3.9082727808832703`*^9}, {
   3.9082731935457416`*^9, 3.9082732361144753`*^9}, {3.9082734223155594`*^9, 
   3.908273428579713*^9}, {3.908273477278103*^9, 3.9082735533929453`*^9}, 
   3.9082736451881227`*^9, {3.9082739493573503`*^9, 3.9082739594093103`*^9}, {
   3.908274080214141*^9, 3.9082741140956163`*^9}, {3.908274248765647*^9, 
   3.908274313373845*^9}, {3.9082755639961405`*^9, 3.9082755645742626`*^9}, {
   3.9082756611027393`*^9, 3.90827566875465*^9}, {3.908278359090017*^9, 
   3.908278365916067*^9}, {3.9082791445321193`*^9, 3.9082792294784365`*^9}, {
   3.908279288789662*^9, 3.9082793103152866`*^9}, 3.90827936422464*^9, {
   3.9082794396529713`*^9, 3.9082795033304834`*^9}, {3.9082795631132812`*^9, 
   3.9082795879041853`*^9}, {3.908285062039118*^9, 3.908285064210516*^9}, {
   3.9082854937280703`*^9, 3.908285504721881*^9}, {3.908285563144332*^9, 
   3.9082855724394817`*^9}, {3.9082857652859726`*^9, 3.908285847124516*^9}, 
   3.9082859014609847`*^9, 3.908285935122199*^9, {3.908286502512192*^9, 
   3.908286521210315*^9}, {3.908290488897902*^9, 3.908290491808666*^9}, {
   3.9082951363397875`*^9, 3.9082951697893457`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[71]:=",ExpressionUUID->"0103ac2f-3c37-45b6-97ac-5e3d52def9c9"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"4f263991-1209-4fee-b54e-5a10735d40d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}], "}"}], "]"}], 
    "&"}], "/@", 
   RowBox[{"Range", "[", "20", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.908195449285694*^9, {3.9081955640536375`*^9, 3.9081957044021196`*^9}, {
   3.9081966412818613`*^9, 3.908196641481228*^9}, 3.908282262894511*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"3e44a78c-0109-4c4c-839e-21429a177844"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.9930251120855615`", 
       RowBox[{"-", "0.5586956632212612`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6.096763390001225`"}], 
       RowBox[{"-", "1.15654480565885`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.255446789660752`", 
       RowBox[{"-", "4.098433319182128`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "5.142083494931754`"}], "1.521054633570241`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.720018200519117`"}], 
       RowBox[{"-", "0.6493018940233881`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "5.322254817116164`"}], "6.940437468300928`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8.848872875184576`", 
       RowBox[{"-", "1.418782383818705`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "4.145184558118746`"}], 
       RowBox[{"-", "8.05836313371443`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.363963238875911`", "2.730683679223432`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.3935910778663612`", "9.439061690224207`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0.29928515083575036`", 
       RowBox[{"-", "7.790002532001022`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3.9289519245773263`", 
       RowBox[{"-", "2.574226064069048`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9.785661503438206`", 
       RowBox[{"-", "3.379622137120762`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "0.5903143372477189`"}], 
       RowBox[{"-", "6.828417365490758`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2.4326448216472514`", 
       RowBox[{"-", "1.147828713385067`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.465096021542429`", "1.0545449096540338`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.496602874042274`"}], 
       RowBox[{"-", "5.891786105370791`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.493493770344255`"}], "9.296174145311078`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.687254462531129`", "5.154306600896177`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "5.675417481168136`"}], "1.8279325532384227`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9082796202559476`*^9, 3.9082822666123476`*^9, 3.9082851131226697`*^9, 
   3.90828781212442*^9, 3.908290495463585*^9, 3.9082906081976547`*^9, {
   3.908295391646243*^9, 3.9082954087511034`*^9}, 3.90834429537714*^9, 
   3.908352836209215*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"7d96a6fa-1745-4ff5-ae00-7a588b054199"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res1", "=", 
  RowBox[{"CH", "[", "Q1", "]"}]}]], "Input",
 CellChangeTimes->{{3.9082725239770145`*^9, 3.908272539239046*^9}, {
   3.9082741162830505`*^9, 3.9082741177358313`*^9}, {3.9082783837334614`*^9, 
   3.9082783840463457`*^9}, 3.9082822646909275`*^9, 3.9082904980567617`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"1020c647-999a-4f7f-8bbc-2faf708de9a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.496602874042274`"}], 
       RowBox[{"-", "5.891786105370791`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "4.145184558118746`"}], 
       RowBox[{"-", "8.05836313371443`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0.29928515083575036`", 
       RowBox[{"-", "7.790002532001022`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9.785661503438206`", 
       RowBox[{"-", "3.379622137120762`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.687254462531129`", "5.154306600896177`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.3935910778663612`", "9.439061690224207`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.493493770344255`"}], "9.296174145311078`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "5.322254817116164`"}], "6.940437468300928`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.720018200519117`"}], 
       RowBox[{"-", "0.6493018940233881`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.496602874042274`"}], 
       RowBox[{"-", "5.891786105370791`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9082743185013123`*^9, {3.908275407781542*^9, 3.908275419106675*^9}, 
   3.9082755663077908`*^9, 3.90827567020746*^9, 3.9082757521486664`*^9, {
   3.908278367534566*^9, 3.908278396324239*^9}, 3.908279621630619*^9, 
   3.9082822675808697`*^9, 3.9082851132163982`*^9, 3.9082878168264356`*^9, 
   3.908290498447261*^9, 3.9082906090724545`*^9, {3.908295392583557*^9, 
   3.9082954095790625`*^9}, 3.908344297236041*^9, 3.908352836287322*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"759c3d37-157e-4a67-bfaa-f3ec3a56b916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointsPicture", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.02"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "]"}], "&"}], "/@", "Q1"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", "res1"}], 
       "}"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.908272362543335*^9, 3.9082723637623644`*^9}, {
   3.908272516462875*^9, 3.9082726203442764`*^9}, {3.90827268023132*^9, 
   3.9082727289863725`*^9}, {3.908274328361686*^9, 3.9082743379156103`*^9}, {
   3.908275370342991*^9, 3.908275400023144*^9}, {3.908275585421457*^9, 
   3.9082756497147055`*^9}, {3.9082757236841164`*^9, 
   3.9082757380758653`*^9}, {3.908278387092045*^9, 3.908278387498192*^9}, {
   3.908279775852665*^9, 3.908279815272338*^9}, 3.908279907787635*^9, 
   3.908282275054817*^9, 3.9082905019789424`*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"cec75690-e8c4-4eda-ae27-8324a9828558"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[
   0.02], {PointBox[{5.9930251120855615`, -0.5586956632212612}], 
    PointBox[{-6.096763390001225, -1.15654480565885}], 
    PointBox[{1.255446789660752, -4.098433319182128}], 
    PointBox[{-5.142083494931754, 1.521054633570241}], 
    PointBox[{-8.720018200519117, -0.6493018940233881}], 
    PointBox[{-5.322254817116164, 6.940437468300928}], 
    PointBox[{8.848872875184576, -1.418782383818705}], 
    PointBox[{-4.145184558118746, -8.05836313371443}], 
    PointBox[{1.363963238875911, 2.730683679223432}], 
    PointBox[{1.3935910778663612`, 9.439061690224207}], 
    PointBox[{0.29928515083575036`, -7.790002532001022}], 
    PointBox[{3.9289519245773263`, -2.574226064069048}], 
    PointBox[{9.785661503438206, -3.379622137120762}], 
    PointBox[{-0.5903143372477189, -6.828417365490758}], 
    PointBox[{2.4326448216472514`, -1.147828713385067}], 
    PointBox[{5.465096021542429, 1.0545449096540338`}], 
    PointBox[{-7.496602874042274, -5.891786105370791}], 
    PointBox[{-1.493493770344255, 9.296174145311078}], 
    PointBox[{7.687254462531129, 5.154306600896177}], 
    PointBox[{-5.675417481168136, 1.8279325532384227`}]}, 
   LineBox[{{{-7.496602874042274, -5.891786105370791}, {-4.145184558118746, \
-8.05836313371443}, {0.29928515083575036`, -7.790002532001022}, {
    9.785661503438206, -3.379622137120762}, {7.687254462531129, 
    5.154306600896177}, {1.3935910778663612`, 
    9.439061690224207}, {-1.493493770344255, 
    9.296174145311078}, {-5.322254817116164, 
    6.940437468300928}, {-8.720018200519117, -0.6493018940233881}, \
{-7.496602874042274, -5.891786105370791}}}]},
  ImageSize->{
    UpTo[600], 
    UpTo[412]}]], "Output",
 CellChangeTimes->{
  3.908272380070496*^9, {3.9082724297395077`*^9, 3.908272458601101*^9}, 
   3.908272517618702*^9, {3.908272575153598*^9, 3.9082725889950914`*^9}, 
   3.908272620921807*^9, {3.908272683417632*^9, 3.908272729579975*^9}, 
   3.9082732113096857`*^9, 3.9082732440182004`*^9, 3.9082733817737412`*^9, 
   3.90827349185157*^9, 3.9082739833375034`*^9, {3.9082741556147194`*^9, 
   3.9082741823409*^9}, 3.908274298861661*^9, {3.9082743295484753`*^9, 
   3.908274338384246*^9}, {3.908275400507412*^9, 3.908275420122064*^9}, {
   3.9082755676511946`*^9, 3.9082756050810337`*^9}, {3.908275638462426*^9, 
   3.9082756718789406`*^9}, {3.9082757386065297`*^9, 
   3.9082757549136095`*^9}, {3.908278369684473*^9, 3.908278397089718*^9}, 
   3.9082796242317533`*^9, {3.908279785662857*^9, 3.9082798156784954`*^9}, 
   3.908279908459422*^9, {3.9082822688618526`*^9, 3.90828227831971*^9}, 
   3.9082851133726125`*^9, 3.9082878169982834`*^9, 3.9082905026192675`*^9, 
   3.908290609791029*^9, {3.908295393302136*^9, 3.908295410328849*^9}, 
   3.9083442983920245`*^9, 3.9083528363498087`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"1bdf7fe2-8fba-44b2-b76d-b5173be009a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.908282257305259*^9, 3.9082822595703783`*^9}, {
  3.908282349263899*^9, 3.9082824397305408`*^9}, {3.908282890397628*^9, 
  3.9082829766608405`*^9}, {3.9082866192449055`*^9, 3.908286635503408*^9}, {
  3.9082948637350707`*^9, 3.908294865734601*^9}, {3.908295377112959*^9, 
  3.9082953806126013`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"a0fe7fba-9ea5-4a59-ac5f-16d662fd4795"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4", "6"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "2", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{3.908282977551256*^9, 3.9082851134663377`*^9, 
  3.908286636690654*^9, 3.9082878170451703`*^9, 3.9082905078367925`*^9, 
  3.9082948664995794`*^9, 3.908295381377616*^9, 3.9083442997042108`*^9, 
  3.9083528364279165`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"f30dd32f-8d1c-4755-9e1b-8e7aa1791afd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res2", "=", 
  RowBox[{"CH", "[", "Q2", "]"}]}]], "Input",
 CellChangeTimes->{{3.908282983541211*^9, 3.9082829920708923`*^9}, 
   3.9082905159105463`*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"4fc8fb58-459e-4318-818b-f6c26db10d50"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6", "5"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4", "6"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{3.9082858587063265`*^9, 3.908285909131007*^9, 
  3.9082859412132893`*^9, 3.908286486651802*^9, 3.908286529039461*^9, 
  3.9082866428307962`*^9, 3.908287819122772*^9, 3.9082905168946824`*^9, 
  3.908294869248966*^9, 3.908295343365864*^9, 3.9082953825804195`*^9, 
  3.9083443006883545`*^9, 3.9083528365216427`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"de245571-fa87-4a04-81de-0d1b35e05e84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointsPicture", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.02"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "]"}], "&"}], "/@", "Q2"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", "res2"}], 
       "}"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9082865739034767`*^9, 3.9082865742163258`*^9}, 
   3.9082905203342333`*^9},
 CellLabel->"In[77]:=",ExpressionUUID->"0f362f54-7e29-4fbf-8fa3-0023da15129d"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[
   0.02], {PointBox[{6, 3}], PointBox[{6, 5}], PointBox[{3, 5}], 
    PointBox[{6, 1}], PointBox[{1, 2}], PointBox[{1, 1}], PointBox[{3, 1}], 
    PointBox[{4, 6}], PointBox[{2, 4}], PointBox[{6, 5}], PointBox[{5, 1}], 
    PointBox[{1, 3}]}, 
   LineBox[{{{1, 1}, {6, 1}, {6, 5}, {4, 6}, {1, 3}, {1, 1}}}]}]], "Output",
 CellChangeTimes->{
  3.9082865747782326`*^9, 3.908286649641757*^9, 3.908287819200881*^9, 
   3.908290520912255*^9, 3.9082948710577483`*^9, {3.9082953378201065`*^9, 
   3.908295348563484*^9}, 3.9082953838145404`*^9, 3.908344301578806*^9, 
   3.9083528366153884`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"f62c12ca-a48d-49ab-91e6-7713e6af52ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0417\:0430\:0434\:0430\:043d\:0438\:0435 2.", "Section",
 CellChangeTimes->{{3.908193991490741*^9, 3.908194002839224*^9}, {
  3.908300977453188*^9, 
  3.908300978140397*^9}},ExpressionUUID->"666ac3e7-7bfe-48bb-b1db-\
d97d9649797e"],

Cell["\<\
\:0421\:043f\:0440\:043e\:0435\:043a\:0442\:0438\:0440\:0443\:0439\:0442\:0435\
 \:0438 \:0441\:043e\:0437\:0434\:0430\:0439\:0442\:0435 \:0444\:0443\:043d\
\:043a\:0446\:0438\:0438 \:0434\:043b\:044f \:043f\:043e\:0441\:0442\:0440\
\:043e\:0435\:043d\:0438\:044f \:0432\:044b\:043f\:0443\:043a\:043b\:043e\
\:0439 \:043e\:0431\:043e\:043b\:043e\:0447\:043a\:0438 \:0437\:0430\:0434\
\:0430\:043d\:043d\:043e\:0433\:043e \:043c\:043d\:043e\:0436\:0435\:0441\
\:0442\:0432\:0430 \:0442\:043e\:0447\:0435\:043a \:043f\:043b\:043e\:0441\
\:043a\:043e\:0441\:0442\:0438 \:0441 \:0438\:0441\:043f\:043e\:043b\:044c\
\:0437\:043e\:0432\:0430\:043d\:0438\:0435\:043c \:0430\:043b\:0433\:043e\
\:0440\:0438\:0442\:043c\:0430 \:0414\:0436\:0430\:0440\:0432\:0438\:0441\
\:0430 . \:041f\:0440\:043e\:0432\:0435\:0434\:0438\:0442\:0435 \:0442\:0435\
\:0441\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:0435 .\
\>", "Text",
 CellChangeTimes->{{3.908194054615077*^9, 
  3.9081940664977617`*^9}},ExpressionUUID->"f2e65b36-a474-4fba-acef-\
c79d23e6d12c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"isGreater", "[", 
   RowBox[{
   "StartPoint_kmPoint", ",", "Point1_kmPoint", ",", "Point2_kmPoint"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"getTriangleAlgebraicSquare", "[", 
      RowBox[{"{", 
       RowBox[{"StartPoint", ",", "Point2", ",", "Point1"}], "}"}], "]"}], "==",
      "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kmSegment", "[", 
       RowBox[{"StartPoint", ",", "Point2"}], "]"}], "[", "\"\<len\>\"", 
      "]"}], "<", 
     RowBox[{
      RowBox[{"kmSegment", "[", 
       RowBox[{"StartPoint", ",", "Point1"}], "]"}], "[", "\"\<len\>\"", 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getTriangleAlgebraicSquare", "[", 
      RowBox[{"{", 
       RowBox[{"StartPoint", ",", "Point2", ",", "Point1"}], "}"}], "]"}], 
     ">", "0"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9083033642488112`*^9, 3.9083034144311733`*^9}, {
  3.9083035218293686`*^9, 3.9083035618182135`*^9}, {3.908303593367758*^9, 
  3.90830364941908*^9}, {3.9083375083894024`*^9, 3.9083375117636533`*^9}, {
  3.9083459924516354`*^9, 3.9083460150084453`*^9}, {3.908346049831605*^9, 
  3.9083460502694583`*^9}, {3.908346105191553*^9, 3.9083461088938365`*^9}, {
  3.908346566131075*^9, 3.908346566537698*^9}, {3.9083478561826715`*^9, 
  3.908347925911724*^9}, {3.908348203333294*^9, 3.908348204098741*^9}, {
  3.9083485069603834`*^9, 3.9083485098971586`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[78]:=",ExpressionUUID->"a9d3f6cb-5207-474d-b4bb-03878834329f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sortByPolarAngle", "[", "points_List", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"StartPoint", "=", 
       RowBox[{"getStartPoint", "[", "points", "]"}]}], ",", 
      RowBox[{"sorted", "=", "points"}], ",", "flag"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sorted", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"sorted", ",", "StartPoint"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sorted", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"sorted", ",", "StartPoint", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"1", "<=", 
        RowBox[{"Length", "@", "sorted"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flag", "=", "True"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", "2"}], ",", 
          RowBox[{"j", "<", 
           RowBox[{"Length", "@", "sorted"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"isGreater", "[", 
             RowBox[{"StartPoint", ",", 
              RowBox[{"sorted", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"sorted", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sorted", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"sorted", ",", 
                RowBox[{"sorted", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"j", "+", "2"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sorted", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"sorted", ",", "j"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"flag", "=", "False"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"flag", ",", 
          RowBox[{"Return", "@", "sorted"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.908303027458833*^9, 3.9083031146139727`*^9}, {
  3.908303957460945*^9, 3.908304290425764*^9}, {3.908304432294958*^9, 
  3.9083045480892644`*^9}, {3.9083384030960875`*^9, 3.908338426519901*^9}, {
  3.9083384712119856`*^9, 3.9083385231252794`*^9}, {3.908338555320693*^9, 
  3.9083386191303835`*^9}, {3.9083431242275124`*^9, 3.908343218037817*^9}, {
  3.908343282320024*^9, 3.908343307641384*^9}, {3.908343414488595*^9, 
  3.9083434202684875`*^9}, {3.9083434954207478`*^9, 3.9083435426464615`*^9}, {
  3.908344371932888*^9, 3.908344414060204*^9}, {3.9083460992300377`*^9, 
  3.9083461011670804`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[79]:=",ExpressionUUID->"8dd92e2e-5006-42de-b9ab-2f0c2aa208c2"],

Cell["\:041f\:0440\:043e\:0432\:0435\:0440\:044f\:044e", "Text",
 CellChangeTimes->{{3.906026844579239*^9, 3.90602686312479*^9}, {
  3.9066075008207493`*^9, 3.906607502273631*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"2003ae59-b708-43bb-a1ec-96f4ddd53bee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sortByPolarAngle", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"9", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9083045242890606`*^9, 3.9083045249763947`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"6d71e66d-bf53-4380-9ce1-e221afa8f98c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6"}], 
       RowBox[{"-", "1"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "1"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0", "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9083045496357408`*^9, 3.908337518012684*^9, 3.908338534482178*^9, {
   3.908338579720767*^9, 3.9083386225871716`*^9}, {3.9083433756910124`*^9, 
   3.9083433998027387`*^9}, 3.908343897882674*^9, {3.9083443816332793`*^9, 
   3.9083444210425086`*^9}, 3.9083461216246276`*^9, 3.9083481338073235`*^9, 
   3.908348207550619*^9, 3.9083485163326783`*^9, 3.9083528367715855`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"717e8e07-fadb-44ce-b023-000006c103e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sortByPolarAngle", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"8", ",", "6"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"12", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "3"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"8", ",", "2"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{"10", ",", "4"}], "}"}], "]"}], ",", 
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "6"}], "}"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.9083455982635436`*^9, 3.9083458274046855`*^9}, {
  3.90834585902067*^9, 3.9083458598646536`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"2de5e5f2-84c8-438d-bd09-609b2865d657"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1"}], "0"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "12", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8", "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "10", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8", "6"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "3", "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1"}], "2"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1"}], "3"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1"}], "4"}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "2"}], "6"}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{3.9083458280451193`*^9, 3.90834586042656*^9, 
  3.9083461256549287`*^9, 3.908346570942479*^9, 3.9083479306543303`*^9, 
  3.9083482084878664`*^9, 3.9083485173792706`*^9, 3.908352836865312*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"673dcf26-bb8f-45f5-8e83-f6bff1d324c4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pop", "[", "list_List", "]"}], ":=", 
  RowBox[{"Delete", "[", 
   RowBox[{"list", ",", 
    RowBox[{"-", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9083503852155833`*^9, 3.9083504365983987`*^9}, {
  3.908350473614681*^9, 3.908350514527568*^9}, {3.90835097498317*^9, 
  3.90835097520233*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[82]:=",ExpressionUUID->"f2a27078-f3a5-4563-bc10-8c16ecc23887"],

Cell[BoxData[
 RowBox[{
  RowBox[{"top", "[", "list_List", "]"}], ":=", 
  RowBox[{"Last", "@", "list"}]}]], "Input",
 CellChangeTimes->{{3.9083509370300446`*^9, 3.908350977654415*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[83]:=",ExpressionUUID->"39e7792a-5ffc-4200-9f0a-5c533473aef6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextToTop", "[", "list_List", "]"}], ":=", 
  RowBox[{"list", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"Length", "@", "list"}], "-", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.908350979456316*^9, 3.908351024016469*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[84]:=",ExpressionUUID->"cfea1d52-ff15-46cc-8f00-8c543e77c55a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CHGr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CHGr", "[", "pointsList_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sorted", "=", 
       RowBox[{"sortByPolarAngle", "[", "pointsList", "]"}]}], ",", 
      "StartPoint", ",", 
      RowBox[{"S", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StartPoint", "=", 
      RowBox[{"First", "@", "sorted"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sorted", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"sorted", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sorted", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"sorted", ",", "StartPoint"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"S", ",", "StartPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"S", ",", 
        RowBox[{"sorted", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sorted", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"sorted", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"While", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "S"}], ">", "1"}], "&&", 
           RowBox[{
            RowBox[{"getTriangleAlgebraicSquare", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nextToTop", "[", "S", "]"}], ",", "i", ",", 
               RowBox[{"top", "[", "S", "]"}]}], "}"}], "]"}], ">", "0"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"S", "=", 
            RowBox[{"pop", "[", "S", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"S", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"S", ",", "i"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "sorted"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "@", "S"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9083505975822926`*^9, 3.90835076887853*^9}, {
  3.9083508921610646`*^9, 3.9083509149367733`*^9}, {3.908351925257204*^9, 
  3.908351985454776*^9}, {3.9083523277336044`*^9, 3.9083523769581842`*^9}, {
  3.9083524093763056`*^9, 3.9083524492053556`*^9}, {3.908352521322384*^9, 
  3.908352565758098*^9}, {3.908352660768859*^9, 3.9083526940240984`*^9}, {
  3.9083530596127453`*^9, 3.9083530597845783`*^9}, {3.9083533306673183`*^9, 
  3.908353392889338*^9}, {3.9083534775159073`*^9, 3.9083535765803084`*^9}, {
  3.9083539033640924`*^9, 3.908353913064535*^9}, {3.908353969600829*^9, 
  3.908354004075057*^9}, {3.908354435749421*^9, 3.908354447390794*^9}, {
  3.908354497689055*^9, 3.9083545059864407`*^9}, {3.9083545820220985`*^9, 
  3.90835458224123*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"2cc61f81-1509-4e92-b832-e80be9e0f292"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"kmPoint", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}], ",", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}], "}"}], "]"}], 
    "&"}], "/@", 
   RowBox[{"Range", "[", "20", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.908354553822372*^9, 3.908354559145578*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"aee98602-4a32-47ac-b5cd-7cdf7bc0bd1e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6.212091438477074`"}], 
       RowBox[{"-", "8.277613359275875`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "1.0624499260843798`", "6.034312856006935`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9.143615811182848`", "3.769861241947922`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.436133141258402`"}], 
       RowBox[{"-", "8.833964086883952`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.818106737209199`", "7.227904368978329`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "5.6090182366384695`", 
       RowBox[{"-", "8.274093879286404`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.163200655605948`"}], "9.795275293285137`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "0.3482279851724712`"}], 
       RowBox[{"-", "8.79365159733721`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.017910991157251`", "8.860675998153276`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.9080037049318612`"}], 
       RowBox[{"-", "9.337212275626221`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "8.710853753793355`"}], 
       RowBox[{"-", "3.9043720311174503`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.121326425429107`"}], "5.6900778224581785`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "4.254006975370409`", "1.5215722993649905`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.392783486417784`", 
       RowBox[{"-", "7.370525527703705`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.910402836089823`", 
       RowBox[{"-", "1.3473541823795472`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8.822318992671462`", 
       RowBox[{"-", "8.669919173467097`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.737998248984766`", "9.019095009443141`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "0.09388050871796594`", 
       RowBox[{"-", "3.119443244719818`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.406595688614242`"}], 
       RowBox[{"-", "1.4549903504288153`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "6.336509192350611`"}], "5.476493759057803`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{{3.908354559676735*^9, 3.9083545684931154`*^9}, {
  3.9083546080323*^9, 3.9083546254181027`*^9}},
 CellLabel->
  "Out[158]=",ExpressionUUID->"ab2e530a-7a9d-45f2-9e64-5ed8109e16a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res3", "=", 
  RowBox[{"CHGr", "[", "Q3", "]"}]}]], "Input",
 CellChangeTimes->{{3.9083525812220984`*^9, 3.908352599673153*^9}, {
  3.9083545392476425`*^9, 3.908354539606984*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"0c0a0fa5-0f80-4cbb-afe6-da22767d283a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.436133141258402`"}], 
       RowBox[{"-", "8.833964086883952`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.9080037049318612`"}], 
       RowBox[{"-", "9.337212275626221`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "8.822318992671462`", 
       RowBox[{"-", "8.669919173467097`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "9.143615811182848`", "3.769861241947922`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "7.818106737209199`", "7.227904368978329`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", "6.737998248984766`", "9.019095009443141`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "1.163200655605948`"}], "9.795275293285137`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.121326425429107`"}], "5.6900778224581785`"}, 
      "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "9.406595688614242`"}], 
       RowBox[{"-", "1.4549903504288153`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"], ",", 
   TemplateBox[{"\"Point\"", "\"(\"", 
     TemplateBox[{",", "\",\"", 
       RowBox[{"-", "7.436133141258402`"}], 
       RowBox[{"-", "8.833964086883952`"}]}, "RowWithSeparators"], "\")\""},
    "RowDefault"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9083525836273136`*^9, 3.908352601422733*^9}, {
   3.9083526652889977`*^9, 3.9083527014501753`*^9}, 3.908352837177739*^9, 
   3.9083530677490263`*^9, {3.908353347773367*^9, 3.908353372110207*^9}, 
   3.9083535037313256`*^9, {3.908353535087812*^9, 3.908353578314221*^9}, {
   3.9083539877073956`*^9, 3.9083540075650644`*^9}, 3.908354449874543*^9, {
   3.908354501688074*^9, 3.908354507501741*^9}, {3.9083545607858157`*^9, 
   3.90835456960219*^9}, {3.9083546153046722`*^9, 3.9083546265584545`*^9}},
 CellLabel->
  "Out[159]=",ExpressionUUID->"e7529cbc-f2ee-49ea-bcea-b9a4e0a03cd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointsPicture", "=", 
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "@", "0.02"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "]"}], "&"}], "/@", "Q3"}], 
     ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "\"\<coord\>\"", "]"}], "&"}], "/@", "res3"}], 
       "}"}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.908352617740423*^9, 3.90835261799079*^9}, {
  3.908354610391547*^9, 3.908354610719599*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"b5e219bb-a176-4913-adef-313804022356"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[
   0.02], {PointBox[{-6.212091438477074, -8.277613359275875}], 
    PointBox[{1.0624499260843798`, 6.034312856006935}], 
    PointBox[{9.143615811182848, 3.769861241947922}], 
    PointBox[{-7.436133141258402, -8.833964086883952}], 
    PointBox[{7.818106737209199, 7.227904368978329}], 
    PointBox[{5.6090182366384695`, -8.274093879286404}], 
    PointBox[{-1.163200655605948, 9.795275293285137}], 
    PointBox[{-0.3482279851724712, -8.79365159733721}], 
    PointBox[{6.017910991157251, 8.860675998153276}], 
    PointBox[{-1.9080037049318612`, -9.337212275626221}], 
    PointBox[{-8.710853753793355, -3.9043720311174503`}], 
    PointBox[{-9.121326425429107, 5.6900778224581785`}], 
    PointBox[{4.254006975370409, 1.5215722993649905`}], 
    PointBox[{7.392783486417784, -7.370525527703705}], 
    PointBox[{7.910402836089823, -1.3473541823795472`}], 
    PointBox[{8.822318992671462, -8.669919173467097}], 
    PointBox[{6.737998248984766, 9.019095009443141}], 
    PointBox[{0.09388050871796594, -3.119443244719818}], 
    PointBox[{-9.406595688614242, -1.4549903504288153`}], 
    PointBox[{-6.336509192350611, 5.476493759057803}]}, 
   LineBox[{{{-7.436133141258402, -8.833964086883952}, {-1.9080037049318612`, \
-9.337212275626221}, {8.822318992671462, -8.669919173467097}, {
    9.143615811182848, 3.769861241947922}, {7.818106737209199, 
    7.227904368978329}, {6.737998248984766, 
    9.019095009443141}, {-1.163200655605948, 
    9.795275293285137}, {-9.121326425429107, 
    5.6900778224581785`}, {-9.406595688614242, -1.4549903504288153`}, \
{-7.436133141258402, -8.833964086883952}}}]}]], "Output",
 CellChangeTimes->{
  3.908352618802637*^9, {3.90835266630438*^9, 3.908352702309312*^9}, 
   3.9083528372558455`*^9, 3.908353279386717*^9, {3.908353510966934*^9, 
   3.908353579095293*^9}, 3.9083545084233994`*^9, {3.9083545621664486`*^9, 
   3.908354570289528*^9}, {3.9083546112033925`*^9, 3.908354627292657*^9}},
 CellLabel->
  "Out[160]=",ExpressionUUID->"93faf443-8b23-4a87-ba88-c65cab7f03c5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152, 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8c90ee3c-e8e9-41cd-9906-120e8a0de721"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 190, 3, 59, "Section",ExpressionUUID->"8ee7ed7f-4584-47c6-b154-b36cb2931704"],
Cell[773, 27, 1053, 16, 52, "Text",ExpressionUUID->"999f711a-b7c3-416d-8cda-0eb80c502ab1"],
Cell[1829, 45, 4027, 75, 143, "Input",ExpressionUUID->"16162efc-264d-43bd-8d73-7f94a9cd664c"],
Cell[5859, 122, 3731, 108, 263, "Input",ExpressionUUID->"ec09dff8-3ab6-4d09-9e09-a4e23f250f03"],
Cell[9593, 232, 5197, 145, 400, "Input",ExpressionUUID->"286e5e4f-b637-4c69-80c1-575982b2725b"],
Cell[14793, 379, 11580, 339, 547, "Input",ExpressionUUID->"f601de5c-989f-40cb-93b5-75768e8dae96"],
Cell[26376, 720, 13178, 346, 574, "Input",ExpressionUUID->"2c7bdca1-d923-4ee2-8ff1-2b99ebfbd0a5"],
Cell[CellGroupData[{
Cell[39579, 1070, 704, 20, 25, "Input",ExpressionUUID->"508b7830-4ff7-44ed-848b-6a92855c34a8"],
Cell[40286, 1092, 5011, 105, 81, "Output",ExpressionUUID->"74a2b02d-1e53-411a-96e6-85d6c09e6c92"]
}, Open  ]],
Cell[45312, 1200, 1063, 30, 55, "Input",ExpressionUUID->"7f6eac22-11d6-4258-81ab-7bc34c95371d"],
Cell[46378, 1232, 972, 22, 44, "Input",ExpressionUUID->"cd9ec9c2-2ebb-411b-bbb0-2cdb4664ae0a"],
Cell[47353, 1256, 393, 7, 39, "Input",ExpressionUUID->"7617d9e4-2851-4260-b9c4-aa86a84cdc0a"],
Cell[47749, 1265, 537, 11, 39, "Input",ExpressionUUID->"ad5aa6db-08c4-47dd-a63f-0046f27d91ef"],
Cell[48289, 1278, 455, 6, 31, "Text",ExpressionUUID->"5fd0810c-3332-4a85-b3cb-2308a9bc5015"],
Cell[48747, 1286, 2708, 64, 297, "Input",ExpressionUUID->"6f6cabf9-2779-401e-826e-2824ac168cab"],
Cell[51458, 1352, 746, 14, 39, "Input",ExpressionUUID->"2478a258-7b3c-4f6b-84a0-96d971fd7f4c"],
Cell[52207, 1368, 2896, 75, 75, "Input",ExpressionUUID->"b308d98b-f4d8-4e73-ae8b-5bc190bd1758"],
Cell[55106, 1445, 7339, 134, 468, "Input",ExpressionUUID->"0103ac2f-3c37-45b6-97ac-5e3d52def9c9"],
Cell[62448, 1581, 279, 4, 45, "Text",ExpressionUUID->"4f263991-1209-4fee-b54e-5a10735d40d3"],
Cell[CellGroupData[{
Cell[62752, 1589, 727, 20, 25, "Input",ExpressionUUID->"3e44a78c-0109-4c4c-839e-21429a177844"],
Cell[63482, 1611, 4405, 97, 81, "Output",ExpressionUUID->"7d96a6fa-1745-4ff5-ae00-7a588b054199"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67924, 1713, 385, 6, 25, "Input",ExpressionUUID->"1020c647-999a-4f7f-8bbc-2faf708de9a8"],
Cell[68312, 1721, 2629, 56, 47, "Output",ExpressionUUID->"759c3d37-157e-4a67-bfaa-f3ec3a56b916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70978, 1782, 1125, 25, 25, "Input",ExpressionUUID->"cec75690-e8c4-4eda-ae27-8324a9828558"],
Cell[72106, 1809, 2876, 50, 386, "Output",ExpressionUUID->"1bdf7fe2-8fba-44b2-b76d-b5173be009a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75019, 1864, 1664, 45, 43, "Input",ExpressionUUID->"a0fe7fba-9ea5-4a59-ac5f-16d662fd4795"],
Cell[76686, 1911, 2039, 43, 28, "Output",ExpressionUUID->"f30dd32f-8d1c-4755-9e1b-8e7aa1791afd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78762, 1959, 257, 5, 25, "Input",ExpressionUUID->"4fc8fb58-459e-4318-818b-f6c26db10d50"],
Cell[79022, 1966, 1298, 26, 28, "Output",ExpressionUUID->"de245571-fa87-4a04-81de-0d1b35e05e84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80357, 1997, 680, 19, 25, "Input",ExpressionUUID->"0f362f54-7e29-4fbf-8fa3-0023da15129d"],
Cell[81040, 2018, 708, 13, 338, "Output",ExpressionUUID->"f62c12ca-a48d-49ab-91e6-7713e6af52ad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81797, 2037, 239, 4, 59, "Section",ExpressionUUID->"666ac3e7-7bfe-48bb-b1db-d97d9649797e"],
Cell[82039, 2043, 1053, 16, 52, "Text",ExpressionUUID->"f2e65b36-a474-4fba-acef-c79d23e6d12c"],
Cell[83095, 2061, 1643, 36, 109, "Input",ExpressionUUID->"a9d3f6cb-5207-474d-b4bb-03878834329f"],
Cell[84741, 2099, 3291, 73, 349, "Input",ExpressionUUID->"8dd92e2e-5006-42de-b9ab-2f0c2aa208c2"],
Cell[88035, 2174, 279, 4, 45, "Text",ExpressionUUID->"2003ae59-b708-43bb-a1ec-96f4ddd53bee"],
Cell[CellGroupData[{
Cell[88339, 2182, 786, 22, 25, "Input",ExpressionUUID->"6d71e66d-bf53-4380-9ce1-e221afa8f98c"],
Cell[89128, 2206, 1268, 26, 28, "Output",ExpressionUUID->"717e8e07-fadb-44ce-b023-000006c103e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90433, 2237, 1501, 44, 43, "Input",ExpressionUUID->"2de5e5f2-84c8-438d-bd09-609b2865d657"],
Cell[91937, 2283, 1989, 44, 28, "Output",ExpressionUUID->"673dcf26-bb8f-45f5-8e83-f6bff1d324c4"]
}, Open  ]],
Cell[93941, 2330, 451, 10, 39, "Input",ExpressionUUID->"f2a27078-f3a5-4563-bc10-8c16ecc23887"],
Cell[94395, 2342, 302, 6, 39, "Input",ExpressionUUID->"39e7792a-5ffc-4200-9f0a-5c533473aef6"],
Cell[94700, 2350, 391, 9, 39, "Input",ExpressionUUID->"cfea1d52-ff15-46cc-8f00-8c543e77c55a"],
Cell[95094, 2361, 3191, 73, 283, "Input",ExpressionUUID->"2cc61f81-1509-4e92-b832-e80be9e0f292"],
Cell[CellGroupData[{
Cell[98310, 2438, 628, 19, 25, "Input",ExpressionUUID->"aee98602-4a32-47ac-b5cd-7cdf7bc0bd1e"],
Cell[98941, 2459, 4246, 95, 81, "Output",ExpressionUUID->"ab2e530a-7a9d-45f2-9e64-5ed8109e16a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103224, 2559, 286, 6, 25, "Input",ExpressionUUID->"0c0a0fa5-0f80-4cbb-afe6-da22767d283a"],
Cell[103513, 2567, 2676, 57, 47, "Output",ExpressionUUID->"e7529cbc-f2ee-49ea-bcea-b9a4e0a03cd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106226, 2629, 700, 20, 25, "Input",ExpressionUUID->"b5e219bb-a176-4913-adef-313804022356"],
Cell[106929, 2651, 2059, 37, 348, "Output",ExpressionUUID->"93faf443-8b23-4a87-ba88-c65cab7f03c5"]
}, Open  ]]
}, Open  ]]
}
]
*)

